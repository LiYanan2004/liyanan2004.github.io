<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>LiYanan2004 - æˆ‘çš„åšå®¢</title>
  
  <subtitle>@LiYanan2004</subtitle>
  <link href="https://liyanan2004.github.io/atom.xml" rel="self"/>
  
  <link href="https://liyanan2004.github.io/"/>
  <updated>2024-02-18T09:12:31.662Z</updated>
  <id>https://liyanan2004.github.io/</id>
  
  <author>
    <name>LiYanan</name>
    
  </author>
  
  <generator uri="https://hexo.io/">Hexo</generator>
  
  <entry>
    <title>Say Hello to MegaX</title>
    <link href="https://liyanan2004.github.io/megax/"/>
    <id>https://liyanan2004.github.io/megax/</id>
    <published>2024-02-18T08:43:14.131Z</published>
    <updated>2024-02-18T09:12:31.662Z</updated>
    
    <content type="html"><![CDATA[<p>æœ‰çš„æ—¶å€™ä¼šæœ‰å¾ˆå¤šæƒ³æ³•å’Œç‚¹å­ï¼Œå¼€äº†å¾ˆå¤šçš„é¡¹ç›®ï¼Œå‘ç°å¾ˆå¤šä»£ç éƒ½æ˜¯é‡å¤çš„ï¼Œæ¯”å¦‚æ¯ä¸ªé¡¹ç›®ä¸­æˆ‘éƒ½ä¼šåˆ›å»ºä¸€ä¸ª <code>if-else</code> çš„ View Modifierã€BlurView è¿™äº›ï¼Œæœ€è¿‘æˆ‘å¯¹äº CameraView çš„ä½¿ç”¨ä¹Ÿæ›´åŠ é¢‘ç¹äº†ã€‚</p><p>So, why not create a framework that gathers everything we will need in our development proccess?</p><p>Sure. We can.</p><span id="more"></span><p>äºæ˜¯ï¼Œæˆ‘å’Œè‡ªå·±ä¸€æ‹å³åˆï¼Œå°±å¼€å§‹æ‰¾å¯»è‡ªå·±æ›¾ç»å¼€å‘è¿‡çš„ä¸€äº›å¯ä»¥å¤ç”¨çš„ç»„ä»¶ï¼Œå¯¹å…¶æ”¹é€ ç”šè‡³æ˜¯é‡å†™ï¼Œä½¿å…¶å¯ä»¥é€‚ç”¨äºä¸åŒçš„åœºæ™¯ã€‚</p><p>321ï¼Œä¸Šé“¾æ¥ï¼š<a href="https://github.com/LiYanan2004/MegaX">https://github.com/LiYanan2004/MegaX</a></p><p><del>So, what should we call it?</del></p><p><del>Well, that brings us to our legendary crack marketing team.</del></p><p>Sorryï¼Œä¸²å°äº†ã€‚</p><h2 id="CameraView"><a href="#CameraView" class="headerlink" title="CameraView"></a>CameraView</h2><p>åœ¨è¿‡å¹´æœŸé—´ï¼Œæˆ‘èŠ±äº†ä¸€ä¸ªç¤¼æ‹œæ—¶é—´å†™äº†ä¸€ä¸ª System-like CameraViewï¼Œç”¨äºæ‹æ‘„é™æ€å›¾ç‰‡ï¼Œç›¸ä¿¡ä¹Ÿæ˜¯ä¸€ä¸ªå¾ˆå¸¸è§çš„éœ€æ±‚ã€‚</p><p>æ”¯æŒå¿«é€Ÿå¿«é—¨ä¼˜å…ˆçš„å“åº”å¼æ‹æ‘„ã€‚</p><p>è¿™é‡Œæ˜¯ä¸€ä¸ªç®€å•çš„ä¾‹å­ã€‚</p><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> SwiftUI</span><br><span class="line"><span class="keyword">import</span> MegaX</span><br><span class="line"></span><br><span class="line"><span class="keyword">@main</span></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">MyCameraApp</span>: <span class="title class_">App</span> &#123;</span><br><span class="line">    <span class="comment">// This is needed, or the orientation behavior may be wired.</span></span><br><span class="line">    <span class="meta">@UIApplicationDelegateAdaptor</span>(<span class="type">AppOrientationDelegate</span>.<span class="keyword">self</span>) <span class="keyword">private</span> <span class="keyword">var</span> delegate</span><br><span class="line"></span><br><span class="line">    <span class="keyword">var</span> body: <span class="keyword">some</span> <span class="type">Scene</span> &#123;</span><br><span class="line">        <span class="type">WindowGroup</span> &#123;</span><br><span class="line">            <span class="type">CameraView</span> &#123; photoCaptured <span class="keyword">in</span></span><br><span class="line">                <span class="built_in">print</span>(<span class="string">&quot;photoData: <span class="subst">\(photoCaptured)</span>&quot;</span>)</span><br><span class="line">            ï½</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¿™é‡Œéœ€è¦é¢å¤–åœ¨ App å…¥å£å¢åŠ ä¸€ä¸ª <code>AppOrientationDelegate</code> æ˜¯å› ä¸ºåœ¨ iPhone ä¸Šéœ€è¦é™åˆ¶åœ¨ <code>CameraView</code> å†…åªèƒ½ä»¥ <code>portait</code> æ˜¾ç¤ºï¼Œä»è€Œä¿è¯ UI èƒ½å¤Ÿå§‹ç»ˆä¿æŒåœ¨åŸåœ°ã€‚</p><p>å½“å®Œæˆæ‹æ‘„ã€å®Œæˆå¤„ç†åä¼šè°ƒç”¨é—­åŒ…ï¼Œä½ å¯ä»¥åœ¨è¿™é‡Œå¤„ç†åç»­çš„ä¿å­˜ã€å¤„ç†çš„ä»»åŠ¡ã€‚</p><p><img src="/img/megax/CameraViewUI.png" alt="CameraView UI"></p><h2 id="AsyncButton"><a href="#AsyncButton" class="headerlink" title="AsyncButton"></a>AsyncButton</h2><p>æœ‰æ—¶å€™ï¼Œæˆ‘ä»¬ä¼šåœ¨ <code>Button</code> ä¸­ä½¿ç”¨å¼‚æ­¥æ“ä½œæ¥æ‰§è¡Œè€—æ—¶ä»»åŠ¡ï¼ŒåŒæ—¶ä¼´éšéœ€è¦å±•ç¤º <code>ProgressView</code></p><p>ä½¿ç”¨ MegaX åï¼Œä¸€åˆ‡éƒ½å˜å¾—ç®€å•èµ·æ¥ã€‚</p><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">AsyncButton</span>(<span class="string">&quot;Download&quot;</span>, systemName: <span class="string">&quot;arrow.down.circle&quot;</span>) &#123;</span><br><span class="line">    <span class="keyword">await</span> download()</span><br><span class="line">&#125; progress: &#123;</span><br><span class="line">    <span class="type">ProgressView</span>()</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ä½ å¯ä»¥åƒä½¿ç”¨ <code>Button</code> ä¸€æ ·åˆ›å»ºä¸€ä¸ª <code>AsyncButton</code></p><p>ä¹Ÿå¯ä»¥é¢å¤–åˆ›å»ºè‡ªå®šä¹‰çš„ ProgressView Placeholderï¼Œé»˜è®¤å°±æ˜¯ï¼š<code>ProgressView()</code></p><p><img src="/img/megax/async-button.gif"></p><h2 id="Backdrop-Blur-Layer"><a href="#Backdrop-Blur-Layer" class="headerlink" title="Backdrop Blur Layer"></a>Backdrop Blur Layer</h2><p>è¿™åº”è¯¥æ˜¯ä¸€ä¸ªé‡ç£…åŠŸèƒ½äº†ã€‚</p><p>SwiftUI æä¾›äº†åŸç”Ÿçš„ <code>Material</code> æè´¨ï¼Œä½†æ˜¯é™¤äº†æ¨¡ç³Šå±‚ä¹‹å¤–è¿˜åŒ…å«äº†<code>CubedLuminanceMappingLayer</code>ï¼ˆä¸€ç§å¯ä»¥è‡ªé€‚åº”æ·±æµ…è‰²æ¨¡å¼çš„å…‰ç…§æ˜ å°„å±‚ï¼‰</p><p>åœ¨ MegaX ä¸­ï¼Œæˆ‘é€šè¿‡å¤§é‡å®éªŒï¼ˆthanks to SwiftUI Previewï¼‰æ‰¾åˆ°äº†ä¸€ç§å¾ˆå¼ºå¤§çš„è°ƒèŠ‚æ–¹æ¡ˆï¼Œæå¤§ç¨‹åº¦ä¸Šçš„æŠµæ¶ˆæ‰äº† <code>CubedLuminanceMappingLayer</code>ï¼ŒåŒæ—¶å¯ä»¥é€‚åº”ä¸åŒçš„èƒŒæ™¯</p><p>è¿™æ ·ï¼Œæˆ‘ä»¬å°±è·å¾—äº†â€çº¯ç²¹çš„â€œ Backdrop-Blur Layer</p><blockquote><p>æˆ‘çŸ¥é“ CAFilter é‡Œæœ‰ä¸€ä¸ªé«˜æ–¯æ¨¡ç³Šçš„æ»¤é•œï¼Œä½†æ˜¯ CAFilter æ˜¯ Private APIï¼Œæ— æ³•å®Œå…¨ç¡®å®šæ˜¯å¦å¯ä»¥é€šè¿‡å®¡æ ¸ã€‚</p><p>MagaX æä¾›äº†çº¯ç²¹çš„ SwiftUI çš„è§£å†³æ–¹æ¡ˆï¼Œ100% è¿‡å®¡æ ¸</p></blockquote><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">YourView</span>()</span><br><span class="line">    .backdropBlur()</span><br></pre></td></tr></table></figure><p>è¿™æ ·ä¼šåœ¨è§†å›¾ä¸‹æ–¹å¢åŠ ä¸€å±‚æ¨¡ç³Šï¼Œ<strong>æ¨¡ç³Šçš„å†…å®¹æ˜¯ <code>YourView</code> ä¸‹æ–¹çš„å†…å®¹</strong>ï¼Œè€Œä¸æ˜¯ <code>YourView</code> æœ¬èº«</p><p>è¿™æ˜¯å’Œ <code>blur(radius:opaque:)</code> çš„æœ¬è´¨åŒºåˆ«</p><p>å¦‚æœä½ æ­£åœ¨æ„å»ºä¸€ä¸ª NavigationBarï¼Œä½ å¯ä»¥è¿˜éœ€è¦å¤„ç† bar å’Œ content ä¹‹é—´çš„è¿‡åº¦ï¼Œè¿™æ—¶å€™ä½ å¯ä»¥ä½¿ç”¨ <code>smoothEdges</code> </p><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">CustomNavigationBar</span>()</span><br><span class="line">    .backdropBlur(smoothEdges: .bottom)</span><br></pre></td></tr></table></figure><p>è¿™æ ·å°±ä¼šåœ¨æ¨¡ç³Šå±‚åº•éƒ¨å¢åŠ ä¸€ä¸ªä» opaque åˆ° transparent çš„è’™æ¿</p><p><img src="/img/megax/back-drop-blur.gif"></p><h2 id="LongPressGesture-with-Location"><a href="#LongPressGesture-with-Location" class="headerlink" title="LongPressGesture with Location"></a>LongPressGesture with Location</h2><p>æˆ‘ä»¬å¾ˆç†Ÿæ‚‰ <code>SpatialTapGesture</code> å’Œ <code>onTapGesture(action: (CGPoint) -&gt; Void)</code> API.</p><p>å¯æƒœçš„æ˜¯ï¼Œåœ¨æˆ‘åš <code>CameraView</code> æ—¶éœ€è¦å®ç°é•¿æŒ‰é”å®šå¯¹ç„¦ï¼Œä¹Ÿéœ€è¦è·å–åˆ°ç‚¹æŒ‰çš„ä½ç½®ï¼Œäºæ˜¯å°±æœ‰äº† <code>SpatialLongPressGesture</code></p><p>[!Tip] ä½†æ˜¯è¿™é‡Œæœ‰ä¸€ç‚¹éœ€è¦ç‰¹åˆ«æ³¨æ„ï¼šä½ éœ€è¦ä½¿ç”¨ onChanged æ¥è·å–åˆ°äº‰å–çš„çŠ¶æ€ï¼Œè€Œä¸æ˜¯ onEnded</p><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">YourView</span>()</span><br><span class="line">    .gesture(</span><br><span class="line">        <span class="type">SpatialLongPressGesture</span>()</span><br><span class="line">            .onChanged &#123; point <span class="keyword">in</span></span><br><span class="line">                <span class="keyword">guard</span> <span class="keyword">let</span> point <span class="keyword">else</span> &#123; </span><br><span class="line">                    <span class="comment">// Touch recognized.</span></span><br><span class="line">                    <span class="keyword">return</span> </span><br><span class="line">                &#125;</span><br><span class="line">                <span class="comment">// Long Press recognized with the location.</span></span><br><span class="line">                <span class="comment">// Some actions here...</span></span><br><span class="line">            &#125;</span><br><span class="line">    )</span><br></pre></td></tr></table></figure><p>ä¹Ÿå¯ä»¥ä½¿ç”¨ View Modifier çš„ç‰ˆæœ¬ï¼š<code>onLongPressGesture(minimumDuration:maximumDistance:coordinateSpace:perform:)</code></p><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">YourView</span>()</span><br><span class="line">    .onLongPressGesture &#123; point <span class="keyword">in</span></span><br><span class="line">        <span class="comment">// Long Press recognized with location.</span></span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure><h2 id="More"><a href="#More" class="headerlink" title="More"></a>More</h2><ul><li><p><code>if-else</code> modifier</p><blockquote><p>è¯·è°¨æ…åœ°ä½¿ç”¨è¿™ä¸ªä¿®æ”¹å™¨ï¼Œå› ä¸ºå®ƒä¼šå¯¼è‡´æ€§èƒ½é—®é¢˜ä»¥åŠå¥‡æ€ªçš„åŠ¨ç”»ã€‚</p><p>å½“ä¸”ä»…å½“ <code>condition</code> å€¼åœ¨æ•´ä¸ª View LifeCycle å†…ä¸ä¼šå˜åŒ–æ—¶ä½¿ç”¨è¯¥ä¿®æ”¹å™¨ã€‚</p><p>ä¸¾ä¸ªæ —å­ï¼šåœ¨ iPad ç¯å¢ƒä¸­é¢å¤–éœ€è¦æ·»åŠ ä¸€ä¸ª padding</p><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> MegaX</span><br><span class="line"></span><br><span class="line"><span class="meta">@Environment</span>(\.deviceType) <span class="keyword">var</span> deviceType</span><br><span class="line"></span><br><span class="line"><span class="type">YourView</span>()</span><br><span class="line">    .if(deviceType <span class="operator">==</span> .pad) &#123; content <span class="keyword">in</span></span><br><span class="line">        content.padding()</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure><p>åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œåœ¨æ•´ä¸ª View LifeCycle ä¸­ï¼ŒdeviceType ä¸ä¼šå˜åŒ–ï¼Œå¯ä»¥æ”¾å¿ƒä½¿ç”¨è¿™ä¸ªä¿®æ”¹å™¨ã€‚</p></blockquote></li><li><p><code>DeviceType</code> environment value.</p><blockquote><p><code>mac</code>ã€<code>tv</code>ã€<code>vision</code>ã€<code>watch</code> åŸºæœ¬éƒ½æ˜¯åœ¨ç¼–è¯‘æœŸï¼ˆNativeï¼‰å°±ç¡®å®šäº†</p><p>iPadã€iPhoneã€CarPlayã€Mac Catalyst ä¼šåœ¨è¿è¡Œæ—¶è·å–ï¼ˆ<code>UIDevice.current.userInterfaceIdiom</code>)</p><p>éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œ<code>mac</code>å’Œ <code>Mac Catalyst</code>æ˜¯ä¸¤ç§ <code>DeviceType</code></p></blockquote></li></ul><h1 id="Ending"><a href="#Ending" class="headerlink" title="Ending"></a>Ending</h1><p>è¿™ä¸ªåº“ç›®å‰è¿˜æ˜¯ WIP çŠ¶æ€ï¼Œä¼šä¸æ–­è¿­ä»£æ›´æ–°ï¼Œå¸Œæœ›å®ƒå¯ä»¥å¸®åŠ©åˆ°æ­£åœ¨ä½¿ç”¨ SwiftUI å¼€å‘çš„å¼€å‘è€…ä»¬ã€‚</p>]]></content>
    
    
    <summary type="html">&lt;p&gt;æœ‰çš„æ—¶å€™ä¼šæœ‰å¾ˆå¤šæƒ³æ³•å’Œç‚¹å­ï¼Œå¼€äº†å¾ˆå¤šçš„é¡¹ç›®ï¼Œå‘ç°å¾ˆå¤šä»£ç éƒ½æ˜¯é‡å¤çš„ï¼Œæ¯”å¦‚æ¯ä¸ªé¡¹ç›®ä¸­æˆ‘éƒ½ä¼šåˆ›å»ºä¸€ä¸ª &lt;code&gt;if-else&lt;/code&gt; çš„ View Modifierã€BlurView è¿™äº›ï¼Œæœ€è¿‘æˆ‘å¯¹äº CameraView çš„ä½¿ç”¨ä¹Ÿæ›´åŠ é¢‘ç¹äº†ã€‚&lt;/p&gt;
&lt;p&gt;So, why not create a framework that gathers everything we will need in our development proccess?&lt;/p&gt;
&lt;p&gt;Sure. We can.&lt;/p&gt;</summary>
    
    
    
    <category term="æ’¸ä»£ç " scheme="https://liyanan2004.github.io/categories/%E6%92%B8%E4%BB%A3%E7%A0%81/"/>
    
    
    <category term="SwiftUI" scheme="https://liyanan2004.github.io/tags/SwiftUI/"/>
    
    <category term="MegaX" scheme="https://liyanan2004.github.io/tags/MegaX/"/>
    
  </entry>
  
  <entry>
    <title>å†™æ›´å°‘çš„ SwiftUI ä»£ç  â€”â€” Namespace</title>
    <link href="https://liyanan2004.github.io/inherit-namespace-in-swiftui/"/>
    <id>https://liyanan2004.github.io/inherit-namespace-in-swiftui/</id>
    <published>2023-09-10T05:42:57.124Z</published>
    <updated>2023-09-10T08:31:07.099Z</updated>
    
    <content type="html"><![CDATA[<p>ä½ æ˜¯å¦å†™è¿‡è¿™æ ·çš„ä»£ç ï¼š<code>DetailView(namespace: namespace, isSource: selected == nil)</code></p><p>æˆ–è€…è¿™æ ·çš„ï¼š<code>DetailView(namespace: Namespace().wrappedValue, isSource: false)</code></p><p>è¿™åŸºæœ¬ä¸Šæ˜¯æ¯ä¸€æ¬¡å†™ Hero åŠ¨ç”»æ—¶å¿…ä¸å¯å°‘çš„ä¸¤ä¸ªå‚æ•°ã€‚</p><p>å¦‚æœè¿˜æœ‰æ›´å¤æ‚çš„éœ€æ±‚ï¼Œä¸€ä¸ª View å¯èƒ½ä¼šæœ‰æ›´å¤šçš„å‚æ•°éœ€è¦ä¼ é€’ã€‚</p><p>å…¶å®ï¼Œå¾ˆä¹…ä¹‹å‰æˆ‘å°±åœ¨æƒ³ï¼Œå¦‚æœæŠŠ Namespace ä»¥ç¯å¢ƒå˜é‡çš„æ–¹å¼æ³¨å…¥ï¼Œé‚£ä¹ˆå°±å¯ä»¥ä¸ç”¨å†å†™ <code>namespace</code> è¿™ä¸ªå‚æ•°äº†ï¼Œå²‚ä¸ç¾å“‰ï¼Ÿ</p><span id="more"></span><h2 id="Property-Wrapper"><a href="#Property-Wrapper" class="headerlink" title="Property Wrapper"></a>Property Wrapper</h2><p>Property Wrapper æ˜¯ SwiftUI ä¸­çš„ä¸€å¤§åˆ©å™¨ï¼Œå®ƒæ— å¤„ä¸åœ¨ï¼š<code>@State</code>ï¼Œ<code>@Binding</code>ï¼Œ<code>@ObservedObject</code>â€¦â€¦</p><p>å€Ÿæ­¤æœºä¼šï¼Œæˆ‘ä¹Ÿæ¥å¥½å¥½åœ°å­¦ä¹ ä¸‹å¦‚ä½•è‡ªå·±å†™ä¸€ä¸ª Property Wrapperã€‚</p><p>é¦–å…ˆï¼Œç”¨ <code>@propertyWrapper</code> æ¥æ ‡æ³¨ä»–å®ƒæ˜¯ä¸€ä¸ªåŒ…è£…å™¨ã€‚</p><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">@propertyWrapper</span></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">InheritNamespace</span> &#123;</span><br><span class="line">  <span class="operator">...</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p> ç”±äºæ­¤æ—¶æˆ‘ä»¬æƒ³è¦ä»ç¯å¢ƒå˜é‡ä¸­è¯»å–åˆ° <code>Namespace</code>ï¼Œå› æ­¤è¿˜éœ€è¦åˆ›å»º <code>EnvironmentValue</code></p><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">struct</span> <span class="title class_">NamespaceKey</span>: <span class="title class_">EnvironmentKey</span> &#123;</span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">var</span> defaultValue: <span class="type">Namespace</span>.<span class="type">ID</span>? <span class="operator">=</span> <span class="literal">nil</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">extension</span> <span class="title class_">EnvironmentValues</span> &#123;</span><br><span class="line">    <span class="keyword">var</span> namespace: <span class="type">Namespace</span>.<span class="type">ID</span>? &#123;</span><br><span class="line">        <span class="keyword">get</span> &#123; <span class="keyword">self</span>[<span class="type">NamespaceKey</span>.<span class="keyword">self</span>] &#125;</span><br><span class="line">        <span class="keyword">set</span> &#123; <span class="keyword">self</span>[<span class="type">NamespaceKey</span>.<span class="keyword">self</span>] <span class="operator">=</span> newValue &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">extension</span> <span class="title class_">View</span> &#123;</span><br><span class="line">    <span class="keyword">func</span> <span class="title function_">namespace</span>(<span class="keyword">_</span> <span class="params">namespace</span>: <span class="type">Namespace</span>.<span class="type">ID</span>?) -&gt; <span class="keyword">some</span> <span class="type">View</span> &#123;</span><br><span class="line">        environment(\.namespace, namespace)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></blockquote><p>ç¬¬äºŒæ­¥ï¼Œè¯»å–ç¯å¢ƒå˜é‡ä¸­çš„ <code>Namespace.ID</code></p><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">@propertyWrapper</span></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">InheritNamespace</span>: <span class="title class_">DynamicProperty</span> &#123;</span><br><span class="line">    <span class="meta">@Environment</span>(\.namespace) <span class="keyword">private</span> <span class="keyword">var</span> parentNamespace</span><br><span class="line">    <span class="operator">...</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ç¬¬ä¸‰æ­¥ï¼Œæä¾› <code>WrappedValue</code></p><blockquote><p>Property Wrapperï¼ˆå±æ€§åŒ…è£…å™¨ï¼‰ï¼Œé¡¾åæ€ä¹‰ï¼ŒæŠŠä¸€ä¸ªå±æ€§åŒ…è£…èµ·æ¥ã€‚</p><p>å½“æˆ‘ä»¬ä½¿ç”¨ <code>@PropertyWrapper var variable</code> æ—¶ï¼Œæˆ‘ä»¬å¸Œæœ›ä½¿ç”¨åŸæœ¬çš„ç±»å‹ï¼Œè€Œä¸æ˜¯ Property Wrapper çš„ç±»å‹</p><p> <code>wrappedValue</code> æ˜¯ä¸€ä¸ªè®¡ç®—å±æ€§ï¼Œç”¨äº <strong>è·å–åŒ…è£…ä¸‹çš„å€¼</strong> ä»¥åŠ <strong>ä¿®æ”¹æŸä¸ªå€¼</strong></p></blockquote><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">@propertyWrapper</span></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">InheritNamespace</span> &#123;</span><br><span class="line">    <span class="meta">@Environment</span>(\.namespace) <span class="keyword">private</span> <span class="keyword">var</span> parentNamespace</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">var</span> wrappedValue: <span class="type">Namespace</span>.<span class="type">ID</span>? &#123;</span><br><span class="line">        parentNamespace</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>åˆ°æ­¤ä¸ºæ­¢ï¼ŒåŸºæœ¬ä¸Šå°±å¤§åŠŸå‘Šæˆäº†ã€‚</p><p>ä½†æ˜¯ï¼Œè¿™é‡Œåªèƒ½è·å–åˆ°ä¸€ä¸ª Optional çš„å€¼ï¼Œæ˜¾ç„¶åœ¨ <code>matchedGeometryEffect</code> ä¸­ä½¿ç”¨å¹¶ä¸æ–¹ä¾¿ï¼Œè§£å†³æ–¹æ¡ˆæ˜¯ï¼Œå†åˆ›å»ºä¸€ä¸ªç‹¬ç«‹çš„ <code>Namespace</code> ä½œä¸ºå€™è¡¥ Namespace</p><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">@propertyWrapper</span></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">InheritNamespace</span> &#123;</span><br><span class="line">    <span class="meta">@Namespace</span> <span class="keyword">private</span> <span class="keyword">var</span> newNamespace</span><br><span class="line">    <span class="meta">@Environment</span>(\.namespace) <span class="keyword">private</span> <span class="keyword">var</span> parentNamespace</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">var</span> wrappedValue: <span class="type">Namespace</span>.<span class="type">ID</span> &#123;</span><br><span class="line">        parentNamespace <span class="operator">??</span> newNamespace</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æ­¤æ—¶ï¼Œå°è¯•åœ¨ View ä¸­ä½¿ç”¨è¿™ä¸ª Property Wrapper ä¼šå‘ç°æŠ¥ Runtime Error</p><article class="message is-danger">                <div class="message-body">            <p>Accessing Environment&lt;Optional<ID>&gt;â€™s value outside of being installed on a View. This will always read the default value and will not update.</p><p>Reading a Namespace property outside View.body. This will result in identifiers that never match any other identifier.</p>        </div>    </article><h2 id="Dynamic-Property"><a href="#Dynamic-Property" class="headerlink" title="Dynamic Property"></a>Dynamic Property</h2><p>ä¸Šé¢çš„é”™è¯¯æç¤ºè¡¨æ˜ï¼Œæˆ‘ä»¬éœ€è¦åœ¨ View å†…éƒ¨æ‰èƒ½ä½¿ç”¨ <code>@Environment</code>ï¼Œ<code>@Namespace</code></p><p>è¿™æ˜¯å› ä¸ºï¼Œå½“ View åˆ·æ–°æ—¶ï¼Œå†…å®¹å¯èƒ½ä¼šå‘ç”Ÿå˜åŒ–ï¼Œæ­¤æ—¶ Property Wrapper ä¸­çš„å€¼ä¸èƒ½ä¸è§†å›¾ä¿æŒåŒæ­¥åˆ·æ–°ã€‚</p><p>æ­¤æ—¶ï¼ŒEnvironment åªä¼šä½¿ç”¨ default Valueï¼ŒNamespace åˆ™ä¸ä¼šä¸ä»»ä½• View å…³è”ã€‚</p><p>åŒæ—¶ï¼Œå½“æˆ‘ä»¬åœ¨ Property Wrapper ä¸­ä¿®æ”¹ Environment å€¼æ—¶ä¹Ÿä¸ä¼šåˆ·æ–°è§†å›¾ï¼ˆSwiftUI ä¸çŸ¥ä½•æ—¶åˆ·æ–°&#x2F;åŒæ­¥æ•°æ®ï¼‰</p><p>è§£å†³æ–¹æ¡ˆä¹Ÿå¾ˆç®€å•ï¼Œç»™æˆ‘ä»¬çš„ Property Wrapper æ·»åŠ  <code>DynamicProperty</code> Protocol å³å¯ã€‚</p><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">@propertyWrapper</span></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">InheritNamespace</span>: <span class="title class_">DynamicProperty</span> &#123;</span><br><span class="line">   <span class="operator">...</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¿™æ ·ï¼Œå°±å¯ä»¥æ„‰å¿«åœ°åœ¨è‡ªå®šä¹‰çš„ Property Wrapper ä¸­ä½¿ç”¨ SwiftUI çš„ Property Wrappers äº†ï¼ŒDynamic Property èƒŒåçš„ <code>update()</code>  ä¼šå¸®åŠ©æˆ‘ä»¬å¤„ç†æ•°æ®åŒæ­¥ï¼Œä»¥åŠåœ¨æ•°æ®å˜åŒ–æ—¶åˆ·æ–°è§†å›¾</p><p>å¦‚æœè¿™éƒ¨åˆ†ä»ç„¶ä¸ç†è§£ï¼Œå¯ä»¥å‚è€ƒè¿™ä¸ªæ•™ç¨‹ï¼š<a href="https://www.hackingwithswift.com/plus/intermediate-swiftui/creating-a-custom-property-wrapper-using-dynamicproperty">https://www.hackingwithswift.com/plus/intermediate-swiftui/creating-a-custom-property-wrapper-using-dynamicproperty</a></p><h3 id="SwiftUI-Built-in-Property-Wrappers"><a href="#SwiftUI-Built-in-Property-Wrappers" class="headerlink" title="SwiftUI Built-in Property Wrappers"></a>SwiftUI Built-in Property Wrappers</h3><p>SwiftUI çš„æºç æˆ‘ä»¬å¹¶ä¸èƒ½ç›´æ¥çœ‹åˆ°ï¼Œä½†æ˜¯å¯ä»¥é€šè¿‡ Swift Interface æ¥åˆ†æã€‚</p><blockquote><p>[XcodePath]&#x2F;Contents&#x2F;Developer&#x2F;Platforms&#x2F;iPhoneOS.platform&#x2F;Developer&#x2F;SDKs&#x2F;iPhoneOS.sdk&#x2F;System&#x2F;Library&#x2F;Frameworks&#x2F;SwiftUI.framework&#x2F;Modules&#x2F;SwiftUI.swiftmodule&#x2F;</p></blockquote><p>åŸºæœ¬æ‰€æœ‰çš„ SwiftUI å†…ç½® Property Wrappers éƒ½æ˜¯ç”¨äº† <code>DynamicProperty</code>ï¼Œè¿™ä½¿å¾— SwiftUI çš„æ¸²æŸ“å¼•æ“çŸ¥é“è§†å›¾å†…çš„å€¼ä½•æ—¶å‘ç”Ÿäº†å˜åŒ–ï¼Œç„¶åè§¦å‘è§†å›¾åˆ·æ–°ï¼Œè¿™æ˜¯ä¸€ä¸ªå¾ˆé‡è¦çš„æœºåˆ¶ï¼Œ<strong>ç¡®ä¿äº† Property Wrapper ä¸­çš„å€¼ä¸å½“å‰è§†å›¾çš„çŠ¶æ€å§‹ç»ˆä¿æŒåŒæ­¥</strong>ã€‚</p><h2 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h2><h3 id="å®Œæ•´ä»£ç "><a href="#å®Œæ•´ä»£ç " class="headerlink" title="å®Œæ•´ä»£ç "></a>å®Œæ•´ä»£ç </h3><script src="https://gist.github.com/LiYanan2004/1fd276fb4b266204ec04a67fc12dc429.js"></script><h3 id="ä½¿ç”¨æ–¹æ³•"><a href="#ä½¿ç”¨æ–¹æ³•" class="headerlink" title="ä½¿ç”¨æ–¹æ³•"></a>ä½¿ç”¨æ–¹æ³•</h3><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> SwiftUI</span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">ContentView</span>: <span class="title class_">View</span> &#123;</span><br><span class="line">    <span class="meta">@Namespace</span> <span class="keyword">private</span> <span class="keyword">var</span> showDetail <span class="operator">=</span> <span class="literal">false</span></span><br><span class="line">    <span class="meta">@Namespace</span> <span class="keyword">private</span> <span class="keyword">var</span> <span class="type">NAMESPACE</span></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">var</span> body: <span class="keyword">some</span> <span class="type">View</span> &#123;</span><br><span class="line">       <span class="type">ZStack</span> &#123;</span><br><span class="line">            <span class="operator">...</span></span><br><span class="line">          </span><br><span class="line">            <span class="keyword">if</span> showDetail &#123;</span><br><span class="line">                <span class="type">DetailView</span>()</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        .namespace(<span class="type">NAMESPACE</span>)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">DetailView</span>: <span class="title class_">View</span> &#123;</span><br><span class="line">    <span class="meta">@InheritNamespace</span> <span class="keyword">private</span> <span class="keyword">var</span> namespace</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">var</span> body: <span class="keyword">some</span> <span class="type">View</span> &#123;</span><br><span class="line">        <span class="operator">...</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
    
    
    <summary type="html">&lt;p&gt;ä½ æ˜¯å¦å†™è¿‡è¿™æ ·çš„ä»£ç ï¼š&lt;code&gt;DetailView(namespace: namespace, isSource: selected == nil)&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;æˆ–è€…è¿™æ ·çš„ï¼š&lt;code&gt;DetailView(namespace: Namespace().wrappedValue, isSource: false)&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;è¿™åŸºæœ¬ä¸Šæ˜¯æ¯ä¸€æ¬¡å†™ Hero åŠ¨ç”»æ—¶å¿…ä¸å¯å°‘çš„ä¸¤ä¸ªå‚æ•°ã€‚&lt;/p&gt;
&lt;p&gt;å¦‚æœè¿˜æœ‰æ›´å¤æ‚çš„éœ€æ±‚ï¼Œä¸€ä¸ª View å¯èƒ½ä¼šæœ‰æ›´å¤šçš„å‚æ•°éœ€è¦ä¼ é€’ã€‚&lt;/p&gt;
&lt;p&gt;å…¶å®ï¼Œå¾ˆä¹…ä¹‹å‰æˆ‘å°±åœ¨æƒ³ï¼Œå¦‚æœæŠŠ Namespace ä»¥ç¯å¢ƒå˜é‡çš„æ–¹å¼æ³¨å…¥ï¼Œé‚£ä¹ˆå°±å¯ä»¥ä¸ç”¨å†å†™ &lt;code&gt;namespace&lt;/code&gt; è¿™ä¸ªå‚æ•°äº†ï¼Œå²‚ä¸ç¾å“‰ï¼Ÿ&lt;/p&gt;</summary>
    
    
    
    <category term="æ’¸ä»£ç " scheme="https://liyanan2004.github.io/categories/%E6%92%B8%E4%BB%A3%E7%A0%81/"/>
    
    
    <category term="SwiftUI" scheme="https://liyanan2004.github.io/tags/SwiftUI/"/>
    
    <category term="Animation" scheme="https://liyanan2004.github.io/tags/Animation/"/>
    
  </entry>
  
  <entry>
    <title>2023 æš‘å‡æ€»ç»“</title>
    <link href="https://liyanan2004.github.io/2023-summer-summary/"/>
    <id>https://liyanan2004.github.io/2023-summer-summary/</id>
    <published>2023-09-09T08:09:29.977Z</published>
    <updated>2023-09-09T08:23:28.494Z</updated>
    
    <content type="html"><![CDATA[<p>ä»Šå¤©æ˜¯ 9 æœˆ 9 æ—¥ï¼Œè·ç¦»æˆ‘å¤§äºŒå¼€å­¦è¿˜æœ‰ 9 å¤©ï¼Œç°åœ¨è¯¥æ˜¯æ€»ç»“çš„æ—¶å€™äº†ã€‚</p><p>è®¡åˆ’å¾ˆç¾å¥½ï¼Œç°å®å¾ˆéª¨æ„Ÿã€‚</p><p>æ”¾å‡å‰è®¡åˆ’åœ¨å°†è¿‘ 3 ä¸ªæœˆçš„å‡æœŸä¸­å»å‚ä¸å®ä¹ ï¼Œä½†æ˜¯ç”±äºå„æ–¹é¢çš„åŸå› æ²¡èƒ½è¾¾æˆï¼Œç®—æ˜¯ä¸€ç‚¹é—æ†¾ã€‚</p><p>ä½†æ˜¯æ¢ä¸ªè§’åº¦æ¥çœ‹ï¼Œè¿™ä¹Ÿç•™ç»™æˆ‘æ›´å¤šçš„å¯è‡ªç”±æ”¯é…çš„æ—¶é—´å»ç ”ç©¶äº›å¾ˆæœ‰æ„æ€çš„ä¸œè¥¿ã€‚</p><p>æˆ‘å¯¹è¿™ä¸ªæš‘å‡çš„è¯„ä»·æ˜¯ï¼šç›¸å¯¹å……å®ã€‚</p><h2 id="æš‘å‡ä¸­åšçš„é¡¹ç›®ä»¬"><a href="#æš‘å‡ä¸­åšçš„é¡¹ç›®ä»¬" class="headerlink" title="æš‘å‡ä¸­åšçš„é¡¹ç›®ä»¬"></a>æš‘å‡ä¸­åšçš„é¡¹ç›®ä»¬</h2><h3 id="1-Apple-ï£¿-Internal"><a href="#1-Apple-ï£¿-Internal" class="headerlink" title="1. Apple ï£¿ Internal"></a>1. Apple ï£¿ Internal</h3><h3 id="2-Apple-SSC-2024-å‚èµ›é¡¹ç›®"><a href="#2-Apple-SSC-2024-å‚èµ›é¡¹ç›®" class="headerlink" title="2. Apple SSC 2024 å‚èµ›é¡¹ç›®"></a>2. Apple SSC 2024 å‚èµ›é¡¹ç›®</h3><h3 id="3-MarkdownView"><a href="#3-MarkdownView" class="headerlink" title="3. MarkdownView"></a>3. MarkdownView</h3><ul><li>Customizable foreground style in <a href="https://github.com/LiYanan2004/MarkdownView/pull/21">#21</a></li><li>Add font group protocol in <a href="https://github.com/LiYanan2004/MarkdownView/pull/22">#22</a></li><li>Unleash the power of Block Directive in <a href="https://github.com/LiYanan2004/MarkdownView/pull/23">#23</a></li><li>AnyImageDisplayable &amp; AnyBlockDirectiveDisplayable are now available.</li><li>Fix malloc: double free for ptr crashes</li><li>Add rendering mode for MarkdownView</li></ul><h3 id="4-Always-Animating-Widget"><a href="#4-Always-Animating-Widget" class="headerlink" title="4. Always Animating Widget"></a>4. Always Animating Widget</h3><ul><li>æ‰“åŒ… XCFramework</li><li>æ”¯æŒ iOS &#x2F; macOS Native</li><li>å®Œç¾æ”¯æŒä»»ä½•åœºæ™¯ä¸‹çš„æ—‹è½¬ &#x2F; å¹³ç§»</li><li>ç”± Swift Package å°è£…</li></ul><blockquote><p>è¯¥é¡¹ç›®è¿˜ä¸ºæˆ‘å¸¦æ¥äº†ä¸€äº›æ”¶ç›Šï¼ŒæŒ£äº†ä¸€äº›ç”Ÿæ´»è´¹å“ˆå“ˆ ğŸ˜†</p></blockquote><h3 id="5-SwiftUI-Cross-Over"><a href="#5-SwiftUI-Cross-Over" class="headerlink" title="5. SwiftUI Cross-Over"></a>5. SwiftUI Cross-Over</h3><ul><li>Find platform specific views &#x2F; view controllers.</li><li>Attach customizations that SwiftUI not supported but UIKit &#x2F; AppKit supported.</li><li>Highly readable API Design</li></ul><h3 id="6-HSSHacker"><a href="#6-HSSHacker" class="headerlink" title="6. HSSHacker"></a>6. HSSHacker</h3><blockquote><p><strong>High School Sport Hacker</strong></p><p>æˆ‘ç‹¬ç«‹å¼€å‘çš„ï¼Œç”¨äºé«˜æ ¡ä½“è‚²è·‘æ­¥æ‰“å¡çš„ macOS APP ğŸ˜</p></blockquote><ul><li>é€‚é… SwiftUI 5 MapKit</li><li>ä¿®æ”¹æ•´ä½“å¸ƒå±€ï¼ŒUI æ¢æ–°</li></ul><h3 id="7-å›¾åƒæ°´å°æŠ€æœ¯"><a href="#7-å›¾åƒæ°´å°æŠ€æœ¯" class="headerlink" title="7. å›¾åƒæ°´å°æŠ€æœ¯"></a>7. å›¾åƒæ°´å°æŠ€æœ¯</h3><ul><li>éšæ°´å°ï¼šåƒç´ è¯»å–ï¼ŒCGContext</li><li>ç›²æ°´å°ï¼šå‚…ç«‹å¶å˜æ¢ï¼ŒAccelerate æ¡†æ¶</li></ul>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;ä»Šå¤©æ˜¯ 9 æœˆ 9 æ—¥ï¼Œè·ç¦»æˆ‘å¤§äºŒå¼€å­¦è¿˜æœ‰ 9 å¤©ï¼Œç°åœ¨è¯¥æ˜¯æ€»ç»“çš„æ—¶å€™äº†ã€‚&lt;/p&gt;
&lt;p&gt;è®¡åˆ’å¾ˆç¾å¥½ï¼Œç°å®å¾ˆéª¨æ„Ÿã€‚&lt;/p&gt;
&lt;p&gt;æ”¾å‡å‰è®¡åˆ’åœ¨å°†è¿‘ 3 ä¸ªæœˆçš„å‡æœŸä¸­å»å‚ä¸å®ä¹ ï¼Œä½†æ˜¯ç”±äºå„æ–¹é¢çš„åŸå› æ²¡èƒ½è¾¾æˆï¼Œç®—æ˜¯ä¸€ç‚¹é—æ†¾ã€‚&lt;/p&gt;
&lt;p&gt;ä½†æ˜¯æ¢ä¸ªè§’åº¦æ¥çœ‹ï¼Œè¿™ä¹Ÿç•™ç»™æˆ‘æ›´å¤šçš„å¯è‡ª</summary>
      
    
    
    
    
  </entry>
  
  <entry>
    <title>å°æŠ€å·§ï¼šè®©ä»»ä½•ç±»å‹éµå¾ª Equatable</title>
    <link href="https://liyanan2004.github.io/make-everything-equatable/"/>
    <id>https://liyanan2004.github.io/make-everything-equatable/</id>
    <published>2023-07-30T12:08:47.114Z</published>
    <updated>2023-07-30T13:37:08.798Z</updated>
    
    <content type="html"><![CDATA[<p>å†™ Swift çš„åŒå­¦ä»¬åº”è¯¥éƒ½ä¸é™Œç”Ÿ Equatable å§ã€‚</p><p>è®©ä¸€ä¸ªç±»å‹éµå¾ª Equatable éœ€è¦æä¾›ä¸€ä¸ªé™æ€å‡½æ•° <code>==</code>ï¼Œåœ¨æŸäº›æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬æ— æ³•ç›´æ¥é€šè¿‡è®¡ç®—æˆ–è€…ç›´æ¥æ¯”è¾ƒå±æ€§å€¼æ¥è¿”å›æ˜¯å¦ç›¸ç­‰æ—¶ï¼Œæˆ‘ä»¬åˆè¯¥å¦‚ä½•å¤„ç†å‘¢ï¼Ÿ</p><span id="more"></span><h2 id="ä¸€èˆ¬æƒ…å†µ"><a href="#ä¸€èˆ¬æƒ…å†µ" class="headerlink" title="ä¸€èˆ¬æƒ…å†µ"></a>ä¸€èˆ¬æƒ…å†µ</h2><h3 id="ç®€å•å®ç°"><a href="#ç®€å•å®ç°" class="headerlink" title="ç®€å•å®ç°"></a>ç®€å•å®ç°</h3><p>å¯¹äºå·¦å³ä¾§å€¼å¯æ¯”è¾ƒçš„æƒ…å†µä¸‹ï¼Œå¯ä»¥ç›´æ¥å®ç° <code>==</code></p><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">func</span> <span class="title function_">==</span> (<span class="params">lhs</span>: <span class="type">CustomType</span>, <span class="params">rhs</span>: <span class="type">CustomType</span>) -&gt; <span class="type">Bool</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> lhs.property1 <span class="operator">==</span> rhs.property1 <span class="operator">&amp;&amp;</span> lhs.property2 <span class="operator">==</span> rhs.property2</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="æ¯”å¯¹-ID"><a href="#æ¯”å¯¹-ID" class="headerlink" title="æ¯”å¯¹ ID"></a>æ¯”å¯¹ ID</h3><p>å¦‚æœè¯¥ç±»å‹éµå¾ª <code>Identifiable</code>ï¼Œå¯ä»¥å¯¹æ¯” ID å€¼æ¥åˆ¤æ–­æ˜¯å¦ç›¸ç­‰ã€‚</p><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">func</span> <span class="title function_">==</span> (<span class="params">lhs</span>: <span class="type">IdentifiableType</span>, <span class="params">rhs</span>: <span class="type">IdentifiableType</span>) -&gt; <span class="type">Bool</span> &#123; Â  Â </span><br><span class="line">  <span class="keyword">return</span> lhs.id <span class="operator">==</span> rhs.id</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="æ¯”å¯¹å“ˆå¸Œå€¼"><a href="#æ¯”å¯¹å“ˆå¸Œå€¼" class="headerlink" title="æ¯”å¯¹å“ˆå¸Œå€¼"></a>æ¯”å¯¹å“ˆå¸Œå€¼</h3><p>å¦‚æœè¯¥ç±»å‹éµå¾ª <code>Hashable</code>ï¼Œæˆ‘ä»¬å¯ä»¥åˆ©ç”¨å“ˆå¸Œå€¼çš„å”¯ä¸€æ€§æ¥åˆ¤æ–­ä¸¤ä¸ªå€¼æ˜¯å¦ç›¸ç­‰ã€‚</p><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">func</span> <span class="title function_">==</span> (<span class="params">lhs</span>: <span class="type">HashableType</span>, <span class="params">rhs</span>: <span class="type">HashableType</span>) -&gt; <span class="type">Bool</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> lhs.hashValue <span class="operator">==</span> rhs.hashValue</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="æŸäº›æƒ…å†µæ˜¯ä»€ä¹ˆæƒ…å†µï¼Ÿ"><a href="#æŸäº›æƒ…å†µæ˜¯ä»€ä¹ˆæƒ…å†µï¼Ÿ" class="headerlink" title="æŸäº›æƒ…å†µæ˜¯ä»€ä¹ˆæƒ…å†µï¼Ÿ"></a>æŸäº›æƒ…å†µæ˜¯ä»€ä¹ˆæƒ…å†µï¼Ÿ</h2><p>æ‹¿æˆ‘çš„å¼€æºé¡¹ç›® <code>MarkdownView</code> ä¸¾ä¸ªä¾‹å­ï¼Œæœ‰äººæäº†ä¸€ä¸ª Feature Request å¸Œæœ›èƒ½å¤Ÿè‡ªå®šä¹‰å„ä¸ªå±‚çº§çš„å­—ä½“æ ·å¼ï¼ˆ<a href="https://github.com/LiYanan2004/MarkdownView/issues/20">#20</a>ï¼‰</p><p>å‚è€ƒä¹‹å‰æ›´æ”¹å­—ä½“çš„ modifier å’Œå®ç°å…¶å®è¿˜ä¸éš¾ï¼Œå”¯ä¸€çš„ä¸åŒæ˜¯ <code>SwiftUI.Font</code> æ˜¯ä¸€ä¸ªå…·ä½“çš„ç±»å‹ï¼Œè€Œæ ·å¼éœ€è¦ä½¿ç”¨ <code>ShapeStyle</code> ï¼Œå®ƒå¹¶ä¸æ˜¯ä¸€ä¸ªç¡®åˆ‡çš„ç±»å‹ï¼Œå› æ­¤å¯¹äºæ¯ä¸€ä¸ªå­—æ®µæˆ‘éƒ½ä½¿ç”¨ç±»å‹æ“¦é™¤ <code>AnyShapeStyle</code> æ¥èµ‹å€¼ã€‚</p><p><strong>åœ¨æˆ‘çœ‹æ¥ï¼ŒSwiftUI API åº”è¯¥æ˜¯èƒ½å¤Ÿæ ¹æ®å½“å‰çŠ¶æ€å®æ—¶å“åº”çš„</strong>ï¼Œä¹Ÿå°±æ˜¯è¯´å’ŒåŸç”Ÿçš„ <code>.foregroundStyle(some ShapeStyle)</code> ä¸€æ ·ï¼Œæˆ‘å¯ä»¥ä½¿ç”¨ <code>@State</code> å®æ—¶åˆ‡æ¢ã€‚</p><p>å­—ä½“å’Œæ ·å¼éƒ½æ˜¯ç”± Provider æä¾›ï¼Œæ³¨å…¥åˆ° Content Renderer ä¸­ï¼Œç”± Content Renderer ç»Ÿä¸€åˆ†é…ï¼Œå½“æ ·å¼å˜åŒ–åï¼Œéœ€è¦é‡æ–°æ¸²æŸ“é¡µé¢ï¼Œè¿™é‡Œå°±éœ€è¦è®© Providers éƒ½éµå¾ª Equatableï¼Œè¿™æ ·å°±å¯ä»¥åˆ¤æ–­å€¼æ˜¯å¦å‘ç”Ÿäº†å˜åŒ–æ¥å†³å®šæ˜¯å¦é‡æ–°æ¸²æŸ“ã€‚</p><p>FontProvider ä¸­å…¨æ˜¯ <code>SwiftUI.Font</code>ï¼Œéƒ½å·²ç»åŒ…å«äº† Equatableã€‚</p><p>ForegroundStyleProvider ä¸­å…¨æ˜¯ <code>SwiftUI.AnyShapeStyle</code>ï¼Œæ²¡æœ‰æä¾› Equatableï¼Œä¸”ç”±äºå…¶ç‰¹æ®Šæ€§ï¼Œæ— æ³•ç›´æ¥åˆ¤æ–­ä¸¤ä¸ª ShapeStyle æ˜¯å¦ç›¸ç­‰ã€‚</p><p>è¿™é‡Œå¯èƒ½æœ‰ä¸¤ç§å¯èƒ½çš„è§£å†³æ–¹æ¡ˆï¼š</p><ol><li><p>ä¸ç®¡å®æ—¶å˜åŒ–çš„å€¼ï¼Œä¿ç•™åŸæ ·ï¼›</p></li><li><p>æ— è®ºä¸‰ä¸ƒäºŒåä¸€ï¼Œåˆ·æ–°é¡µé¢ã€‚</p></li></ol><p><strong>éƒ½æœ‰å–èˆï¼Œä¸èƒ½æ»¡è¶³æˆ‘çš„éœ€æ±‚ã€‚</strong></p><h2 id="å·§ç”¨-CustomStringConvertible"><a href="#å·§ç”¨-CustomStringConvertible" class="headerlink" title="å·§ç”¨ CustomStringConvertible"></a>å·§ç”¨ <code>CustomStringConvertible</code></h2><p>æˆ‘åšçš„ç¬¬ä¸€ä¸ªå°è¯•æ˜¯åœ¨ Equatable æ¯”è¾ƒæ–¹æ³•ä¸­ä½¿ç”¨ <code>String(describing: lhs) == String(describing: rhs)</code></p><p>è¿™æ ·å¯ä»¥å°† ShapeStyle è½¬æ¢ä¸ºä¸€æ®µæ–‡æœ¬æè¿°ï¼Œä½†æ˜¯ï¼Œå¹¶ä¸è§£å†³é—®é¢˜ã€‚</p><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@State</span> <span class="keyword">private</span> <span class="keyword">var</span> color <span class="operator">=</span> <span class="type">Color</span>.red</span><br><span class="line"></span><br><span class="line"><span class="type">MarkdownView</span>(<span class="operator">...</span>)</span><br><span class="line">    .foregroundStyle(color, for: .h1)</span><br><span class="line">    .onTapGesture &#123; </span><br><span class="line">        color <span class="operator">=</span> <span class="type">Color</span>(red: <span class="type">Double</span>.random(in: <span class="number">0</span><span class="operator">...</span><span class="number">1</span>), </span><br><span class="line">                      green: <span class="type">Double</span>.random(in: <span class="number">0</span><span class="operator">...</span><span class="number">1</span>), </span><br><span class="line">                      blue: <span class="type">Double</span>.random(in: <span class="number">0</span><span class="operator">...</span><span class="number">1</span>)) </span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure><p>ä»¥ä¸Šä»£ç åœ¨ç¨‹åºä¸­çš„è¡¨ç°ä¸ºï¼šç¬¬ä¸€æ¬¡æ”¹å˜é¢œè‰²æ²¡é—®é¢˜ï¼Œä½†æ˜¯å†æ¬¡æ”¹å˜åå°±æ²¡ååº”äº†ã€‚</p><blockquote><p>AnyShapeStyle(storage: SwiftUI.AnyShapeStyle.Storage(box: SwiftUI.(unknown context at $1ae807e94).ColorBox&lt;SwiftUI.SystemColorType&gt;))</p></blockquote><h2 id="è¿½æ ¹æº¯æº"><a href="#è¿½æ ¹æº¯æº" class="headerlink" title="è¿½æ ¹æº¯æº"></a>è¿½æ ¹æº¯æº</h2><p>æ—¢ç„¶æ— æ³•ç›´æ¥æ¥åˆ¤æ–­ä¸¤ä¸ª <code>AnyShapeStyle</code> æ˜¯å¦ç›¸åŒï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±ä»ä»–ä»¬çš„å­˜å‚¨æ–¹å¼ä¸‹æ‰‹ï¼Œä»»ä½•ä¸€ç§ç±»å‹éƒ½å¯¹åº”ç€ã€Œæ•°æ®ã€ï¼Œä»»ä½•ä¸€ä¸ªå±æ€§ä¸åŒéƒ½ä¼šå¯¼è‡´æ•°æ®å±‚é¢çš„å˜åŒ–ã€‚</p><p>å¦‚æœä¸¤ä¸ªå€¼å¯¹åº”çš„æ•°æ®ä¸€æ¨¡ä¸€æ ·ï¼Œä¾¿å¯ä»¥è®¤ä¸ºä»–ä»¬æ˜¯ä¸€è‡´çš„ã€‚</p><p>è¿™é‡Œå¯ä»¥ç›´æ¥ä½¿ç”¨ Swift çš„ <code>Data</code> ç±»å‹ï¼Œè™½ç„¶ä¸æ˜¯ Equatable çš„ï¼Œä½†æ˜¯éµå¾ªäº† Hashableï¼Œå¯ä»¥å¤§è‡´åˆ¤æ–­å‡ºä¸¤ä¸ª Data æ˜¯å¦ç›¸åŒã€‚</p><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">func</span> <span class="title function_">==</span> (<span class="params">lhs</span>: <span class="type">AnyShapeStyle</span>, <span class="params">rhs</span>: <span class="type">AnyShapeStyle</span>) -&gt; <span class="type">Bool</span> &#123;</span><br><span class="line">    <span class="keyword">let</span> oldBuffer <span class="operator">=</span> withUnsafeBytes(of: oldValue) &#123; <span class="variable">$0</span> &#125;</span><br><span class="line">    <span class="keyword">let</span> newBuffer <span class="operator">=</span> withUnsafeBytes(of: newValue) &#123; <span class="variable">$0</span> &#125;</span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">let</span> oldPointer <span class="operator">=</span> oldBuffer.baseAddress,</span><br><span class="line">       <span class="keyword">let</span> newPointer <span class="operator">=</span> newBuffer.baseAddress &#123;</span><br><span class="line">        <span class="comment">// Read bytes</span></span><br><span class="line">        <span class="keyword">let</span> oldBytes <span class="operator">=</span> <span class="type">Data</span>(bytes: oldPointer, count: oldBuffer.count)</span><br><span class="line">        <span class="keyword">let</span> newBytes <span class="operator">=</span> <span class="type">Data</span>(bytes: newPointer, count: newBuffer.count)</span><br><span class="line">     </span><br><span class="line">        <span class="comment">// Compare hash values of two data type</span></span><br><span class="line">        <span class="keyword">return</span> oldBytes.hashValue <span class="operator">==</span> newBytes.hashValue</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æµ‹è¯•äº†ä¸‹ï¼Œå®Œç¾ï¼</p><p>è¿™æ ·ä¸€æ¥ï¼Œå°±å¯ä»¥ä¿è¯é¡µé¢æ ¹æ®æ ·å¼é…ç½®å®æ—¶åˆ·æ–°ï¼ŒåŒæ—¶ä¿æŒæŒ‰éœ€æ¸²æŸ“ã€‚</p>]]></content>
    
    
    <summary type="html">&lt;p&gt;å†™ Swift çš„åŒå­¦ä»¬åº”è¯¥éƒ½ä¸é™Œç”Ÿ Equatable å§ã€‚&lt;/p&gt;
&lt;p&gt;è®©ä¸€ä¸ªç±»å‹éµå¾ª Equatable éœ€è¦æä¾›ä¸€ä¸ªé™æ€å‡½æ•° &lt;code&gt;==&lt;/code&gt;ï¼Œåœ¨æŸäº›æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬æ— æ³•ç›´æ¥é€šè¿‡è®¡ç®—æˆ–è€…ç›´æ¥æ¯”è¾ƒå±æ€§å€¼æ¥è¿”å›æ˜¯å¦ç›¸ç­‰æ—¶ï¼Œæˆ‘ä»¬åˆè¯¥å¦‚ä½•å¤„ç†å‘¢ï¼Ÿ&lt;/p&gt;</summary>
    
    
    
    <category term="æ’¸ä»£ç " scheme="https://liyanan2004.github.io/categories/%E6%92%B8%E4%BB%A3%E7%A0%81/"/>
    
    
    <category term="Swift" scheme="https://liyanan2004.github.io/tags/Swift/"/>
    
    <category term="MarkdownView" scheme="https://liyanan2004.github.io/tags/MarkdownView/"/>
    
  </entry>
  
  <entry>
    <title>è¯•è¯•æ–°æ¡†æ¶ â€” TipKit</title>
    <link href="https://liyanan2004.github.io/meet-tipkit/"/>
    <id>https://liyanan2004.github.io/meet-tipkit/</id>
    <published>2023-07-27T04:40:52.272Z</published>
    <updated>2023-07-27T08:30:27.860Z</updated>
    
    <content type="html"><![CDATA[<p>ä»Šå¹´ WWDC æ–°å¢äº†ä¸å°‘çš„æ¡†æ¶ï¼Œè¿™ç¯‡åšå®¢ä¸“æ³¨äºç ”ç©¶ TipKit</p><blockquote><p><strong>Important</strong></p><p>In macOS 14 Beta 4, TipKit projects donâ€™t build in Simulator or for macOS due to macro â€œcould not be foundâ€ errors. A workaround for this issue is available in <a href="https://developer.apple.com/documentation/xcode-release-notes/xcode-15-release-notes#TipKit">Xcode release notes</a>.</p></blockquote><p><img src="/img/meet-tipkit/tipviews.png"></p><span id="more"></span><p>é¦–å…ˆï¼Œå¼•åŒ…ï¼š <code>import TipKit</code></p><h2 id="æç¤ºå†…å®¹"><a href="#æç¤ºå†…å®¹" class="headerlink" title="æç¤ºå†…å®¹"></a>æç¤ºå†…å®¹</h2><p>å®šä¹‰æç¤ºå†…å®¹ï¼ŒåŒ…å«ï¼šæ ‡é¢˜ï¼ˆå¿…é¡»ï¼‰ã€æè¿°ã€å›¾æ ‡ã€æŒ‰é’®ç­‰â€¦</p><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">struct</span> <span class="title class_">TappableTip</span>: <span class="title class_">Tip</span> &#123;</span><br><span class="line">    <span class="keyword">var</span> title <span class="operator">=</span> <span class="type">Text</span>(<span class="string">&quot;Tappable&quot;</span>)</span><br><span class="line">    <span class="comment">// var message = Text(&quot;Tap to see more info.&quot;) &lt;- don&#x27;t use this.</span></span><br><span class="line">    <span class="keyword">var</span> message: <span class="type">Text</span>? &#123;</span><br><span class="line">        <span class="type">Text</span>(<span class="string">&quot;Tap to see more info.&quot;</span>)</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// var asset = Image(systemName: &quot;hand.tap&quot;) &lt;- don&#x27;t use this.</span></span><br><span class="line">    <span class="keyword">var</span> asset: <span class="type">Image</span>? &#123;</span><br><span class="line">        <span class="type">Image</span>(systemName: <span class="string">&quot;hand.tap&quot;</span>)</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">var</span> actions: [<span class="type">Action</span>] &#123;</span><br><span class="line">        <span class="type">Action</span>(perform: &#123;</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;action 1&quot;</span>)</span><br><span class="line">        &#125;)&#123;</span><br><span class="line">            <span class="type">Text</span>(<span class="string">&quot;Action 1&quot;</span>)</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        <span class="type">Action</span>(perform: &#123;</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;action 2&quot;</span>)</span><br><span class="line">        &#125;)&#123;</span><br><span class="line">            <span class="type">Text</span>(<span class="string">&quot;Action 2&quot;</span>)</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¿™é‡Œéœ€è¦æ³¨æ„çš„æ˜¯ï¼Œ<code>message</code> &amp; <code>asset</code> ç±»å‹ä¸€å®šè¦æ‰‹åŠ¨å†™æˆ Optionalï¼Œå¦åˆ™å¯èƒ½æ— æ³•æ­£ç¡®æ˜¾ç¤ºã€‚</p><h2 id="æ˜¾ç¤ºä½ çš„ç¬¬ä¸€æ¡æç¤º"><a href="#æ˜¾ç¤ºä½ çš„ç¬¬ä¸€æ¡æç¤º" class="headerlink" title="æ˜¾ç¤ºä½ çš„ç¬¬ä¸€æ¡æç¤º"></a>æ˜¾ç¤ºä½ çš„ç¬¬ä¸€æ¡æç¤º</h2><p>åœ¨ SwiftUI ä¸­ï¼Œæœ‰ä¸¤ç§æ–¹å¼ï¼š</p><ul><li><code>TipView(TappableTip())</code>ï¼š Banner æ ·å¼</li><li><code>.popoverTip(TappableTip())</code>ï¼šPopover å¼¹çª—ï¼Œä¸ä¼ ç»Ÿ Popover ä¸åŒçš„æ˜¯éœ€è¦æ‰‹åŠ¨ç‚¹å‡»å…³é—­æŒ‰é’®æ‰ä¼šè§¦å‘ <code>dismiss</code> (macOSï¼‰</li></ul><p><img src="/img/meet-tipkit/macos-tip-popover-dismiss.gif"></p><p>å½“ä½ åŠ äº†è¿™äº›ä¹‹åï¼Œä½ ä¼šå‘ç°ï¼Œå•¥éƒ½æ²¡æœ‰â€¦</p><p>è¿™æ˜¯å› ä¸º TipView éœ€è¦å…ˆè¯»å–ä½ çš„è®¾ç½®:</p><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">RootView</span>()</span><br><span class="line">    .task &#123; <span class="keyword">try?</span> <span class="keyword">await</span> <span class="type">Tips</span>.configure() &#125;</span><br></pre></td></tr></table></figure><blockquote><p><strong>static func configure(@ConfigurationBuilder options: @escaping () -&gt; some TipsConfiguration &#x3D; { defaultConfiguration }) async throws</strong></p><p>Called at app startup to load and configure the persistent state of all tips in your app.</p></blockquote><p>å¯¹äº UIKit å’Œ AppKitï¼Œä¹Ÿæœ‰å¯¹åº”çš„<code>TipUIView</code> å’Œ <code>TipNSView</code>ï¼Œå…·ä½“å¯å‚è€ƒ<a href="https://developer.apple.com/documentation/tipkit#uikit-hosting-views">å®˜æ–¹æ–‡æ¡£è¯´æ˜</a></p><h2 id="é…ç½®"><a href="#é…ç½®" class="headerlink" title="é…ç½®"></a>é…ç½®</h2><p>åˆšæ‰ä¹Ÿæåˆ°äº†åœ¨ App å‘¨æœŸå†…éœ€è¦è°ƒç”¨ <code>Tips.configure()</code> æ¥é…ç½® TipViewï¼Œå…¶ä¸­æœ‰è¿™äº›å¯é…ç½®çš„é€‰é¡¹ï¼š</p><ul><li>é¢‘ç‡é™åˆ¶ï¼š<code>DisplayFrequency</code>ï¼Œåœ¨ä¸€ä¸ªå‘¨æœŸå†…ï¼ˆå°æ—¶ï¼Œå¤©ï¼Œæ˜ŸæœŸï¼Œæœˆâ€¦ï¼‰æœ€å¤šæ˜¾ç¤ºä¸€æ¡æç¤ºï¼Œåœ¨ <code>defaultConfiguration</code> ä¸­ï¼Œè¯¥å€¼ä¸º <code>.immediate</code>ï¼Œå³ä¸é™åˆ¶æ˜¾ç¤ºæ¡æ•°ã€‚</li><li>é…ç½®å­˜å‚¨ä½ç½®ï¼š<code>DatastoreLocation</code>ï¼Œåœ¨ <code>defaultConfiguration</code> ä¸­çš„ä½ç½®ä¸º<strong>æ²™ç›’è·¯å¾„ä¸‹çš„ Application Support</strong></li></ul><blockquote><p>ç›®å‰ï¼ˆXcode 15 beta 5ï¼‰è²Œä¼¼è¿˜æœ‰äº›é—®é¢˜ï¼Œè®¾ç½®é¢‘ç‡é™åˆ¶ä½†ä»ç„¶æ˜¾ç¤ºå¤šä¸ª Tipsã€‚</p></blockquote><h2 id="è‡ªå®šä¹‰æ˜¾ç¤ºè§„åˆ™"><a href="#è‡ªå®šä¹‰æ˜¾ç¤ºè§„åˆ™" class="headerlink" title="è‡ªå®šä¹‰æ˜¾ç¤ºè§„åˆ™"></a>è‡ªå®šä¹‰æ˜¾ç¤ºè§„åˆ™</h2><p>åœ¨ç”¨æˆ·å¯èƒ½éœ€è¦è¯¥åŠŸèƒ½æ—¶æ˜¾ç¤ºæç¤ºä¼šæå¤§ç¨‹åº¦çš„å¸®åŠ©ç”¨æˆ·æ›´å¥½çš„ä¸Šæ‰‹ä¸€æ¬¾ Appï¼Œå› æ­¤ï¼Œæˆ‘ä»¬å¯èƒ½ä¼šåˆ¶å®šå¾ˆå¤šTipsï¼Œä½†æ˜¯ä¸éœ€è¦ä¸€æ¬¡æ€§å…¨éƒ½æ˜¾ç¤ºå‡ºæ¥ï¼Œæœ‰äº¤äº’æ€§çš„æ˜¾ç¤ºæç¤ºæ˜¯æœ‰å¿…è¦çš„ã€‚</p><p>ä¾‹å¦‚ï¼š</p><ol><li>TODO App ä¸­æç¤ºç”¨æˆ·â€œå¦‚ä½•æ ‡è®°æŸä¸€é¡¹ä»»åŠ¡å·²å®Œæˆâ€å°±åº”è¯¥åœ¨ç”¨æˆ·åˆ›å»ºç¬¬ä¸€ä¸ªä»»åŠ¡æ—¶æ˜¾ç¤ºã€‚</li><li>TODO App ä¸­æç¤ºç”¨æˆ·â€œå¦‚ä½•åˆ é™¤å·²å®Œæˆçš„ TODO Item è®°å½•â€åº”è¯¥åœ¨ç”¨æˆ·æ ‡è®°å®Œæˆäº†ä¸€äº›ä»»åŠ¡åæ˜¾ç¤ºã€‚</li></ol><h3 id="Parameter"><a href="#Parameter" class="headerlink" title="Parameter"></a>Parameter</h3><p>æŒä¹…åŒ–å‚æ•°ã€‚</p><p>æˆ‘ç²—ç•¥åœ°å°†å…¶ç†è§£ä¸º <code>AppStorage</code>ï¼Œè®¾å®šçš„å‚æ•°ä¼šè¢«æŒä¹…åŒ–åœ°å­˜å‚¨åœ¨é…ç½®ä¸­å®šä¹‰çš„ä½ç½®ä¸‹ã€‚</p><p>å‚æ•°çš„å­˜åœ¨ï¼Œä¸ºè‡ªå®šä¹‰æ˜¾ç¤ºçš„é€»è¾‘èµ·åˆ°äº†å¾ˆå¤§çš„å¸®åŠ©ã€‚</p><p>æ­¤æ—¶ï¼Œæˆ‘ä»¬å¯ä»¥å®šä¹‰ä¸€ä¸ªå‚æ•°æ¥æŸ¥çœ‹ TODO List ä¸­æ˜¯å¦åŒ…å«ä¸€ä¸ªä»»åŠ¡ï¼š</p><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">struct</span> <span class="title class_">Tasks</span> &#123;</span><br><span class="line">    <span class="meta">@Parameter</span></span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">var</span> hasTasks: <span class="type">Bool</span> <span class="operator">=</span> <span class="literal">false</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>Xcode 15 beta 5 æç¤º Macro é”™è¯¯ï¼Œä¸å®˜æ–¹æç¤ºçš„å·²çŸ¥é—®é¢˜ä¸€è‡´ã€‚</p><h3 id="Event"><a href="#Event" class="headerlink" title="Event"></a>Event</h3><p>å¯èƒ½ä¼šå‘ç”Ÿä¸€æ¬¡æˆ–å¤šæ¬¡çš„äº‹ä»¶ï¼Œå¯ä»¥ç®€å•ç†è§£ä¸ºã€Œè¿›é˜¶ç‰ˆçš„ Parameterã€</p><p>å®šä¹‰ Event:</p><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">struct</span> <span class="title class_">TodoApp</span>: <span class="title class_">App</span> &#123;</span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">let</span> taskDidComplete <span class="operator">=</span> <span class="type">Tips</span>.<span class="type">Event</span>(id: <span class="string">&quot;taskDidComplete&quot;</span>)</span><br><span class="line">    <span class="keyword">var</span> body: <span class="keyword">some</span> <span class="type">Scene</span> &#123;</span><br><span class="line">        <span class="operator">â€¦</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ç”¨æˆ·å®Œæˆæ—¶è§¦å‘äº‹ä»¶ï¼š</p><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">Button</span>(â€œ<span class="type">Complete</span>â€) &#123;</span><br><span class="line">    <span class="type">TodoApp</span>.taskDidComplete.donate()</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>åœ¨å®Œæˆ <code>donate()</code> ä¹‹åï¼Œä¼šæŒä¹…åŒ–è§¦å‘æ—¶é—´ï¼Œå¹¶è®©è®¡æ•°å™¨â•1ï¼Œåç»­å¯ä»¥æ ¹æ®äº‹ä»¶åœ¨æŸä¸€æ—¶é—´æ®µå†…çš„ donations æ¥åˆ¶å®šè§„åˆ™ã€‚</p><p>æ›´é«˜çº§çš„ç©æ³•æ˜¯ï¼Œå¯ä»¥ Codable &amp; Sendable çš„æ•°æ®å…³è”ç»™ Donationï¼Œåç»­ä¹Ÿå¯ä»¥åœ¨äº‹ä»¶ä¸­æ ¹æ®å…³è”ç±»å‹è¿›è¡Œæ›´åŠ ç²¾å‡†åœ°ç­›é€‰ã€‚</p><h3 id="Rule"><a href="#Rule" class="headerlink" title="Rule"></a>Rule</h3><p>è‡ªå®šä¹‰ Tip çš„æ˜¾ç¤ºè§„åˆ™ã€‚</p><ol><li>æ ¹æ®å‚æ•°ä¸­çš„ <code>hasTasks</code> æ¥å†³å®šæ˜¯å¦æ˜¾ç¤ºâ€œæ ‡è®°å®Œæˆâ€çš„æç¤ºã€‚</li></ol><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">struct</span> <span class="title class_">CompleteTaskTip</span>: <span class="title class_">Tip</span> &#123;</span><br><span class="line">    <span class="operator">â€¦</span></span><br><span class="line">    <span class="keyword">var</span> rules: [<span class="type">Rule</span>] &#123;</span><br><span class="line">        <span class="comment">// Tip will only display when `hasTasks` is true.</span></span><br><span class="line">        #<span class="type">Rule</span>(<span class="type">Tasks</span>.hasTasks) &#123;</span><br><span class="line">            <span class="variable">$0</span> <span class="operator">==</span> <span class="literal">true</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ol start="2"><li>æ ¹æ®äº‹ä»¶æ”¶é›†åˆ°çš„ donations å†³å®šæ˜¯å¦æ˜¾ç¤ºâ€œåˆ é™¤â€æç¤ºã€‚</li></ol><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">struct</span> <span class="title class_">DeleteTasksTip</span>: <span class="title class_">Tip</span> &#123;</span><br><span class="line">    <span class="operator">...</span></span><br><span class="line">    <span class="keyword">var</span> rules: [<span class="type">Rule</span>] &#123;</span><br><span class="line">        #<span class="type">Rule</span>(<span class="type">TodoApp</span>.taskDidComplete) &#123;</span><br><span class="line">            <span class="comment">// Displays delete tip if user completes more than 3 tasks within an hour.</span></span><br><span class="line">            <span class="variable">$0</span>.donations.donatedWithin(.hours(<span class="number">1</span>)).count <span class="operator">&gt;</span> <span class="number">3</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å½“ç„¶ï¼Œå¦‚æœæ­¤æ—¶è¾¾åˆ°äº†é…ç½®ä¸­é¢„è®¾çš„é¢‘ç‡é™åˆ¶ï¼Œä¹Ÿä¸ä¼šæ˜¾ç¤ºã€‚</p><h2 id="æ ·å¼"><a href="#æ ·å¼" class="headerlink" title="æ ·å¼"></a>æ ·å¼</h2><p>TipKit ä¸­åŒ…å«äº† <code>TipViewStyle</code> ä»¥å…è®¸å¼€å‘è€…è‡ªå·±å®šä¹‰æ ·å¼ï¼Œä½†æ˜¯å½“æˆ‘å®šä¹‰å¥½æ ·å¼å‡†å¤‡ä½¿ç”¨æ—¶ï¼Œå‘ç°å¹¶æ²¡æœ‰æä¾›ä¿®æ”¹æ ·å¼çš„ modifierï¼Œç±»ä¼¼ <code>.tipViewStyle(.customStyle)</code> è¿™æ ·çš„ ğŸ˜¡</p><p>ç›®å‰å†…ç½®æä¾›äº†ä¸€ç§ <code>MiniTipViewStyle</code>ï¼Œåº”è¯¥åç»­ä¼šæœ‰ <code>.tipViewStyle</code> å§â€¦</p><h2 id="æ‰‹åŠ¨è§¦å‘"><a href="#æ‰‹åŠ¨è§¦å‘" class="headerlink" title="æ‰‹åŠ¨è§¦å‘"></a>æ‰‹åŠ¨è§¦å‘</h2><h3 id="æ˜¾ç¤ºæç¤º"><a href="#æ˜¾ç¤ºæç¤º" class="headerlink" title="æ˜¾ç¤ºæç¤º"></a>æ˜¾ç¤ºæç¤º</h3><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">Tips</span>.showAllTips() <span class="comment">// Show All Tips</span></span><br><span class="line"></span><br><span class="line"><span class="type">Tips</span>.showTips([<span class="type">DeleteTasksTip</span>.<span class="keyword">self</span>, <span class="type">CompleteTaskTip</span>.<span class="keyword">self</span>]) <span class="comment">// Show Tips based on Type</span></span><br><span class="line"></span><br><span class="line"><span class="type">Tips</span>.showTips([<span class="type">DeleteTasksTip</span>().id]) <span class="comment">// Show Tips based on ID</span></span><br></pre></td></tr></table></figure><h3 id="éšè—æç¤º"><a href="#éšè—æç¤º" class="headerlink" title="éšè—æç¤º"></a>éšè—æç¤º</h3><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">Tips</span>.hideAllTips() <span class="comment">// Hide All Tips</span></span><br><span class="line"></span><br><span class="line"><span class="type">Tips</span>.hideTips([<span class="type">DeleteTasksTip</span>.<span class="keyword">self</span>, <span class="type">CompleteTaskTip</span>.<span class="keyword">self</span>]) <span class="comment">// Hide Tips based on Type</span></span><br><span class="line"></span><br><span class="line"><span class="type">Tips</span>.hideTips([<span class="type">DeleteTasksTip</span>().id]) <span class="comment">// Hide Tips based on ID</span></span><br></pre></td></tr></table></figure>]]></content>
    
    
    <summary type="html">&lt;p&gt;ä»Šå¹´ WWDC æ–°å¢äº†ä¸å°‘çš„æ¡†æ¶ï¼Œè¿™ç¯‡åšå®¢ä¸“æ³¨äºç ”ç©¶ TipKit&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;&lt;strong&gt;Important&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;In macOS 14 Beta 4, TipKit projects donâ€™t build in Simulator or for macOS due to macro â€œcould not be foundâ€ errors. A workaround for this issue is available in &lt;a href=&quot;https://developer.apple.com/documentation/xcode-release-notes/xcode-15-release-notes#TipKit&quot;&gt;Xcode release notes&lt;/a&gt;.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;&lt;img src=&quot;/img/meet-tipkit/tipviews.png&quot;&gt;&lt;/p&gt;</summary>
    
    
    
    <category term="æ’¸ä»£ç " scheme="https://liyanan2004.github.io/categories/%E6%92%B8%E4%BB%A3%E7%A0%81/"/>
    
    
    <category term="SwiftUI" scheme="https://liyanan2004.github.io/tags/SwiftUI/"/>
    
    <category term="WWDC 23" scheme="https://liyanan2004.github.io/tags/WWDC-23/"/>
    
    <category term="TipKit" scheme="https://liyanan2004.github.io/tags/TipKit/"/>
    
  </entry>
  
  <entry>
    <title>ç”¨ SwiftUI åšä¸ªç»ˆç«¯</title>
    <link href="https://liyanan2004.github.io/terminal-window-swiftui/"/>
    <id>https://liyanan2004.github.io/terminal-window-swiftui/</id>
    <published>2023-07-23T03:13:03.829Z</published>
    <updated>2023-07-25T04:51:47.425Z</updated>
    
    <content type="html"><![CDATA[<p>æœ€è¿‘ç”¨ SwiftUI åšäº†ä¸€ä¸ª Terminal ç»ˆç«¯ï¼ŒæŒºæœ‰æ„æ€çš„ï¼Œåˆ†äº«ä¸‹å®ç°æ€è·¯ã€‚</p><p>æ•ˆæœå¤§æ¦‚æ˜¯è¿™æ ·ï¼š</p><p><img src="/img/terminal-window-swiftui/preview.gif"></p><span id="more"></span><h2 id="è®¾è®¡è§„èŒƒ"><a href="#è®¾è®¡è§„èŒƒ" class="headerlink" title="è®¾è®¡è§„èŒƒ"></a>è®¾è®¡è§„èŒƒ</h2><p>è¿™é‡Œå¯ä»¥å‚è€ƒ Developer ç½‘ç«™ä¸Šçš„ Figma èµ„æºæ¥æŸ¥çœ‹å…·ä½“æ¯ä¸ªå…ƒç´ çš„å®½é«˜å’Œé—´è·ç­‰ä¿¡æ¯ã€‚</p><p>è¿™æ ·å¯ä»¥å°½æœ€å¤§å¯èƒ½çš„è¿˜åŸ macOS çš„é£æ ¼ã€‚</p><p><img src="/img/terminal-window-swiftui/traffic-light.png" alt="çº¢ç»¿ç¯æ¯ä¸€ä¸ªç›´å¾„12"></p><p><img src="/img/terminal-window-swiftui/horizontal-gap.png" alt="æ¨ªå‘é—´è·8"></p><p><img src="/img/terminal-window-swiftui/title-bar-font.png" alt="çª—å£æ ‡é¢˜ SF Pro 13å·å­— Semibold(macOS) bold(iOS)"></p><p><img src="/img/terminal-window-swiftui/macos-font-styles.png" alt="å¯¹åº” macOS ä¸‹ body å­—ä½“ï¼ŒiOSä¸‹ footnote å­—ä½“"></p><h2 id="ä»£ç å®ç°"><a href="#ä»£ç å®ç°" class="headerlink" title="ä»£ç å®ç°"></a>ä»£ç å®ç°</h2><p>æ€è·¯æ˜¯ï¼šæ„å»ºæ ‡é¢˜æ  -&gt; æ–‡æœ¬æ··æ’+å®ç°å…‰æ ‡é—ªåŠ¨ -&gt; æ¥æ”¶è¾“å…¥</p><h3 id="æ„å»ºæ ‡é¢˜æ "><a href="#æ„å»ºæ ‡é¢˜æ " class="headerlink" title="æ„å»ºæ ‡é¢˜æ "></a>æ„å»ºæ ‡é¢˜æ </h3><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> SwiftUI</span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">TrafficLights</span>: <span class="title class_">View</span> &#123;</span><br><span class="line">    <span class="keyword">var</span> body: <span class="keyword">some</span> <span class="type">View</span> &#123;</span><br><span class="line">        <span class="type">HStack</span>(spacing: <span class="number">8</span>) &#123;</span><br><span class="line">            <span class="keyword">let</span> colors: [<span class="type">Color</span>] <span class="operator">=</span> [.red, .yellow, .green]</span><br><span class="line">            <span class="type">ForEach</span>(colors, id: \.<span class="keyword">self</span>) &#123;</span><br><span class="line">                <span class="type">Circle</span>()</span><br><span class="line">                    .foregroundStyle(<span class="variable">$0</span>)</span><br><span class="line">                    .frame(width: <span class="number">12</span>)</span><br><span class="line">                    .overlay &#123;</span><br><span class="line">                        <span class="type">Circle</span>()</span><br><span class="line">                            .stroke(<span class="type">Color</span>.black.opacity(<span class="number">0.2</span>), lineWidth: <span class="number">0.5</span>)</span><br><span class="line">                    &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Environment</span>(\.colorScheme) <span class="keyword">private</span> <span class="keyword">var</span> colorScheme</span><br></pre></td></tr></table></figure><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">TrafficLights</span>()</span><br><span class="line">    .frame(maxWidth: .infinity, alignment: .leading)</span><br><span class="line">    .overlay &#123;</span><br><span class="line">        <span class="type">Text</span>(<span class="string">&quot;username â€” -zsh â€” 100x30&quot;</span>)</span><br><span class="line">            .font(.footnote.weight(.bold))</span><br><span class="line">    &#125;</span><br><span class="line">    .padding(<span class="number">8</span>)</span><br><span class="line">    .background(.bar)</span><br><span class="line">    .overlay &#123;</span><br><span class="line">        <span class="type">GeometryReader</span> &#123; proxy <span class="keyword">in</span></span><br><span class="line">            <span class="type">UnevenRoundedRectangle</span>(topLeadingRadius: <span class="number">8</span>, topTrailingRadius: <span class="number">8</span>)</span><br><span class="line">                .stroke(.foreground.opacity(colorScheme <span class="operator">==</span> .dark <span class="operator">?</span> <span class="number">0.15</span> : <span class="number">0.3</span>), lineWidth: <span class="number">0.33</span>)</span><br><span class="line">                .frame(height: proxy.size.height <span class="operator">+</span> <span class="number">1</span>)</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    .clipped()</span><br></pre></td></tr></table></figure><blockquote><p>è¿™é‡Œè®©<strong>é«˜åº¦+1ç„¶åclipped</strong>çš„åŸå› æ˜¯ï¼šç­‰ä¼šå„¿æˆ‘ä»¬çš„å†…å®¹åŒºåŸŸä¹Ÿè¦è¿™ä¹ˆåŠ ä¸€ä¸ªæè¾¹ï¼Œä¸ºäº†é˜²æ­¢ä¸¤ä¸ªæè¾¹é‡å å¯¼è‡´é¢œè‰²åŠ æ·±ï¼Œæˆ‘ä»¬å¿½ç•¥ titlebar çš„åº•éƒ¨æè¾¹ï¼Œä¿ç•™å†…å®¹åŒºåŸŸçš„é¡¶éƒ¨æè¾¹ã€‚</p></blockquote><hr><h3 id="2023-7-25-æ›´æ–°"><a href="#2023-7-25-æ›´æ–°" class="headerlink" title="2023.7.25 æ›´æ–°"></a><strong>2023.7.25 æ›´æ–°</strong></h3><p>è¿™é‡Œçš„å®ç°å­˜åœ¨é—®é¢˜ï¼Œå½“çª—å£æ ‡é¢˜æ–‡æœ¬è¿‡é•¿æ—¶ä¼šå’ŒğŸš¥é‡å ã€‚</p><p>ä»”ç»†è§‚å¯ŸmacOSåŸç”Ÿçš„å®ç°ï¼Œå¯ä»¥å‘ç°å…¶è¡¨ç°ä¸ºï¼š</p><ul><li>ç©ºé—´å……è¶³æ—¶ï¼šå±…ä¸­æ˜¾ç¤ºæ ‡é¢˜</li><li>ç©ºé—´ä¸è¶³æ—¶ï¼šä¼˜å…ˆé å³æ˜¾ç¤º</li><li>ç©ºé—´è¿‡å°æ—¶ï¼šè£åˆ‡æ–‡æœ¬æ˜¾ç¤ºçœç•¥å·ï¼Œä»ä¿æŒå³ä¾§8ä¸ªåƒç´ çš„é—´è·</li></ul><p>æˆ‘è®¤ä¸ºè¿™é‡Œçš„éš¾ç‚¹åœ¨äºï¼šè¦åŠ¨æ€çš„ä¿®æ”¹æ ‡é¢˜çš„å¯¹é½æ–¹å¼ã€‚</p><p>æˆ‘çš„å®ç°å¦‚ä¸‹ï¼š</p><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">struct</span> <span class="title class_">WindowTitleBar</span>&lt;<span class="title class_">Title</span>: <span class="title class_">View</span>&gt;: <span class="title class_">View</span> &#123;</span><br><span class="line">    <span class="meta">@ViewBuilder</span> <span class="keyword">var</span> title: () -&gt; <span class="type">Title</span></span><br><span class="line">    </span><br><span class="line">    <span class="meta">@Environment</span>(\.colorScheme) <span class="keyword">private</span> <span class="keyword">var</span> colorScheme</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">var</span> body: <span class="keyword">some</span> <span class="type">View</span> &#123;</span><br><span class="line">        <span class="type">HStack</span>(spacing: <span class="number">0</span>) &#123;</span><br><span class="line">            <span class="type">TrafficLights</span>().padding(<span class="number">8</span>)</span><br><span class="line">            <span class="type">Spacer</span>(minLength: <span class="number">0</span>)</span><br><span class="line">            title()</span><br><span class="line">                .font(.footnote.bold())</span><br><span class="line">                .layoutPriority(<span class="number">1</span>)</span><br><span class="line">            <span class="type">Spacer</span>(minLength: <span class="number">0</span>)</span><br><span class="line">            <span class="type">Color</span>.clear <span class="comment">// 52 = 12(red) + 8(spacing) + 12(green) + 8 + 12(yellow)</span></span><br><span class="line">                .frame(minWidth: <span class="number">8</span>, maxWidth: <span class="number">52</span> <span class="operator">+</span> <span class="number">8</span> <span class="operator">*</span> <span class="number">2</span>)</span><br><span class="line">        &#125;</span><br><span class="line">        .frame(maxWidth: .infinity)</span><br><span class="line">        .frame(height: <span class="number">28</span>)</span><br><span class="line">        .lineLimit(<span class="number">1</span>)</span><br><span class="line">        .font(.footnote.bold())</span><br><span class="line">        .background(.bar)</span><br><span class="line">        .overlay &#123;</span><br><span class="line">            <span class="type">GeometryReader</span> &#123; proxy <span class="keyword">in</span></span><br><span class="line">                <span class="type">UnevenRoundedRectangle</span>(topLeadingRadius: <span class="number">8</span>, topTrailingRadius: <span class="number">8</span>)</span><br><span class="line">                    .stroke(.foreground.opacity(colorScheme <span class="operator">==</span> .dark <span class="operator">?</span> <span class="number">0.15</span> : <span class="number">0.3</span>), lineWidth: <span class="number">0.33</span>)</span><br><span class="line">                    .frame(height: proxy.size.height <span class="operator">+</span> <span class="number">1</span>)</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        .clipped()</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è§£é‡Šä¸‹åŸç†ï¼ˆä»å·¦åˆ°å³ï¼‰ï¼š</p><ol><li><code>TrafficLights().padding(8)</code> ç•¥ã€‚</li><li><code>Spacer(minLength: 0)</code> ä¸¤ä¸ªæˆå¯¹ç”¨äºå±…ä¸­æ ‡é¢˜æ–‡æœ¬ã€‚</li><li><code>.layoutPriority(1)</code> è®©æ ‡é¢˜å¸ƒå±€ä¼˜å…ˆçº§æ›´é«˜ï¼Œåœ¨ç©ºé—´ä¸è¶³æ—¶æŠŠä¼˜å…ˆå¸ƒå±€æ ‡é¢˜ã€‚</li><li><code>Color.clear</code> å³ä¾§è¾¹è·ï¼Œä¸ <code>TrafficLights()</code> ä¿æŒä¸€è‡´å®½åº¦ï¼Œç¡®ä¿åœ¨ç©ºé—´å……è¶³æ—¶ç›¸å¯¹äºæ•´ä¸ªæ ‡é¢˜æ ï¼ˆåŒ…æ‹¬å·¦ä¾§ğŸš¥ï¼‰å±…ä¸­ï¼Œè‹¥ç©ºé—´ä¸è¶³ï¼Œä¹Ÿè¦å§‹ç»ˆä¿æŒå®½åº¦ä¸º8ï¼Œç•™å‡ºä¸å·¦ä¾§ç›¸åŒçš„é—´è·ã€‚</li></ol><h3 id="æ–‡æœ¬æ··æ’-å®ç°å…‰æ ‡é—ªåŠ¨"><a href="#æ–‡æœ¬æ··æ’-å®ç°å…‰æ ‡é—ªåŠ¨" class="headerlink" title="æ–‡æœ¬æ··æ’+å®ç°å…‰æ ‡é—ªåŠ¨"></a>æ–‡æœ¬æ··æ’+å®ç°å…‰æ ‡é—ªåŠ¨</h3><p>æ–‡æœ¬æ··æ’æ¯”è¾ƒç®€å•ï¼Œä½¿ç”¨å¤šä¸ª <code>Text</code> ä¸²è”å³å¯ï¼Œåœ¨ç»“å°¾åŠ ä¸Šå…‰æ ‡(â–‰) ã€‚</p><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">Group</span> &#123;</span><br><span class="line">    <span class="type">Text</span>(<span class="string">&quot;Login at: <span class="subst">\(Date.now.formatted())</span>.<span class="subst">\n</span>&quot;</span>)</span><br><span class="line">    <span class="operator">+</span></span><br><span class="line">    <span class="type">Text</span>(<span class="string">&quot;â–‰&quot;</span>)</span><br><span class="line">&#125;</span><br><span class="line">.monospaced() <span class="comment">// Match terminal feel.</span></span><br><span class="line">.padding(<span class="number">4</span>)</span><br><span class="line">.frame(maxWidth: .infinity, maxHeight: .infinity, alignment: .topLeading)</span><br><span class="line">.overlay &#123; </span><br><span class="line">    <span class="type">UnevenRoundedRectangle</span>(bottomLeadingRadius: <span class="number">8</span>, bottomTrailingRadius: <span class="number">8</span>)</span><br><span class="line">        .stroke(.foreground.opacity(colorScheme <span class="operator">==</span> .dark <span class="operator">?</span> <span class="number">0.15</span> : <span class="number">0.3</span>), lineWidth: <span class="number">0.33</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¿™é‡Œå°±æ˜¯æˆ‘ä»¬çš„å†…å®¹åŒºåŸŸï¼ŒåŒæ ·éœ€è¦åŠ ä¸Šæè¾¹ï¼Œæˆ‘ä»¬ä½¿ç”¨ SwiftUI 5 æ–°å¢çš„ <code>UnevenRoundedRectangle</code> æ¥æ§åˆ¶å››å‘¨åœ†è§’</p><p>å…‰æ ‡é—ªåŠ¨å°±æ˜¯è®©å…‰æ ‡ä»¥å›ºå®šçš„æ—¶é—´é—´éš”æ”¹å˜æ ·å¼ï¼Œåœ¨æ–‡æœ¬æ··æ’ä¸­ï¼Œå¯ä»¥ä½¿ç”¨ <code>.foregroundColor</code>(iOS 17ä¹‹å‰ï¼‰ &#x2F; <code>.foregroundStyle</code>ï¼ˆiOS 17+ï¼‰ æ¥å¯¹æ–‡æœ¬é¢œè‰²ã€æ ·å¼è¿›è¡Œè°ƒæ•´ã€‚</p><p>å‚è€ƒ HIGï¼Œå¯ä»¥è¿™ä¹ˆä¿®æ”¹ï¼š</p><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">enum</span> <span class="title class_">CursorStyle</span> &#123;</span><br><span class="line">    <span class="keyword">case</span> transparent, opaque</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">mutating</span> <span class="keyword">func</span> <span class="title function_">toggle</span>() &#123;</span><br><span class="line">        <span class="keyword">switch</span> <span class="keyword">self</span> &#123;</span><br><span class="line">        <span class="keyword">case</span> .opaque: <span class="keyword">self</span> <span class="operator">=</span> .transparent</span><br><span class="line">        <span class="keyword">case</span> .transparent: <span class="keyword">self</span> <span class="operator">=</span> .opaque</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@State</span> <span class="keyword">private</span> <span class="keyword">var</span> cursorStyle <span class="operator">=</span> <span class="type">CursorStyle</span>.opaque</span><br></pre></td></tr></table></figure><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">Group</span> &#123;</span><br><span class="line">    <span class="operator">...</span></span><br><span class="line">    <span class="type">Text</span>(<span class="string">&quot;â–‰&quot;</span>).foregroundStyle(cursorStyle <span class="operator">==</span> .transparent <span class="operator">?</span> .clear : <span class="type">Color</span>(white: <span class="number">0.45</span>))</span><br><span class="line">&#125;</span><br><span class="line">.task(priority: .background) &#123; changeCursorStyle() &#125;</span><br></pre></td></tr></table></figure><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">private</span> <span class="keyword">func</span> <span class="title function_">changeCursorStyle</span>() &#123;</span><br><span class="line">    <span class="type">Task</span> &#123;</span><br><span class="line">        <span class="keyword">try?</span> <span class="keyword">await</span> <span class="type">Task</span>.sleep(for: .seconds(<span class="number">0.5</span>))</span><br><span class="line">        cursorStyle.toggle()</span><br><span class="line">        changeCursorStyle()</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="æ¥æ”¶è¾“å…¥"><a href="#æ¥æ”¶è¾“å…¥" class="headerlink" title="æ¥æ”¶è¾“å…¥"></a>æ¥æ”¶è¾“å…¥</h3><p>è¿™é‡Œä½¿ç”¨ <code>TextEditor</code>ï¼Œä½†æ˜¯ä¸èƒ½ç›´æ¥è®©å®ƒæ˜¾ç¤ºå‡ºæ¥è¦†ç›–é¡µé¢ï¼Œä¸” Editor å†…çš„æ–‡æœ¬ä¹Ÿä¸è¦æ˜¾ç¤ºï¼Œä¸”è¦ä¿ç•™ç‚¹å‡»è·å¾—ç„¦ç‚¹çš„èƒ½åŠ›ã€‚</p><p>æœ€ç®€å•çš„æ–¹å¼å°±æ˜¯ <code>.opacity(0.001)</code>ï¼Œæå®šã€‚</p><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@State</span> <span class="keyword">private</span> <span class="keyword">var</span> userInput <span class="operator">=</span> <span class="string">&quot;&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="type">Group</span> &#123;</span><br><span class="line">    <span class="operator">...</span></span><br><span class="line">    <span class="type">Text</span>(userInput)</span><br><span class="line">    <span class="operator">...</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="operator">...</span></span><br><span class="line">.overlay &#123;</span><br><span class="line">    <span class="type">TextEditor</span>(text: <span class="variable">$userInput</span>).opacity(<span class="number">0.001</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¿˜æœ‰ä¸€ç‚¹è¦æ³¨æ„çš„æ˜¯ï¼Œæˆ‘ä»¬è¦ï¼š</p><ul><li>ç¦ç”¨ç³»ç»Ÿçš„è‡ªåŠ¨æ”¹æ­£ï¼ˆauto-correction)ï¼š<code>.autocorrectionDisabled()</code></li><li>ç¦ç”¨è‡ªåŠ¨é¦–å­—æ¯å¤§å†™ï¼ˆauto-capitalizationï¼‰ï¼š<code>.textInputAutocapitalization(.never)</code></li><li>ç¦ç”¨æ–‡æœ¬é¢„æµ‹ï¼ˆtext-predictionï¼‰ï¼š<code>.keyboardType(.asciiCapable)</code></li></ul><p>å¤§åŠŸå‘Šæˆï¼Œæ¥ä¸‹æ¥ï¼Œä½ åªéœ€è¦æ ¹æ®è‡ªå·±éœ€æ±‚æ¥å¤„ç†å‘½ä»¤å³å¯ï¼Œæˆ‘è¿™é‡Œçš„æ–¹å¼æ˜¯åœ¨æ–‡æœ¬å˜åŒ–æ—¶ <code>.onChange(of: userInput)</code> æ£€æµ‹æœ€åä¸€ä¸ªå­—ç¬¦æ˜¯å¦ä¸ºæ¢è¡Œæ¥å†³å®šæ˜¯å¦æ‰§è¡Œï¼Œå¯¹äºä¸åŒçš„å‘½ä»¤å¦‚ä½•æ‰§è¡Œè¿™éƒ¨åˆ†å¤§å®¶å¯ä»¥è‡ªå·±å‘æŒ¥æƒ³è±¡ã€‚</p><h2 id="å­˜åœ¨çš„é—®é¢˜"><a href="#å­˜åœ¨çš„é—®é¢˜" class="headerlink" title="å­˜åœ¨çš„é—®é¢˜"></a>å­˜åœ¨çš„é—®é¢˜</h2><p>ç”±äº <code>TextEditor</code> éšè—äº†ï¼Œç”¨æˆ·æ— æ³•ç›´æ¥çœ‹åˆ°å…‰æ ‡åœ¨å“ªé‡Œï¼Œè¿™é‡Œçš„å…‰æ ‡æ°¸è¿œåœ¨æœ€åï¼Œæ— æ³•æ ¹æ® <code>TextEditor</code> ä¸­çš„å…‰æ ‡ä½ç½®ç§»åŠ¨ï¼Œä½¿ç”¨å¤–ç½®é”®ç›˜å¯ä»¥ä¿®æ”¹å…‰æ ‡ä½ç½®ï¼Œè¿™æ—¶å€™ä¼šæ¯”è¾ƒannoyingğŸ˜¡</p><p>å¯ä»¥è€ƒè™‘ä½¿ç”¨ <a href="/swiftui-selection-range/" title="Selection Range in SwiftUI">Selection Range in SwiftUI</a> æ¥è§£å†³ï¼Œä½†æ˜¯ç”±äºæ˜¯ Hack æ–¹æ³•ï¼Œå¯èƒ½ä¼šå¯¼è‡´å…¶ä»–çš„é—®é¢˜ã€‚</p><blockquote><p>åæ§½ä¸‹ SwiftUI åˆ°ç°åœ¨éƒ½æ²¡æ”¯æŒæ–‡æœ¬é€‰æ‹©çš„èŒƒå›´ã€‚</p><p>ä¹Ÿä¸çŸ¥é“ SwiftUI 5 çš„ <code>TextEditorStyle</code> ä¼šä¸ä¼šç»™æˆ‘ä»¬å¸¦æ¥ä»€ä¹ˆæƒŠå–œï¼Ÿ</p><p>å‘è¿‡åé¦ˆï¼šFB12340578ï¼Œåç­‰ã€‚</p></blockquote>]]></content>
    
    
    <summary type="html">&lt;p&gt;æœ€è¿‘ç”¨ SwiftUI åšäº†ä¸€ä¸ª Terminal ç»ˆç«¯ï¼ŒæŒºæœ‰æ„æ€çš„ï¼Œåˆ†äº«ä¸‹å®ç°æ€è·¯ã€‚&lt;/p&gt;
&lt;p&gt;æ•ˆæœå¤§æ¦‚æ˜¯è¿™æ ·ï¼š&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;/img/terminal-window-swiftui/preview.gif&quot;&gt;&lt;/p&gt;</summary>
    
    
    
    <category term="æ’¸ä»£ç " scheme="https://liyanan2004.github.io/categories/%E6%92%B8%E4%BB%A3%E7%A0%81/"/>
    
    
    <category term="SwiftUI" scheme="https://liyanan2004.github.io/tags/SwiftUI/"/>
    
    <category term="WWDC 23" scheme="https://liyanan2004.github.io/tags/WWDC-23/"/>
    
  </entry>
  
  <entry>
    <title>åœ¨ SwiftUI ä¸­å®ç°é¡µé¢çš„æ–¹å‘é”å®š</title>
    <link href="https://liyanan2004.github.io/lock-orientation-in-swiftui/"/>
    <id>https://liyanan2004.github.io/lock-orientation-in-swiftui/</id>
    <published>2023-06-19T03:59:09.888Z</published>
    <updated>2023-06-19T13:21:03.046Z</updated>
    
    <content type="html"><![CDATA[<p>åœ¨è®¸å¤šæƒ…å†µä¸‹ï¼Œæˆ‘ä»¬å¸Œæœ›æŸä¸€ä¸ªè§†å›¾èƒ½å¤Ÿé”å®šåœ¨ä¸€ä¸ªç‰¹å®šçš„æ–¹å‘ä¸‹ï¼Œä¾‹å¦‚ï¼šç›¸æœºé¡µé¢ç­‰</p><p>æœ¬æ–‡å°†åˆ†äº«ä¸€ç§æˆ‘è‡ªå·±æ£è…¾å‡ºæ¥çš„ä¸€ç§å®ç°æ–¹å¼ä»¥åŠèƒŒåçš„é€»è¾‘ã€‚</p><p><strong>æœ¬æ–‡ä»…é€‚ç”¨äº iOS</strong></p><span id="more"></span><h2 id="å®ç°é€»è¾‘"><a href="#å®ç°é€»è¾‘" class="headerlink" title="å®ç°é€»è¾‘"></a>å®ç°é€»è¾‘</h2><p>æ€è·¯æ˜¯ä½¿ç”¨ <code>@UIApplicationDelegateAdaptor(AppDelegate.self)</code> é…åˆ AppDelegate ä¸­çš„ <code>func application(_ application: UIApplication, supportedInterfaceOrientationsFor window: UIWindow?) -&gt; UIInterfaceOrientationMask</code> æ¥å®ç°æ–¹å‘çš„é”å®šã€‚</p><p>åœ¨éœ€è¦é”å®šæ–¹å‘çš„ View ä¸­ï¼Œä¿®æ”¹ AppDelegate ä¸­çš„ <code>orientationLock</code> å¹¶é‡æ–°è¿”å›ä¸€ä¸ªå…¨å±€çš„ <code>UIInterfaceOrientationMask</code>ã€‚</p><p>é€€å‡ºé”å®šçš„ View ä¹‹åï¼Œåªéœ€è¦è¿˜åŸ <code>orientationLock</code> å¹¶é‡æ–°è¿”å› <code>UIInterfaceOrientationMask</code> å³å¯ã€‚</p><h2 id="è¸©è¿‡çš„å‘"><a href="#è¸©è¿‡çš„å‘" class="headerlink" title="è¸©è¿‡çš„å‘"></a>è¸©è¿‡çš„å‘</h2><ul><li><p><code>@UIApplicationDelegateAdaptor</code> éœ€è¦åˆ›å»ºåœ¨ç¨‹åºå…¥å£å¤„ï¼Œå³ <code>@main</code> å¯¹åº”çš„ App Protocol ä¸‹ï¼Œ<strong>å¦åˆ™ï¼ŒAppDelegate ä¸èµ·ä½œç”¨</strong>ã€‚</p><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> SwiftUI</span><br><span class="line"></span><br><span class="line"><span class="keyword">@main</span></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">TestApp</span>: <span class="title class_">App</span> &#123;</span><br><span class="line">    <span class="meta">@UIApplicationDelegateAdaptor</span>(<span class="type">AppDelegate</span>.<span class="keyword">self</span>) <span class="keyword">var</span> appDelegate</span><br><span class="line"></span><br><span class="line">    <span class="keyword">var</span> body: <span class="keyword">some</span> <span class="type">Scene</span> &#123;</span><br><span class="line">        <span class="type">WindowGroup</span> &#123;</span><br><span class="line">            <span class="type">ContentView</span>()</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure></li><li><p>åœ¨ iOS 15 åŠä»¥ä¸‹å’Œ iOS 16+ çš„æ—‹è½¬ç­–ç•¥æ˜¯ä¸åŒçš„ï¼Œå³ç³»ç»Ÿè°ƒç”¨ <code>func application(_ application: UIApplication, supportedInterfaceOrientationsFor window: UIWindow?) -&gt; UIInterfaceOrientationMask</code> çš„æ—¶æœºå’Œéœ€è¦åšçš„äº‹æƒ…æ˜¯ä¸åŒçš„ã€‚</p><ul><li><p>iOS 15 åŠä»¥ä¸‹ï¼šåœ¨æ¯æ¬¡è½¬åŠ¨å±å¹•çš„æ—¶å€™éƒ½ä¼šè°ƒç”¨è¯¥æ–¹æ³•é‡æ–°è¯„ä¼°ä»¥å†³å®šæ˜¯å¦å®Œæˆ UI æ—‹è½¬ï¼Œå¦‚æœå½“å‰çš„è®¾å¤‡æ–¹å‘ä¸åœ¨ UIInterfaceOrientationMask ä¸­ï¼Œä¹Ÿä¸ä¼šè‡ªåŠ¨å°†å±å¹•æ—‹è½¬è‡³æ­£ç¡®çš„æ–¹å‘ã€‚</p><p>å› æ­¤ï¼Œé™¤äº†è¦è®¾å®šå¥½ <code>supportedInterfaceOrientations</code> ä¹‹å¤–ï¼Œè¿˜éœ€è¦åˆ¤æ–­ä¸‹å½“å‰çš„å±å¹•æ–¹å‘ï¼Œæ ¹æ®å…·ä½“æƒ…å†µæ—‹è½¬åˆ°æ­£ç¡®çš„æ–¹å‘ä¸Šã€‚</p></li><li><p>iOS 16+ï¼šåœ¨å±å¹•æ—‹è½¬çš„æ—¶å€™å¹¶ä¸ä¼šå†è°ƒç”¨ <code>func application(_ application: UIApplication, supportedInterfaceOrientationsFor window: UIWindow?) -&gt; UIInterfaceOrientationMask</code> äº†ï¼Œå› æ­¤ï¼Œæ—‹è½¬è®¾å¤‡æ—¶ç³»ç»Ÿä¸ä¼šä¸€ç›´åˆ·æ–° <code>UIInterfaceOrientationMask</code> ã€‚</p><p>åœ¨ <a href="https://juejin.cn/post/7146134397375217695">iOS 16 å±å¹•æ—‹è½¬é€‚é…</a> æ‰¾åˆ°äº†è§£å†³æ–¹æ¡ˆï¼šé€šè¿‡åœ¨ rootViewController ä¸­è°ƒç”¨ <code>setNeedsUpdateOfSupportedInterfaceOrientations()</code> å³å¯é‡æ–°è°ƒç”¨è¯¥æ–¹æ³•æ›´æ–° <code>UIInterfaceOrientationMask</code>ã€‚</p><p>å®æµ‹å‘ç°ï¼Œè‹¥å½“å‰çš„è®¾å¤‡æ–¹å‘ä¸åœ¨ <code>UIInterfaceOrientationMask</code> ä¸­ï¼Œä¼šè‡ªåŠ¨è°ƒæ•´ã€‚</p></li><li><p>å¯¹äº iOS 15 åŠä»¥ä¸‹è¿˜æœ‰ä¸€ä¸ª bugï¼Œå¦‚æœè®¾å¤‡æ–¹å‘æ²¡æœ‰å‘ç”Ÿæ”¹å˜è€Œæ–¹å‘é”å‘ç”Ÿäº†æ”¹å˜ï¼ˆä¾‹å¦‚ï¼šè®¾å¤‡æ˜¯ .portraitï¼Œæ–¹å‘é”ä» .landscapeLeft å˜åˆ° .portrait æ—¶ï¼‰ï¼Œåˆ™æ­¤æ—¶æ— æ³•è‡ªåŠ¨æ—‹è½¬åˆ°æ­£ç¡®çš„æ–¹å‘ã€‚</p><p>åŸå› æ˜¯ï¼šè™½ç„¶ç¨‹åºåŒ–æ‰§è¡Œäº†æ–¹å‘æ›´æ–°ï¼Œä½†æ˜¯å…¶å‰åç»“æœä¸€è‡´ï¼ˆè®¾å¤‡æ–¹å‘å®é™…ä¸å‘ç”Ÿå˜åŒ–ï¼‰ï¼Œç³»ç»Ÿå°±ä¸ä¼šé‡æ–°è·å– <code>UIInterfaceOrientationMask</code> ï¼Œå³ä¿æŒäº†åŸæ¥çš„ Mask æ²¡æœ‰æ›´æ–°ã€‚</p><p>è§£å†³æ–¹æ¡ˆæ˜¯ï¼šåœ¨æœ€åä½¿ç”¨ <code>NotificationCenter.default.post(name: UIDevice.orientationDidChangeNotification, object: nil)</code> æ‰‹åŠ¨å‘é€å±å¹•æ—‹è½¬çš„é€šçŸ¥ï¼Œè®©ç³»ç»Ÿé‡æ–°è·å– <code>UIInterfaceOrientationMask</code>ã€‚</p></li></ul></li></ul><h2 id="API-å°è£…"><a href="#API-å°è£…" class="headerlink" title="API å°è£…"></a>API å°è£…</h2><p>å®Œæˆäº†å¯è¡Œæ€§éªŒè¯ä¹‹åå†³å®šåšæˆä¸€ä¸ªå¯ä»¥åœ¨ä»»ä½•è§†å›¾ä¸‹ä½¿ç”¨çš„ View Modifierï¼Œå…¶ä¸­éœ€è¦å®ç°ä»¥ä¸‹åŠŸèƒ½ï¼š</p><ol><li>å•ä¸ªé¡µé¢çš„æ–¹å‘é”</li><li>èƒ½å¤Ÿè®¾å®šé»˜è®¤æ–¹å‘é®ç½©ï¼Œç”¨äºæ¢å¤ &#x2F; è§£é”æŸä¸ªé¡µé¢è®¾å®šçš„æ–¹å‘é”</li><li>ç”±æ•°æ®é©±åŠ¨ï¼Œæ”¯æŒç¨‹åºåŒ–æ”¹å˜è¯¥é¡µé¢çš„æ–¹å‘</li></ol><p>å› ä¸ºè¦å®ç°æ•°æ®é©±åŠ¨ï¼Œå› æ­¤ä¸èƒ½åªæ˜¯ç®€å•çš„ä½¿ç”¨ <code>onAppear</code> å’Œ  <code>onDisappear</code>ï¼Œå½“æ•°æ®å˜åŠ¨çš„æ—¶å€™ä¹Ÿéœ€è¦å“åº”ã€‚</p><p>è¿™é‡Œæˆ‘é€‰æ‹©ä½¿ç”¨ <code>Preference</code> + <code>onPreferenceChange</code> æ¥å®ç°ï¼ˆè¿™é‡Œå¹¶ä¸æ˜¯åªèƒ½ç”¨ Preferenceï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨ <code>onChange</code> å’Œ  <code>task(id:)</code> ï¼‰</p><p>æˆ‘ä»¬å°† <code>AppDelegate</code> å’Œ <code>View + Extension</code> åˆå¹¶åœ¨ä¸€èµ·ï¼Œå®Œæ•´ä»£ç å¦‚ä¸‹ï¼š</p><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> SwiftUI</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">AppDelegate</span>: <span class="title class_">NSObject</span>, <span class="title class_">UIApplicationDelegate</span> &#123;</span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">var</span> defaultOrientation <span class="operator">=</span> <span class="type">UIInterfaceOrientationMask</span>.allButUpsideDown</span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">var</span> orientationLock <span class="operator">=</span> <span class="type">UIInterfaceOrientationMask</span>.allButUpsideDown</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">func</span> <span class="title function_">application</span>(<span class="keyword">_</span> <span class="params">application</span>: <span class="type">UIApplication</span>, <span class="params">supportedInterfaceOrientationsFor</span> <span class="params">window</span>: <span class="type">UIWindow</span>?) -&gt; <span class="type">UIInterfaceOrientationMask</span> &#123;</span><br><span class="line">        <span class="type">AppDelegate</span>.orientationLock</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// MARK: - Orientation Lock Preferences</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">DefaultOrientationMask</span>: <span class="title class_">PreferenceKey</span> &#123;</span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">var</span> defaultValue: <span class="type">UIInterfaceOrientationMask</span> &#123; <span class="type">UIDevice</span>.current.userInterfaceIdiom <span class="operator">==</span> .pad <span class="operator">?</span> .all : .allButUpsideDown &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">func</span> <span class="title function_">reduce</span>(<span class="params">value</span>: <span class="keyword">inout</span> <span class="type">UIInterfaceOrientationMask</span>, <span class="params">nextValue</span>: () -&gt; <span class="type">UIInterfaceOrientationMask</span>) &#123;</span><br><span class="line">        value <span class="operator">=</span> nextValue()</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">DeviceOrientationMask</span>: <span class="title class_">PreferenceKey</span> &#123;</span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">var</span> defaultValue: <span class="type">UIInterfaceOrientationMask</span> &#123; <span class="type">UIDevice</span>.current.userInterfaceIdiom <span class="operator">==</span> .pad <span class="operator">?</span> .all : .allButUpsideDown &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">func</span> <span class="title function_">reduce</span>(<span class="params">value</span>: <span class="keyword">inout</span> <span class="type">UIInterfaceOrientationMask</span>, <span class="params">nextValue</span>: () -&gt; <span class="type">UIInterfaceOrientationMask</span>) &#123;</span><br><span class="line">        value <span class="operator">=</span> nextValue()</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// MARK: - View + Orientation Lock</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">extension</span> <span class="title class_">View</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">func</span> <span class="title function_">updateOrientation</span>(<span class="keyword">_</span> <span class="params">orientation</span>: <span class="type">UIInterfaceOrientationMask</span>) &#123;</span><br><span class="line">        <span class="type">UIInterfaceOrientation</span>.updateOrientation(orientation)</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">func</span> <span class="title function_">deviceOrientation</span>(<span class="keyword">_</span> <span class="params">orientation</span>: <span class="type">UIInterfaceOrientationMask</span>) -&gt; <span class="keyword">some</span> <span class="type">View</span> &#123;</span><br><span class="line">        preference(</span><br><span class="line">            key: <span class="type">DeviceOrientationMask</span>.<span class="keyword">self</span>,</span><br><span class="line">            value: orientation</span><br><span class="line">        )</span><br><span class="line">        .onPreferenceChange(<span class="type">DeviceOrientationMask</span>.<span class="keyword">self</span>, perform: updateOrientation(<span class="keyword">_</span>:))</span><br><span class="line">        .onAppear &#123;</span><br><span class="line">            updateOrientation(orientation)</span><br><span class="line">        &#125;</span><br><span class="line">        .onDisappear &#123;</span><br><span class="line">            updateOrientation(<span class="type">AppDelegate</span>.defaultOrientation)</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">func</span> <span class="title function_">defaultOrientationMask</span>(<span class="keyword">_</span> <span class="params">orientation</span>: <span class="type">UIInterfaceOrientationMask</span>) -&gt; <span class="keyword">some</span> <span class="type">View</span> &#123;</span><br><span class="line">        preference(</span><br><span class="line">            key: <span class="type">DefaultOrientationMask</span>.<span class="keyword">self</span>,</span><br><span class="line">            value: orientation</span><br><span class="line">        )</span><br><span class="line">        .onPreferenceChange(<span class="type">DefaultOrientationMask</span>.<span class="keyword">self</span>) &#123;</span><br><span class="line">            <span class="type">AppDelegate</span>.defaultOrientation <span class="operator">=</span> <span class="variable">$0</span></span><br><span class="line">            <span class="comment">/// `defaultOrientation` == `orientationLock` means</span></span><br><span class="line">            <span class="comment">/// there is no other orientation lockers been activated. In this case,</span></span><br><span class="line">            <span class="comment">/// if the default orientation changes, we need to update current orientation.</span></span><br><span class="line">            <span class="keyword">guard</span> <span class="type">AppDelegate</span>.defaultOrientation <span class="operator">==</span> <span class="type">AppDelegate</span>.orientationLock <span class="keyword">else</span> &#123; <span class="keyword">return</span> &#125;</span><br><span class="line">            updateOrientation(<span class="variable">$0</span>)</span><br><span class="line">        &#125;</span><br><span class="line">        .onAppear &#123;</span><br><span class="line">            updateOrientation(orientation)</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// MARK: - UIInterfaceOrientation + Update</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">extension</span> <span class="title class_">UIInterfaceOrientation</span> &#123;</span><br><span class="line">    <span class="keyword">init?</span>(<span class="params">deviceOrientation</span>: <span class="type">UIDeviceOrientation</span>) &#123;</span><br><span class="line">        <span class="keyword">let</span> orientation: <span class="type">UIInterfaceOrientation</span> <span class="operator">=</span> &#123;</span><br><span class="line">            <span class="keyword">switch</span> deviceOrientation &#123;</span><br><span class="line">            <span class="keyword">case</span> .portraitUpsideDown: <span class="type">UIInterfaceOrientation</span>.portraitUpsideDown</span><br><span class="line">            <span class="keyword">case</span> .landscapeLeft: <span class="type">UIInterfaceOrientation</span>.landscapeLeft</span><br><span class="line">            <span class="keyword">case</span> .landscapeRight: <span class="type">UIInterfaceOrientation</span>.landscapeRight</span><br><span class="line">            <span class="keyword">default</span>: <span class="type">UIInterfaceOrientation</span>.portrait</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;()</span><br><span class="line">        <span class="keyword">self</span>.<span class="keyword">init</span>(rawValue: orientation.rawValue)</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">func</span> <span class="title function_">updateOrientation</span>(<span class="keyword">_</span> <span class="params">orientation</span>: <span class="type">UIInterfaceOrientationMask</span>) &#123;</span><br><span class="line">        <span class="type">AppDelegate</span>.orientationLock <span class="operator">=</span> orientation</span><br><span class="line">        <span class="comment">// Tells System to re-call</span></span><br><span class="line">        <span class="comment">// `application(_:supportedInterfaceOrientationsFor)` method</span></span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">#available</span>(<span class="keyword">iOS</span> <span class="number">16.0</span>, <span class="operator">*</span>) &#123;</span><br><span class="line">            <span class="keyword">let</span> scenes <span class="operator">=</span> <span class="type">UIApplication</span>.shared.connectedScenes</span><br><span class="line">            <span class="keyword">let</span> windowScene <span class="operator">=</span> scenes.first <span class="keyword">as?</span> <span class="type">UIWindowScene</span></span><br><span class="line">            <span class="keyword">let</span> window <span class="operator">=</span> windowScene<span class="operator">?</span>.windows.first</span><br><span class="line">            window<span class="operator">?</span>.rootViewController<span class="operator">?</span>.setNeedsUpdateOfSupportedInterfaceOrientations()</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="comment">// Manually rotate your screen and refresh InterfaceMask.</span></span><br><span class="line">            <span class="keyword">let</span> newOrientation: <span class="type">UIInterfaceOrientation</span> <span class="operator">=</span> &#123;</span><br><span class="line">                <span class="keyword">switch</span> orientation &#123;</span><br><span class="line">                <span class="keyword">case</span> .portrait: <span class="keyword">return</span> .portrait</span><br><span class="line">                <span class="keyword">case</span> .landscapeLeft: <span class="keyword">return</span> .landscapeLeft</span><br><span class="line">                <span class="keyword">case</span> .landscapeRight: <span class="keyword">return</span> .landscapeRight</span><br><span class="line">                <span class="keyword">case</span> .portraitUpsideDown: <span class="keyword">return</span> .portraitUpsideDown</span><br><span class="line">                <span class="keyword">default</span>:</span><br><span class="line">                    <span class="keyword">let</span> current <span class="operator">=</span> <span class="type">UIInterfaceOrientation</span>(deviceOrientation: <span class="type">UIDevice</span>.current.orientation)<span class="operator">!</span></span><br><span class="line">                    <span class="keyword">guard</span> orientation <span class="operator">!=</span> .all <span class="keyword">else</span> &#123; <span class="keyword">return</span> current &#125;</span><br><span class="line">                    <span class="keyword">if</span> orientation <span class="operator">==</span> .allButUpsideDown  &#123;</span><br><span class="line">                        <span class="keyword">return</span> current <span class="operator">==</span> .portraitUpsideDown <span class="operator">?</span> .portrait : current</span><br><span class="line">                    &#125;</span><br><span class="line">                    <span class="keyword">if</span> current <span class="operator">!=</span> .landscapeLeft <span class="operator">&amp;&amp;</span> current <span class="operator">!=</span> .landscapeRight &#123;</span><br><span class="line">                        <span class="keyword">return</span> .landscapeLeft</span><br><span class="line">                    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                        <span class="keyword">return</span> current</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;()</span><br><span class="line">            <span class="type">UIDevice</span>.current.setValue(newOrientation.rawValue, forKey: <span class="string">&quot;orientation&quot;</span>)</span><br><span class="line">            <span class="comment">// Always send a notification in case the device orientation doesn&#x27;t change</span></span><br><span class="line">            <span class="type">NotificationCenter</span>.default.post(name: <span class="type">UIDevice</span>.orientationDidChangeNotification, object: <span class="literal">nil</span>)</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
    
    
    <summary type="html">&lt;p&gt;åœ¨è®¸å¤šæƒ…å†µä¸‹ï¼Œæˆ‘ä»¬å¸Œæœ›æŸä¸€ä¸ªè§†å›¾èƒ½å¤Ÿé”å®šåœ¨ä¸€ä¸ªç‰¹å®šçš„æ–¹å‘ä¸‹ï¼Œä¾‹å¦‚ï¼šç›¸æœºé¡µé¢ç­‰&lt;/p&gt;
&lt;p&gt;æœ¬æ–‡å°†åˆ†äº«ä¸€ç§æˆ‘è‡ªå·±æ£è…¾å‡ºæ¥çš„ä¸€ç§å®ç°æ–¹å¼ä»¥åŠèƒŒåçš„é€»è¾‘ã€‚&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;æœ¬æ–‡ä»…é€‚ç”¨äº iOS&lt;/strong&gt;&lt;/p&gt;</summary>
    
    
    
    <category term="æ’¸ä»£ç " scheme="https://liyanan2004.github.io/categories/%E6%92%B8%E4%BB%A3%E7%A0%81/"/>
    
    
    <category term="SwiftUI" scheme="https://liyanan2004.github.io/tags/SwiftUI/"/>
    
  </entry>
  
  <entry>
    <title>Swift Data çš„åˆæ­¥æ¢ç´¢</title>
    <link href="https://liyanan2004.github.io/meet-swift-data/"/>
    <id>https://liyanan2004.github.io/meet-swift-data/</id>
    <published>2023-06-17T14:55:16.000Z</published>
    <updated>2023-06-17T15:04:38.000Z</updated>
    
    <content type="html"><![CDATA[<p>æœ‹å‹ä»¬å¥½ï¼Œä¸€å‘¨çš„è€ƒè¯•ç»“æŸäº†ï¼Œæˆ‘å›æ¥ç»§ç»­æ›´æ–°äº†ï¼Œæ„Ÿè§‰è€ƒçš„ä¸é”™ï¼Œæš‘å‡é‡Œäº‰å–å¤šæ›´æ–°ä¸€äº›ã€‚</p><p>ä»Šå¤©çš„ä¸»é¢˜æ˜¯ Swift Data â€“ Core Data çš„ Swift åŒ–å°è£…ã€‚</p><p>æœ¬æ–‡ä¸º <a href="https://developer.apple.com/wwdc23/10187">Meet Swift Data</a> çš„å­¦ä¹ ç¬”è®°ã€‚</p><span id="more"></span><h2 id="æ¨¡å‹"><a href="#æ¨¡å‹" class="headerlink" title="æ¨¡å‹"></a>æ¨¡å‹</h2><p>å€ŸåŠ© Swift 5.9 çš„ Macroï¼Œå¼€å‘è€…å¯ä»¥å¾ˆå®¹æ˜“åœ°åˆ›å»ºä¸€ä¸ªæ•°æ®æ¨¡å‹ï¼Œå¹¶å¯ä»¥å°†ä¹‹ä»¥ <code>@Observable</code> çš„æ–¹å¼æ³¨å…¥ SwiftUI View æˆä¸º Source Of Truthï¼Œå¹¶ä¸”ä¸ <code>@Observable</code> è·å¾—äº†ä¸€è‡´çš„<strong>åªåˆ·æ–°å˜åŒ–çš„å€¼</strong>çš„ç‰¹æ€§ã€‚</p><p>åœ¨ Model ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥æ›´åŠ å®¹æ˜“åœ°ä½¿ç”¨è‡ªå®šä¹‰çš„ structã€enum ç­‰ä¹‹å‰åœ¨ Model Editor ä¸­ä¸å¥½å¼•å…¥çš„è‡ªå®šä¹‰ç±»å‹ã€‚</p><p>@Model ä¹Ÿæ”¯æŒæ¨¡å‹ä¸æ¨¡å‹ä¹‹å‰çš„å…³ç³»å’Œå±æ€§ï¼š</p><ul><li><code>@Attribute</code>ï¼šè®¾ç½® <code>unique</code>ã€<code>externalStorage</code>ã€<code>spotlight</code> ç­‰å±æ€§ã€‚</li><li><code>@Relationship</code>ï¼šè‡ªå®šä¹‰æ¨¡å‹é—´çš„å…³ç³»ï¼Œä»è€Œç¡®å®šè¯¸å¦‚åˆ é™¤ç­‰æ“ä½œçš„è¡Œä¸ºã€‚</li></ul><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Model</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Trip</span> &#123;</span><br><span class="line">    <span class="meta">@Attribute</span>(.unique) <span class="keyword">var</span> name: <span class="type">String</span></span><br><span class="line">    <span class="keyword">var</span> destination: <span class="type">String</span></span><br><span class="line">    <span class="keyword">var</span> endDate: <span class="type">Date</span></span><br><span class="line">    <span class="keyword">var</span> startDate: <span class="type">Date</span></span><br><span class="line"> </span><br><span class="line">    <span class="meta">@Relationship</span>(.cascade) <span class="keyword">var</span> bucketList: [<span class="type">BucketListItem</span>]<span class="operator">?</span> <span class="operator">=</span> []</span><br><span class="line">    <span class="keyword">var</span> livingAccommodation: <span class="type">LivingAccommodation</span>?</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¿™æ®µä»£ç ä¸­ï¼š</p><ul><li>ç¡®ä¿äº† <code>name</code> å­—æ®µçš„å”¯ä¸€æ€§ã€‚</li><li>æŒ‡å®šäº† Trip ä¸ BucketListItem ä¹‹é—´çš„å…³ç³»ï¼Œå³ä¸€æ—¦ Trip è¢«åˆ é™¤ï¼Œæ‰€æœ‰çš„ BucketListItem ä¹Ÿä¼šè¢«ä¸€å¹¶åˆ é™¤ã€‚</li></ul><h2 id="æ³¨å…¥"><a href="#æ³¨å…¥" class="headerlink" title="æ³¨å…¥"></a>æ³¨å…¥</h2><p>åœ¨ SwiftUI ä¸­ï¼Œåœ¨æœ€ç®€å•çš„æƒ…å†µä¸‹ï¼Œåªéœ€è¦åœ¨ ContentView ååŠ ä¸€å¥ <code>.modelContainer(for: )</code> å³å¯ã€‚</p><p>ä½†æ˜¯åœ¨ä¸šåŠ¡å¤æ‚çš„æƒ…å†µä¸‹ï¼Œä¾‹å¦‚éœ€è¦åšæ•°æ®åº“è¿ç§»æˆ–æ›´æ–°è¿™ç±»æ“ä½œæ—¶ï¼Œæˆ–è€…åœ¨å…¶ä»–ç¯å¢ƒä¸‹ä½¿ç”¨ Swift Dataï¼Œä½ å¯èƒ½å°±éœ€è¦ä¸€ä¸ª Container å®¹å™¨æ¥æ“ä½œäº†ã€‚</p><p>åˆ›å»ºçš„æ–¹æ³•ä¹Ÿå¾ˆç®€å•ï¼š</p><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> container <span class="operator">=</span> <span class="keyword">try</span> <span class="type">ModelContainer</span>([<span class="type">Trip</span>.<span class="keyword">self</span>, <span class="type">LivingAccommodation</span>.<span class="keyword">self</span>])</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> container <span class="operator">=</span> <span class="keyword">try</span> <span class="type">ModelContainer</span>(</span><br><span class="line">    for: [<span class="type">Trip</span>.<span class="keyword">self</span>, <span class="type">LivingAccommodation</span>.<span class="keyword">self</span>],</span><br><span class="line">    configurations: <span class="type">ModelConfiguration</span>(url: <span class="type">URL</span>(<span class="string">&quot;path&quot;</span>))</span><br><span class="line">)</span><br></pre></td></tr></table></figure><p>è·å– Container Contextï¼š</p><ul><li>åœ¨ SwiftUI ä¸‹è®¿é—® Model Containerï¼š<code>@Environment(\.modelContext) private var context</code></li><li>å¦‚æœä¸åœ¨ View å±‚çº§ï¼Œä¾‹å¦‚åœ¨ ViewModel ä¸­ï¼Œå¯ä»¥ä½¿ç”¨ <code>container.mainContext</code> æ¥è·å¾—å…±äº«çš„<strong>ä¸»çº¿ç¨‹ä¸Šä¸‹æ–‡</strong></li></ul><h2 id="ç­›é€‰"><a href="#ç­›é€‰" class="headerlink" title="ç­›é€‰"></a>ç­›é€‰</h2><p><code>Predicate</code>ã€<code>SortDescriptor</code> ç­‰ä¹‹å‰æ™¦æ¶©éš¾æ‡‚ä¸”ä¸å®‰å…¨çš„ API ä¹Ÿæ›´æ–°äº†ï¼Œå¯ä»¥æ›´åŠ  Swift åŒ–åœ°ä½¿ç”¨ä»–ä»¬äº†ã€‚</p><p>è·å–æ•°æ®å˜æˆäº†è¿™æ ·ï¼Œæ›´åŠ ç›´è§‚äº†ï¼š</p><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> today <span class="operator">=</span> <span class="type">Date</span>()</span><br><span class="line"><span class="keyword">let</span> tripPredicate <span class="operator">=</span> #<span class="type">Predicate</span>&lt;<span class="type">Trip</span>&gt; &#123; </span><br><span class="line">    <span class="variable">$0</span>.destination <span class="operator">==</span> <span class="string">&quot;New York&quot;</span> <span class="operator">&amp;&amp;</span></span><br><span class="line">    <span class="variable">$0</span>.name.contains(<span class="string">&quot;birthday&quot;</span>) <span class="operator">&amp;&amp;</span></span><br><span class="line">    <span class="variable">$0</span>.startDate <span class="operator">&gt;</span> today</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">let</span> descriptor <span class="operator">=</span> <span class="type">FetchDescriptor</span>&lt;<span class="type">Trip</span>&gt;(predicate: tripPredicate)</span><br><span class="line"><span class="keyword">let</span> trips <span class="operator">=</span> <span class="keyword">try</span> context.fetch(descriptor)</span><br></pre></td></tr></table></figure><h2 id="å¢ã€åˆ ã€å­˜"><a href="#å¢ã€åˆ ã€å­˜" class="headerlink" title="å¢ã€åˆ ã€å­˜"></a>å¢ã€åˆ ã€å­˜</h2><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> myTrip <span class="operator">=</span> <span class="type">Trip</span>(name: <span class="string">&quot;Birthday Trip&quot;</span>, destination: <span class="string">&quot;New York&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">// Insert a new trip</span></span><br><span class="line">context.insert(myTrip)</span><br><span class="line"></span><br><span class="line"><span class="comment">// Delete an existing trip</span></span><br><span class="line">context.delete(myTrip)</span><br><span class="line"></span><br><span class="line"><span class="comment">// Manually save changes to the context</span></span><br><span class="line"><span class="keyword">try</span> context.save()</span><br></pre></td></tr></table></figure><h2 id="å°ç»“"><a href="#å°ç»“" class="headerlink" title="å°ç»“"></a>å°ç»“</h2><p>å…¶å®<strong>æˆ‘æ˜¯éå¸¸æ„¿æ„ä½¿ç”¨æ–°çš„ Swift Data çš„</strong>ï¼Œè‹¹æœåº”è¯¥ä¹Ÿä¼šåœ¨æ¥ä¸‹æ¥çš„å‡ ä¸ª Beta ä¸­ä¸æ–­å®Œå–„è¿™ä¸ªæ¡†æ¶ã€‚</p><p>æ­£å¦‚è‚˜å­è€å¸ˆåœ¨ WWDC.playground ä¸­æ‰€è¯´çš„ï¼Œ<strong>Swift Data å¯¹äºæœ‰ä¸€å®š Core Data åŸºç¡€çš„äººæ¥è¯´ä½¿ç”¨èµ·æ¥éå¸¸ç®€å•</strong>ï¼Œä½†æ˜¯ Swift Data ç›®å‰ä¹Ÿå­˜åœ¨ä¸å°‘é—®é¢˜ï¼Œè€Œå…¶ä¸­æœ€è‡´å‘½çš„è«è¿‡äºæ²¡æœ‰åŠæ³•åšå‘åå…¼å®¹äº†ï¼Œå…¶æ¬¡åŒ…æ‹¬ iCloud åŒæ­¥åœ¨å†…çš„å¾ˆå¤šåŠŸèƒ½éƒ½æ²¡æ³•ä½¿ç”¨ï¼ˆè¿™é‡Œçš„ä¿¡æ¯æ¥è‡ªè‚˜å­è€å¸ˆçš„æ¨æ–‡ï¼Œæˆ‘æ²¡æœ‰å°è¯• iCloud çš„éƒ¨åˆ†ï¼‰ã€‚</p>]]></content>
    
    
    <summary type="html">&lt;p&gt;æœ‹å‹ä»¬å¥½ï¼Œä¸€å‘¨çš„è€ƒè¯•ç»“æŸäº†ï¼Œæˆ‘å›æ¥ç»§ç»­æ›´æ–°äº†ï¼Œæ„Ÿè§‰è€ƒçš„ä¸é”™ï¼Œæš‘å‡é‡Œäº‰å–å¤šæ›´æ–°ä¸€äº›ã€‚&lt;/p&gt;
&lt;p&gt;ä»Šå¤©çš„ä¸»é¢˜æ˜¯ Swift Data â€“ Core Data çš„ Swift åŒ–å°è£…ã€‚&lt;/p&gt;
&lt;p&gt;æœ¬æ–‡ä¸º &lt;a href=&quot;https://developer.apple.com/wwdc23/10187&quot;&gt;Meet Swift Data&lt;/a&gt; çš„å­¦ä¹ ç¬”è®°ã€‚&lt;/p&gt;</summary>
    
    
    
    <category term="æ’¸ä»£ç " scheme="https://liyanan2004.github.io/categories/%E6%92%B8%E4%BB%A3%E7%A0%81/"/>
    
    
    <category term="SwiftUI" scheme="https://liyanan2004.github.io/tags/SwiftUI/"/>
    
    <category term="WWDC 23" scheme="https://liyanan2004.github.io/tags/WWDC-23/"/>
    
    <category term="Swift Data" scheme="https://liyanan2004.github.io/tags/Swift-Data/"/>
    
  </entry>
  
  <entry>
    <title>SwiftUI æ–°åŠŸèƒ½</title>
    <link href="https://liyanan2004.github.io/wwdc-23-whats-new-in-swiftui/"/>
    <id>https://liyanan2004.github.io/wwdc-23-whats-new-in-swiftui/</id>
    <published>2023-06-07T02:44:08.000Z</published>
    <updated>2023-06-08T06:03:55.000Z</updated>
    
    <content type="html"><![CDATA[<p>æœ¬æ–‡ä¸º <a href="https://developer.apple.com/wwdc23/10148">Whatâ€™s new in SwiftUI</a> çš„å­¦ä¹ ç¬”è®°</p><span id="more"></span><h2 id="SwiftUI-çš„æ›´å¤šåº”ç”¨åœºæ™¯"><a href="#SwiftUI-çš„æ›´å¤šåº”ç”¨åœºæ™¯" class="headerlink" title="SwiftUI çš„æ›´å¤šåº”ç”¨åœºæ™¯"></a>SwiftUI çš„æ›´å¤šåº”ç”¨åœºæ™¯</h2><h3 id="é€‚ç”¨äº-visionOS-çš„-Scenes"><a href="#é€‚ç”¨äº-visionOS-çš„-Scenes" class="headerlink" title="é€‚ç”¨äº visionOS çš„ Scenes"></a>é€‚ç”¨äº visionOS çš„ Scenes</h3><ul><li>WindowGroupï¼šSwiftUI å¯ä»¥ç›´æ¥åº”ç”¨äº visionOS ä¸­ï¼Œä¸éœ€è¦ä»»ä½•è®¾ç½®ï¼Œä»¥å¹³é¢çš„æ–¹å¼æ˜¾ç¤ºã€‚</li><li>è¦æƒ³å¢åŠ ã€Œæ·±åº¦ã€ä¸Šçš„æ”¯æŒï¼Œå¯ä»¥ä½¿ç”¨ <code>.windowStyle(.volumetric)</code>ã€‚<ul><li><code>Model3D</code>ï¼šè½½å…¥é™æ€æ¨¡å‹</li><li><code>RealityView</code>ï¼šè½½å…¥åŠ¨æ€æ¨¡å‹ï¼ŒåŒ…æ‹¬å…‰çº¿è¿½è¸ªã€äº¤äº’ç­‰</li></ul></li><li>ImmersiveSpaceï¼šæ„å»ºå®Œå…¨ã€Œæ²‰æµ¸å¼ã€çš„ä½“éªŒã€‚</li></ul><p><img src="/img/wwdc-23-whats-new-in-swiftui/scenes-for-spacial-computing.jpeg"></p><p><img src="/img/wwdc-23-whats-new-in-swiftui/swiftui-in-visionos.jpeg" alt="visionOS ä¸Šçš„ SwiftUI"></p><h3 id="watchOS-10"><a href="#watchOS-10" class="headerlink" title="watchOS 10"></a>watchOS 10</h3><p>watchOS 10 ç»è¿‡é‡æ–°è®¾è®¡ã€‚</p><p><code>NavigationSplitView</code>ã€<code>TabView</code>ã€<code>NavigationStack</code> åœ¨ watchOS ä¸­ä¹Ÿå¾—åˆ°çš„é‡å¤§æ›´æ–°ï¼Œå¹¶æœ‰äº†æ–°çš„åŠ¨ç”»æ•ˆæœ</p><p><img src="/img/wwdc-23-whats-new-in-swiftui/watchos-10-updated-views.jpeg"></p><p>éƒ¨åˆ† API å¾—åˆ°æ”¹è¿›ï¼š</p><ul><li><code>.containerBackground(for: .navigation) &#123; ... &#125;</code>ï¼šè®¾ç½®å®¹å™¨èƒŒæ™¯ï¼Œåœ¨ä¸åŒå®¹å™¨ä¸­åˆ‡æ¢æ—¶èƒ½å¤Ÿé¡ºæ»‘åˆ‡æ¢</li><li><code>ToolbarItem</code> æ–°å¢ <code>topBarLeading</code> å’Œ <code>topBarTrailing</code>ï¼ˆå‡åŒ…å«è·¨å¹³å°æ”¯æŒï¼‰<br><img src="/img/wwdc-23-whats-new-in-swiftui/toolbar-placement.jpeg"></li><li>æ”¯æŒ <code>DatePicker</code> å’Œ <code>List</code> selection</li></ul><h3 id="Widgets"><a href="#Widgets" class="headerlink" title="Widgets"></a>Widgets</h3><p>æ‰€æœ‰å¹³å°çš„ Widgets å‡ç”± SwiftUI æ„å»ºã€‚</p><p><img src="/img/wwdc-23-whats-new-in-swiftui/widgets.jpeg"></p><p>ğŸ‰ Widget æ”¯æŒã€Œäº¤äº’å’ŒåŠ¨ç”»ã€</p><ul><li>Widget æŒ‰é’®ç‚¹å‡»åè§¦å‘çš„æ˜¯ Bundle é‡Œçš„ App Intents ç›¸å…³ä»£ç </li><li>ç”¨ <code>.animation</code> å’Œ <code>.transition</code> ä¸ºå…ƒç´ å¢åŠ åŠ¨ç”»</li></ul><h3 id="Previews"><a href="#Previews" class="headerlink" title="Previews"></a>Previews</h3><ul><li>åŸºäº SwiftUI 5.9ï¼Œä½ å¯ä»¥ç”¨å®æ¥æ„å»º Preview</li><li>macOS app æ”¯æŒ Live Preview<br><img src="/img/wwdc-23-whats-new-in-swiftui/macos-live-preview.jpeg"></li></ul><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">#<span class="type">Preview</span>(<span class="string">&quot;Preview Name&quot;</span>) &#123;</span><br><span class="line">   <span class="operator">...</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>é¢„è§ˆ Widget åŠ¨ç”»ï¼š</p><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">#<span class="type">Preview</span>(as: .systemSmall) &#123;</span><br><span class="line">    <span class="type">CaffeineTrackerWidget</span>()</span><br><span class="line">&#125; timeline: &#123;</span><br><span class="line">    <span class="type">CaffeineLogEntry</span>.log1</span><br><span class="line">    <span class="type">CaffeineLogEntry</span>.log2</span><br><span class="line">    <span class="type">CaffeineLogEntry</span>.log3</span><br><span class="line">    <span class="type">CaffeineLogEntry</span>.log4</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><img src="/img/wwdc-23-whats-new-in-swiftui/preview-macro.jpeg"></p><p>æ›´å¤šæ›´æ–°ï¼š</p><ul><li>MapKit for SwiftUIï¼šæ›´å…¨é¢åœ°æ§åˆ¶ã€è‡ªå®šä¹‰</li><li>Swift Chartsï¼šæ”¯æŒæ»šåŠ¨ã€é€‰æ‹©ã€é¥¼&#x2F;ç¯çŠ¶å›¾</li><li>StoreKit for SwiftUIï¼šæ›´ç®€å•åœ°æ„å»ºå†…è´­é¡µé¢</li><li>â€¦</li></ul><h2 id="ç®€åŒ–çš„æ•°æ®æµ"><a href="#ç®€åŒ–çš„æ•°æ®æµ" class="headerlink" title="ç®€åŒ–çš„æ•°æ®æµ"></a>ç®€åŒ–çš„æ•°æ®æµ</h2><h3 id="Observable"><a href="#Observable" class="headerlink" title="@Observable"></a><code>@Observable</code></h3><p><img src="/img/wwdc-23-whats-new-in-swiftui/observable.jpeg"></p><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Observable</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Dog</span>: <span class="title class_">Identifiable</span> &#123;</span><br><span class="line">    <span class="keyword">var</span> id <span class="operator">=</span> <span class="type">UUID</span>()</span><br><span class="line">    <span class="keyword">var</span> name <span class="operator">=</span> <span class="string">&quot;&quot;</span></span><br><span class="line">    <span class="keyword">var</span> age <span class="operator">=</span> <span class="number">1</span></span><br><span class="line">    <span class="keyword">var</span> breed <span class="operator">=</span> <span class="type">DogBreed</span>.mutt</span><br><span class="line">    <span class="keyword">var</span> owner: <span class="type">Person</span>? <span class="operator">=</span> <span class="literal">nil</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">struct</span> <span class="title class_">DogCard</span>: <span class="title class_">View</span> &#123;</span><br><span class="line">    <span class="keyword">var</span> dog: <span class="type">Dog</span> <span class="comment">// ä¹‹å‰çš„å†™æ³•ï¼š@ObservedObject var dog: Dog</span></span><br><span class="line">    <span class="operator">...</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>SwiftUI ä¸­çš„æ•°æ®æµè¢«ç®€åŒ–æˆ <code>@State</code> å’Œ <code>@Environment</code></p><ul><li><code>@State</code> å¤„ç†å¯æ›´æ”¹çš„å˜é‡</li><li><code>@Environment</code> èåˆäº†åŸå…ˆçš„ <code>@EnvironmentObject</code></li></ul><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> SwiftUI</span><br><span class="line"></span><br><span class="line"><span class="keyword">@main</span></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">WhatsNew2023</span>: <span class="title class_">App</span> &#123;</span><br><span class="line">    <span class="meta">@State</span> <span class="keyword">private</span> <span class="keyword">var</span> currentUser: <span class="type">User</span>?</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">var</span> body: <span class="keyword">some</span> <span class="type">Scene</span> &#123;</span><br><span class="line">        <span class="type">WindowGroup</span> &#123;</span><br><span class="line">            <span class="type">ProfileView</span>()</span><br><span class="line">                .environment(currentUser)</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">struct</span> <span class="title class_">ProfileView</span>: <span class="title class_">View</span> &#123;</span><br><span class="line">        <span class="meta">@Environment</span>(<span class="type">User</span>.<span class="keyword">self</span>) <span class="keyword">private</span> <span class="keyword">var</span> currentUser: <span class="type">User</span>?</span><br><span class="line"></span><br><span class="line">        <span class="keyword">var</span> body: <span class="keyword">some</span> <span class="type">View</span> &#123;</span><br><span class="line">            <span class="keyword">if</span> <span class="keyword">let</span> currentUser &#123;</span><br><span class="line">                <span class="type">UserDetails</span>(user: currentUser)</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                <span class="type">Button</span>(<span class="string">&quot;Log In&quot;</span>) &#123; &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Observable</span></span><br><span class="line">    <span class="keyword">class</span> <span class="title class_">User</span>: <span class="title class_">Identifiable</span> &#123;</span><br><span class="line">        <span class="keyword">var</span> id <span class="operator">=</span> <span class="type">UUID</span>()</span><br><span class="line">        <span class="keyword">var</span> name <span class="operator">=</span> <span class="string">&quot;&quot;</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="SwiftData"><a href="#SwiftData" class="headerlink" title="SwiftData"></a>SwiftData</h3><p>éš†é‡ä»‹ç»ï¼ŒSwiftDataã€‚</p><p>SwiftData æä¾›äº† Swift å¼çš„ Core Data å®ç°ï¼Œæ”¯æŒ Swift 5.9 çš„å®ã€‚</p><p>åªéœ€è¦æŠŠ <code>@Observable</code> æ”¹ä¸º <code>@Model</code> å°±å¯ä»¥äº†ï¼Œä¸ç”¨æ‹…å¿ƒï¼Œ<code>@Observable</code> çš„èƒ½åŠ›ä¹Ÿä¼šå®Œå…¨ä¿ç•™ã€‚</p><p>åœ¨ SwiftUI ä¸­ï¼Œä½¿ç”¨ <code>@Query</code> æ¥æŸ¥è¯¢æ•°æ®ã€‚</p><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> Foundation</span><br><span class="line"><span class="keyword">import</span> SwiftUI</span><br><span class="line"><span class="keyword">import</span> SwiftData</span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">RecentDogsView</span>: <span class="title class_">View</span> &#123;</span><br><span class="line">    <span class="meta">@Query</span>(sort: \.dateSpotted) <span class="keyword">private</span> <span class="keyword">var</span> dogs: [<span class="type">Dog</span>]</span><br><span class="line"></span><br><span class="line">    <span class="keyword">var</span> body: <span class="keyword">some</span> <span class="type">View</span> &#123;</span><br><span class="line">        <span class="type">ScrollView</span>(.vertical) &#123;</span><br><span class="line">            <span class="type">LazyVStack</span> &#123;</span><br><span class="line">                <span class="type">ForEach</span>(dogs) &#123; dog <span class="keyword">in</span></span><br><span class="line">                    <span class="type">DogCard</span>(dog: dog)</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">struct</span> <span class="title class_">DogCard</span>: <span class="title class_">View</span> &#123;</span><br><span class="line">        <span class="keyword">var</span> dog: <span class="type">Dog</span></span><br><span class="line">        </span><br><span class="line">        <span class="keyword">var</span> body: <span class="keyword">some</span> <span class="type">View</span> &#123;</span><br><span class="line">            <span class="type">DogImage</span>(dog: dog)</span><br><span class="line">                .overlay(alignment: .bottom) &#123;</span><br><span class="line">                    <span class="type">HStack</span> &#123;</span><br><span class="line">                        <span class="type">Text</span>(dog.name)</span><br><span class="line">                        <span class="type">Spacer</span>()</span><br><span class="line">                        <span class="type">Image</span>(systemName: <span class="string">&quot;heart&quot;</span>)</span><br><span class="line">                            .symbolVariant(dog.isFavorite <span class="operator">?</span> .fill : .none)</span><br><span class="line">                    &#125;</span><br><span class="line">                    .font(.headline)</span><br><span class="line">                    .padding(.horizontal, <span class="number">22</span>)</span><br><span class="line">                    .padding(.vertical, <span class="number">12</span>)</span><br><span class="line">                    .background(.thinMaterial)</span><br><span class="line">                &#125;</span><br><span class="line">                .clipShape(.rect(cornerRadius: <span class="number">16</span>))</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">struct</span> <span class="title class_">DogImage</span>: <span class="title class_">View</span> &#123;</span><br><span class="line">        <span class="keyword">var</span> dog: <span class="type">Dog</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">var</span> body: <span class="keyword">some</span> <span class="type">View</span> &#123;</span><br><span class="line">            <span class="type">Rectangle</span>()</span><br><span class="line">                .fill(<span class="type">Color</span>.green)</span><br><span class="line">                .frame(width: <span class="number">400</span>, height: <span class="number">400</span>)</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Model</span></span><br><span class="line">    <span class="keyword">class</span> <span class="title class_">Dog</span>: <span class="title class_">Identifiable</span> &#123;</span><br><span class="line">        <span class="keyword">var</span> name <span class="operator">=</span> <span class="string">&quot;&quot;</span></span><br><span class="line">        <span class="keyword">var</span> isFavorite <span class="operator">=</span> <span class="literal">false</span></span><br><span class="line">        <span class="keyword">var</span> dateSpotted <span class="operator">=</span> <span class="type">Date</span>.now</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">#<span class="type">Preview</span> &#123;</span><br><span class="line">    <span class="type">RecentDogsView</span>()</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="Document-Based-App"><a href="#Document-Based-App" class="headerlink" title="Document-Based App"></a>Document-Based App</h3><ul><li>å¢åŠ äº†ä¸€ä¸ªå…¨æ–°çš„ API ç”¨ä»¥å¿«é€Ÿæ„å»º model containerï¼š</li></ul><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> SwiftUI</span><br><span class="line"><span class="keyword">import</span> SwiftData</span><br><span class="line"><span class="keyword">import</span> UniformTypeIdentifiers</span><br><span class="line"></span><br><span class="line"><span class="keyword">@main</span></span><br><span class="line"><span class="keyword">private</span> <span class="keyword">struct</span> <span class="title class_">WhatsNew2023</span>: <span class="title class_">App</span> &#123;</span><br><span class="line">    <span class="keyword">var</span> body: <span class="keyword">some</span> <span class="type">Scene</span> &#123;</span><br><span class="line">        <span class="type">DocumentGroup</span>(editing: <span class="type">DogTag</span>.<span class="keyword">self</span>, contentType: .dogTag) &#123;</span><br><span class="line">            <span class="type">ContentView</span>()</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">struct</span> <span class="title class_">ContentView</span>: <span class="title class_">View</span> &#123;</span><br><span class="line">        <span class="keyword">var</span> body: <span class="keyword">some</span> <span class="type">View</span> &#123;</span><br><span class="line">            <span class="type">Color</span>.clear</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Model</span></span><br><span class="line">    <span class="keyword">class</span> <span class="title class_">DogTag</span> &#123;</span><br><span class="line">        <span class="keyword">var</span> text <span class="operator">=</span> <span class="string">&quot;&quot;</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">extension</span> <span class="title class_">UTType</span> &#123;</span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">var</span> dogTag: <span class="type">UTType</span> &#123;</span><br><span class="line">        <span class="type">UTType</span>(exportedAs: <span class="string">&quot;com.apple.SwiftUI.dogTag&quot;</span>)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>æ–‡æ¡£ç¼–è¾‘å™¨ç°è‡ªåŠ¨æ”¯æŒåˆ†äº«å’Œé‡å‘½å</li><li>æ–‡æ¡£ç¼–è¾‘å™¨çš„ toolbar ä¸­é»˜è®¤åŠ å…¥ Undo &amp; Redo</li><li>æ–°çš„ Inspector Viewï¼šç”¨äºä¿®æ”¹é€‰ä¸­å†…å®¹çš„å±æ€§ï¼Œå¹¶èƒ½è‡ªé€‚åº”ä¸åŒå°ºå¯¸çš„è®¾å¤‡</li><li><code>.fileMover</code>ï¼Œ<code>.fileImporter</code>ï¼Œ<code>.fileExporter</code> æ”¯æŒè‡ªå®šä¹‰ Label</li><li><code>.confirmationDialog</code> æ”¯æŒã€Œä¸å†è¯¢é—®ã€ã€ã€Œä¸¥é‡ç­‰çº§ã€</li><li><code>HelpLink</code>ï¼šã€Œå¸®åŠ©ã€æŒ‰é’®</li></ul><h3 id="Table"><a href="#Table" class="headerlink" title="Table"></a>Table</h3><ul><li>æŒä¹…åŒ–è‡ªå®šä¹‰åˆ—</li><li>å¤§çº²è§†å›¾</li><li>ç¨‹åºåŒ–æ§åˆ¶ <code>Section</code> å±•å¼€ä¸å¦</li><li><code>backgroundProminence</code> ä½¿å¾— UI æ›´åŠ çµæ´»ã€æ˜“è¯»</li><li>æ›´å¤šè¡¨æ ¼è‡ªå®šä¹‰é€‰é¡¹ï¼Œä¾‹å¦‚ï¼šå¯éšè—è¡¨å¤´ï¼Œå¯å…³é—­éš”è¡ŒèƒŒæ™¯ç­‰</li></ul><h3 id="Performance"><a href="#Performance" class="headerlink" title="Performance"></a>Performance</h3><p>å¯¹äºå¤§æ•°æ®é›†ï¼ŒSwiftUI çš„æ€§èƒ½æœ‰å¾ˆå¤§æå‡ã€‚</p><p>å…·ä½“çš„è¿™é‡Œæ²¡è¯´ï¼Œåˆ°æ—¶å€™å…³æ³¨ä¸‹ Demystify SwiftUI performance</p><h2 id="ç²¾ç¾çš„åŠ¨ç”»"><a href="#ç²¾ç¾çš„åŠ¨ç”»" class="headerlink" title="ç²¾ç¾çš„åŠ¨ç”»"></a>ç²¾ç¾çš„åŠ¨ç”»</h2><p><img src="/img/wwdc-23-whats-new-in-swiftui/advanced-animation-swiftui.jpeg"></p><p><img src="/img/wwdc-23-whats-new-in-swiftui/advanced-animation.gif"></p><h3 id="å…³é”®å¸§åŠ¨ç”»"><a href="#å…³é”®å¸§åŠ¨ç”»" class="headerlink" title="å…³é”®å¸§åŠ¨ç”»"></a>å…³é”®å¸§åŠ¨ç”»</h3><p>å¯ä»¥åˆ†åˆ«å¯¹å¤šä¸ªå±æ€§æ·»åŠ å¤šä¸ªå…³é”®å¸§ï¼Œå¹¶æŒ‡å®šæ¯ä¸€æ®µçš„åŠ¨ç”»æ›²çº¿</p><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> SwiftUI</span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">KeyframeAnimator_Snippet</span>: <span class="title class_">View</span> &#123;</span><br><span class="line">    <span class="keyword">var</span> body: <span class="keyword">some</span> <span class="type">View</span> &#123;</span><br><span class="line">        <span class="type">Logo</span>(color: .blue)</span><br><span class="line">        <span class="type">Text</span>(<span class="string">&quot;Tap the shape&quot;</span>)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">Logo</span>: <span class="title class_">View</span> &#123;</span><br><span class="line">    <span class="keyword">var</span> color: <span class="type">Color</span></span><br><span class="line">    <span class="meta">@State</span> <span class="keyword">private</span> <span class="keyword">var</span> runPlan <span class="operator">=</span> <span class="number">0</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">var</span> body: <span class="keyword">some</span> <span class="type">View</span> &#123;</span><br><span class="line">        <span class="type">VStack</span>(spacing: <span class="number">100</span>) &#123;</span><br><span class="line">            <span class="type">KeyframeAnimator</span>(</span><br><span class="line">                initialValue: <span class="type">AnimationValues</span>(), trigger: runPlan</span><br><span class="line">            ) &#123; values <span class="keyword">in</span></span><br><span class="line">                <span class="type">LogoField</span>(color: color)</span><br><span class="line">                    .scaleEffect(values.scale)</span><br><span class="line">                    .rotationEffect(values.rotation, anchor: .bottom)</span><br><span class="line">                    .offset(y: values.verticalTranslation)</span><br><span class="line">                    .frame(width: <span class="number">240</span>, height: <span class="number">240</span>)</span><br><span class="line">            &#125; keyframes: &#123; <span class="keyword">_</span> <span class="keyword">in</span></span><br><span class="line">                <span class="type">KeyframeTrack</span>(\.verticalTranslation) &#123;</span><br><span class="line">                    <span class="type">SpringKeyframe</span>(<span class="number">30</span>, duration: <span class="number">0.25</span>, spring: .smooth)</span><br><span class="line">                    <span class="type">CubicKeyframe</span>(<span class="operator">-</span><span class="number">120</span>, duration: <span class="number">0.3</span>)</span><br><span class="line">                    <span class="type">CubicKeyframe</span>(<span class="operator">-</span><span class="number">120</span>, duration: <span class="number">0.5</span>)</span><br><span class="line">                    <span class="type">CubicKeyframe</span>(<span class="number">10</span>, duration: <span class="number">0.3</span>)</span><br><span class="line">                    <span class="type">SpringKeyframe</span>(<span class="number">0</span>, spring: .bouncy)</span><br><span class="line">                &#125;</span><br><span class="line"></span><br><span class="line">                <span class="type">KeyframeTrack</span>(\.scale) &#123;</span><br><span class="line">                    <span class="type">SpringKeyframe</span>(<span class="number">0.98</span>, duration: <span class="number">0.25</span>, spring: .smooth)</span><br><span class="line">                    <span class="type">SpringKeyframe</span>(<span class="number">1.2</span>, duration: <span class="number">0.5</span>, spring: .smooth)</span><br><span class="line">                    <span class="type">SpringKeyframe</span>(<span class="number">1.0</span>, spring: .bouncy)</span><br><span class="line">                &#125;</span><br><span class="line"></span><br><span class="line">                <span class="type">KeyframeTrack</span>(\.rotation) &#123;</span><br><span class="line">                    <span class="type">LinearKeyframe</span>(<span class="type">Angle</span>(degrees:<span class="number">0</span>), duration: <span class="number">0.45</span>)</span><br><span class="line">                    <span class="type">CubicKeyframe</span>(<span class="type">Angle</span>(degrees: <span class="number">0</span>), duration: <span class="number">0.1</span>)</span><br><span class="line">                    <span class="type">CubicKeyframe</span>(<span class="type">Angle</span>(degrees: <span class="operator">-</span><span class="number">15</span>), duration: <span class="number">0.1</span>)</span><br><span class="line">                    <span class="type">CubicKeyframe</span>(<span class="type">Angle</span>(degrees: <span class="number">15</span>), duration: <span class="number">0.1</span>)</span><br><span class="line">                    <span class="type">CubicKeyframe</span>(<span class="type">Angle</span>(degrees: <span class="operator">-</span><span class="number">15</span>), duration: <span class="number">0.1</span>)</span><br><span class="line">                    <span class="type">SpringKeyframe</span>(<span class="type">Angle</span>(degrees: <span class="number">0</span>), spring: .bouncy)</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            .onTapGesture &#123;</span><br><span class="line">                runPlan <span class="operator">+=</span> <span class="number">1</span></span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">struct</span> <span class="title class_">AnimationValues</span> &#123;</span><br><span class="line">        <span class="keyword">var</span> scale <span class="operator">=</span> <span class="number">1.0</span></span><br><span class="line">        <span class="keyword">var</span> verticalTranslation <span class="operator">=</span> <span class="number">0.0</span></span><br><span class="line">        <span class="keyword">var</span> rotation <span class="operator">=</span> <span class="type">Angle</span>(degrees: <span class="number">0.0</span>)</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">struct</span> <span class="title class_">LogoField</span>: <span class="title class_">View</span> &#123;</span><br><span class="line">        <span class="keyword">var</span> color: <span class="type">Color</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">var</span> body: <span class="keyword">some</span> <span class="type">View</span> &#123;</span><br><span class="line">            <span class="type">ZStack</span>(alignment: .bottom) &#123;</span><br><span class="line">                <span class="type">RoundedRectangle</span>(cornerRadius: <span class="number">48</span>)</span><br><span class="line">                    .fill(.shadow(.drop(radius: <span class="number">5</span>)))</span><br><span class="line">                    .fill(color.gradient)</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">#<span class="type">Preview</span> &#123;</span><br><span class="line">    <span class="type">KeyframeAnimator_Snippet</span>()</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="å¤šé˜¶æ®µåŠ¨ç”»"><a href="#å¤šé˜¶æ®µåŠ¨ç”»" class="headerlink" title="å¤šé˜¶æ®µåŠ¨ç”»"></a>å¤šé˜¶æ®µåŠ¨ç”»</h3><p>å¯¹äºå¯æ‹†åˆ†ä¸ºå¤šä¸ªé˜¶æ®µçš„åŠ¨ç”»ï¼Œç›¸è¾ƒäºå…³é”®å¸§åŠ¨ç”»ï¼Œå¤šé˜¶æ®µåŠ¨ç”»æ˜¾å¾—æ›´åŠ ç®€å•ï¼Œåœ¨è¿™é‡Œå¯ä»¥è®¾ç½®æ¯ä¸ªé˜¶æ®µå¯¹åº”çš„åŠ¨ç”»æ–¹æ¡ˆã€‚</p><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> SwiftUI</span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">PhaseAnimator_Snippet</span>: <span class="title class_">View</span> &#123;</span><br><span class="line">    <span class="meta">@State</span> <span class="keyword">private</span> <span class="keyword">var</span> sightingCount <span class="operator">=</span> <span class="number">0</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">var</span> body: <span class="keyword">some</span> <span class="type">View</span> &#123;</span><br><span class="line">        <span class="type">VStack</span> &#123;</span><br><span class="line">            <span class="type">Spacer</span>()</span><br><span class="line">            <span class="type">HappyDog</span>()</span><br><span class="line">                .phaseAnimator(</span><br><span class="line">                    <span class="type">SightingPhases</span>.allCases, trigger: sightingCount</span><br><span class="line">                ) &#123; content, phase <span class="keyword">in</span></span><br><span class="line">                    content</span><br><span class="line">                        .rotationEffect(phase.rotation)</span><br><span class="line">                        .scaleEffect(phase.scale)</span><br><span class="line">                &#125; animation: &#123; phase <span class="keyword">in</span></span><br><span class="line">                    <span class="keyword">switch</span> phase &#123;</span><br><span class="line">                    <span class="keyword">case</span> .shrink: .snappy(duration: <span class="number">0.1</span>)</span><br><span class="line">                    <span class="keyword">case</span> .spin: .bouncy</span><br><span class="line">                    <span class="keyword">case</span> .grow: .spring(</span><br><span class="line">                        duration: <span class="number">0.2</span>, bounce: <span class="number">0.1</span>, blendDuration: <span class="number">0.1</span>)</span><br><span class="line">                    <span class="keyword">case</span> .reset: .linear(duration: <span class="number">0.0</span>)</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">                .sensoryFeedback(.increase, trigger: sightingCount)</span><br><span class="line">            <span class="type">Spacer</span>()</span><br><span class="line">            <span class="type">Button</span>(<span class="string">&quot;Thereâ€™s One!&quot;</span>, action: recordSighting)</span><br><span class="line">                .zIndex(<span class="operator">-</span><span class="number">1.0</span>)</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">func</span> <span class="title function_">recordSighting</span>() &#123;</span><br><span class="line">        sightingCount <span class="operator">+=</span> <span class="number">1</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">enum</span> <span class="title class_">SightingPhases</span>: <span class="title class_">CaseIterable</span> &#123;</span><br><span class="line">        <span class="keyword">case</span> reset</span><br><span class="line">        <span class="keyword">case</span> shrink</span><br><span class="line">        <span class="keyword">case</span> spin</span><br><span class="line">        <span class="keyword">case</span> grow</span><br><span class="line"></span><br><span class="line">        <span class="keyword">var</span> rotation: <span class="type">Angle</span> &#123;</span><br><span class="line">            <span class="keyword">switch</span> <span class="keyword">self</span> &#123;</span><br><span class="line">            <span class="keyword">case</span> .spin, .grow: <span class="type">Angle</span>(degrees: <span class="number">360</span>)</span><br><span class="line">            <span class="keyword">default</span>: <span class="type">Angle</span>(degrees: <span class="number">0</span>)</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">var</span> scale: <span class="type">Double</span> &#123;</span><br><span class="line">            <span class="keyword">switch</span> <span class="keyword">self</span> &#123;</span><br><span class="line">            <span class="keyword">case</span> .reset: <span class="number">1.0</span></span><br><span class="line">            <span class="keyword">case</span> .shrink: <span class="number">0.75</span></span><br><span class="line">            <span class="keyword">case</span> .spin: <span class="number">0.85</span></span><br><span class="line">            <span class="keyword">case</span> .grow: <span class="number">1.0</span></span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">HappyDog</span>: <span class="title class_">View</span> &#123;</span><br><span class="line">    <span class="keyword">var</span> body: <span class="keyword">some</span> <span class="type">View</span> &#123;</span><br><span class="line">        <span class="type">ZStack</span>(alignment: .center) &#123;</span><br><span class="line">            <span class="type">Rectangle</span>()</span><br><span class="line">                .fill(.blue.gradient)</span><br><span class="line">            <span class="type">Text</span>(<span class="string">&quot;ğŸ¶&quot;</span>)</span><br><span class="line">                .font(.system(size: <span class="number">58</span>))</span><br><span class="line">        &#125;</span><br><span class="line">        .clipShape(.rect(cornerRadius: <span class="number">12</span>))</span><br><span class="line">        .frame(width: <span class="number">96</span>, height: <span class="number">96</span>)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">#<span class="type">Preview</span> &#123;</span><br><span class="line">    <span class="type">PhaseAnimator_Snippet</span>()</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="è§¦è§‰åé¦ˆ"><a href="#è§¦è§‰åé¦ˆ" class="headerlink" title="è§¦è§‰åé¦ˆ"></a>è§¦è§‰åé¦ˆ</h3><p><code>.sensoryFeedback(.increase, trigger: sightingCount)</code></p><p>æ ¹æ®ä¸åŒå¹³å°ä¼šæœ‰ä¸åŒçš„æ•ˆæœï¼Œä½ çœ‹éœ€è¦å‚è€ƒ HIG</p><p>è¯¥ modifier æ˜¯ç”±æ•°æ®é©±åŠ¨çš„ï¼Œå½“æ•°æ®å˜åŒ–æ—¶æ‰ä¼šè§¦å‘ï¼Œæˆ‘ä¹‹å‰ä¹Ÿåšè¿‡ç±»ä¼¼çš„åº“ï¼š<a href="https://github.com/LiYanan2004/SwiftUI-Haptics">SwiftUI-Haptics</a></p><h3 id="è§†è§‰æ•ˆæœ"><a href="#è§†è§‰æ•ˆæœ" class="headerlink" title="è§†è§‰æ•ˆæœ"></a>è§†è§‰æ•ˆæœ</h3><p>åŸºäºä½ç½®çš„åŠ¨ç”»æ•ˆæœï¼Œä¹‹å‰éœ€è¦ç”¨åˆ° <code>GeometryReader</code>ï¼Œä½†ç”±äºå…¶ä¼šå æ®å°½å¯èƒ½å¤§çš„ç©ºé—´ï¼Œå¯èƒ½ä¼šå¯¼è‡´å¾ˆå¤šé—®é¢˜ã€‚</p><p>ä¹‹å‰çš„è§£å†³æ–¹æ¡ˆå¯èƒ½æ˜¯æŠŠ <code>GeometryReader</code> æ”¾åœ¨ <code>.overlay</code> ä¸­ä¿æŒå’Œå…ƒç´ å¤§å°ä½ç½®ä¸€è‡´ã€‚</p><p>åœ¨ SwiftUI 5 ä¸­ï¼Œå¯ä»¥ç›´æ¥ä½¿ç”¨ <code>.visualEffect</code> å³å¯ã€‚</p><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> SwiftUI</span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">DogCircle</span>: <span class="title class_">View</span> &#123;</span><br><span class="line">    <span class="keyword">var</span> dog: <span class="type">Dog</span></span><br><span class="line">    <span class="keyword">var</span> focalPoint: <span class="type">CGPoint</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">var</span> body: <span class="keyword">some</span> <span class="type">View</span> &#123;</span><br><span class="line">        <span class="type">ZStack</span> &#123;</span><br><span class="line">            <span class="type">DogImage</span>(dog: dog)</span><br><span class="line">                .visualEffect &#123; content, geometry <span class="keyword">in</span></span><br><span class="line">                    content</span><br><span class="line">                        .scaleEffect(contentScale(in: geometry))</span><br><span class="line">                        .saturation(contentSaturation(in: geometry))</span><br><span class="line">                        .opacity(contentOpacity(in: geometry))</span><br><span class="line">                &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¯è¯´ï¼Œè¿™ä¸ªæ€è·¯è²Œä¼¼å°±æ˜¯ä¹‹å‰çš„ <code>.overlay</code> + <code>GeometryReader</code>ï¼Œè¿™ä¸ª API åº”è¯¥æ˜¯å¯ä»¥åšå‘åå…¼å®¹çš„ï¼Œæˆ‘ç®€å•å†™äº†ä¸€ä¸ªä½œä¸ºå‚è€ƒã€‚</p><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">extension</span> <span class="title class_">View</span> &#123;</span><br><span class="line">    <span class="keyword">@available</span>(<span class="keyword">macOS</span> <span class="number">11.0</span>, <span class="keyword">iOS</span> <span class="number">14.0</span>, <span class="keyword">watchOS</span> <span class="number">7.0</span>, <span class="keyword">tvOS</span> <span class="number">14.0</span>, <span class="operator">*</span>)</span><br><span class="line">    <span class="meta">@backDeployed</span>(before: macOS <span class="number">14.0</span>, iOS <span class="number">17.0</span>, watchOS <span class="number">10.0</span>, tvOS <span class="number">17.0</span>)</span><br><span class="line">    <span class="meta">@ViewBuilder</span></span><br><span class="line">    <span class="keyword">func</span> <span class="title function_">visualEffect</span>&lt;<span class="type">VisualEffect</span>&gt;(<span class="meta">@ViewBuilder</span> <span class="keyword">_</span> <span class="params">effect</span>: <span class="keyword">@escaping</span> (<span class="keyword">Self</span>, <span class="type">GeometryProxy</span>) -&gt; <span class="type">VisualEffect</span>) -&gt; <span class="keyword">some</span> <span class="type">View</span> <span class="keyword">where</span> <span class="type">VisualEffect</span> : <span class="type">View</span> &#123;</span><br><span class="line">        <span class="keyword">self</span>.hidden().overlay &#123;</span><br><span class="line">            <span class="type">GeometryReader</span> &#123; currentProxy <span class="keyword">in</span></span><br><span class="line">                effect(<span class="keyword">self</span>, currentProxy)</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="æ–‡æœ¬æ ¼å¼åŒ–å¢å¼º"><a href="#æ–‡æœ¬æ ¼å¼åŒ–å¢å¼º" class="headerlink" title="æ–‡æœ¬æ ¼å¼åŒ–å¢å¼º"></a>æ–‡æœ¬æ ¼å¼åŒ–å¢å¼º</h3><p>åœ¨ä¹‹å‰çš„ç‰ˆæœ¬ä¸­ï¼Œå¯ä»¥åœ¨ <code>Text</code> ä¸­åµŒå¥— <code>Text</code> æˆ– <code>Image</code>ï¼Œç±»ä¼¼ <code>Text(&quot;\(Text(&quot;Hello&quot;)) SwiftUI&quot;)</code></p><p>åœ¨ SwiftUI 5.0 ä¸­ï¼Œå¯ä»¥ä½¿ç”¨ <code>Shader</code> æ¥æ ¼å¼åŒ–æ–‡æœ¬ï¼Œå…¶ä¸­ï¼Œ<code>Shader</code> ä½¿ç”¨ Metal API æ„å»º</p><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> SwiftUI</span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">ShaderUse_Snippet</span>: <span class="title class_">View</span> &#123;</span><br><span class="line">    <span class="keyword">var</span> body: <span class="keyword">some</span> <span class="type">View</span> &#123;</span><br><span class="line">        <span class="type">Text</span>(</span><br><span class="line">            <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">            <span class="subst">\(</span></span></span><br><span class="line"><span class="subst"><span class="string">                Text(<span class="string">&quot;Furdinand&quot;</span>)</span></span></span><br><span class="line"><span class="subst"><span class="string">                    .foregroundStyle(stripes)</span></span></span><br><span class="line"><span class="subst"><span class="string">                    .fontWidth(.expanded)</span></span></span><br><span class="line"><span class="subst"><span class="string">            )</span> <span class="subst">\</span></span></span><br><span class="line"><span class="subst"><span class="string"></span>            is a good dog!</span></span><br><span class="line"><span class="string">            &quot;&quot;&quot;</span></span><br><span class="line">        )</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">var</span> stripes: <span class="type">Shader</span> &#123;</span><br><span class="line">        <span class="type">ShaderLibrary</span>.angledFill(</span><br><span class="line">            .float(stripeSpacing),</span><br><span class="line">            .float(stripeAngle),</span><br><span class="line">            .color(.blue)</span><br><span class="line">        )</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="å…¶ä»–"><a href="#å…¶ä»–" class="headerlink" title="å…¶ä»–"></a>å…¶ä»–</h3><ul><li>æ»‘å—ç»„ä»¶å¢åŠ å·¦å³å›¾æ ‡åˆ°åº•å›å¼¹æ•ˆæœï¼ˆç”±æ–°ç‰ˆæœ¬ SF Symbols æ”¯æŒï¼‰</li><li>SF Symbol æ–°å¢åŠ¨ç”»æ•ˆæœï¼Œä¾‹å¦‚ï¼šå›å¼¹ã€ç¼©æ”¾ï¼Œè„‰å†²ç­‰<br><img src="/img/wwdc-23-whats-new-in-swiftui/sf-symbols-animation.gif"></li><li><code>.textScale</code> ç®€åŒ–äº† Small Caps çš„å®ç°æ–¹å¼ï¼Œå¯¹äºæ²¡æœ‰ Small Caps æ’ç‰ˆçš„è¯­è¨€æ¥è¯´ï¼Œä¹Ÿèƒ½æ­£å¸¸æ˜¾ç¤ºä¸ºå°æ–‡æœ¬</li><li>å¯¹äºé«˜æ–‡æœ¬ï¼ˆä¾‹å¦‚æ³°è¯­ä¸­çš„ä¸€äº›å­—ç¬¦ï¼‰ï¼Œä½¿ç”¨ <code>.typesettingLanguage</code> æ¥è‡ªåŠ¨ä¼˜åŒ–è¡Œé—´è·</li></ul><blockquote><p>Curt: Iâ€™ve only scratched the surface here. Thereâ€™s even more to discover, from animation completion handlers to building entirely custom animations. I hope you enjoy these APIs as much as I do. </p></blockquote><h2 id="äº¤äº’å¢å¼º"><a href="#äº¤äº’å¢å¼º" class="headerlink" title="äº¤äº’å¢å¼º"></a>äº¤äº’å¢å¼º</h2><p><img src="/img/wwdc-23-whats-new-in-swiftui/enhanced-interaction.jpeg"></p><h3 id="ScrollView"><a href="#ScrollView" class="headerlink" title="ScrollView"></a>ScrollView</h3><ul><li><code>.scrollTransition</code>ï¼šæ„å»ºæ»šåŠ¨æ—¶çš„å…ƒç´ åŠ¨ç”»</li><li><code>.containerRelativeFrame</code>ï¼šåŸºäºå®¹å™¨å°ºå¯¸ç»™å‡ºå…ƒç´ çš„ç›¸å¯¹å¤§å°<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">YourView</span>()</span><br><span class="line">   .containerRelativeFrame(.horizontal, count: <span class="number">5</span>, span: <span class="number">2</span>, spacing: <span class="number">8</span>)</span><br></pre></td></tr></table></figure>æŒ‡å®šå…ƒç´ ç›¸å¯¹å®¹å™¨çš„å¤§å°ï¼Œå°†å®¹å™¨åœ¨æ¨ªå‘åˆ†ä¸º 5 å—ï¼Œæ¯ä¸€ä¸ªå…ƒç´ å æ® 2 å—çš„ä½ç½®ï¼Œå…ƒç´ ä¸å…ƒç´ é—´é—´è·ä¸º 8px</li><li><code>.scrollTargetLayout()</code> å°†å®¹å™¨ä¸­çš„å…ƒç´ ä½œä¸ºä¸€ä¸ªä¸ªç›®æ ‡ï¼Œå…è®¸ä¸€ä¸ªä¸ªæ»šåŠ¨ã€‚</li><li><code>.scrollTargetBehavior</code> æä¾›äº†å¯¹é«˜çº§æ»šåŠ¨è¡Œä¸ºçš„æ§åˆ¶ï¼ŒåŒ…æ‹¬ <code>.paging</code> å’Œ <code>.viewAligned</code></li><li><code>.scrollPosition</code> å¯ä»¥å®æ—¶è·å–åˆ°å¯è§åŒºåŸŸå†…<strong>æœ€ä¸Šé¢</strong>çš„çš„å…ƒç´ çš„ ID</li></ul><h3 id="Image"><a href="#Image" class="headerlink" title="Image"></a>Image</h3><ul><li><code>.allowsDynamicRange(.high)</code>ï¼šHDR æ¸²æŸ“å›¾ç‰‡</li><li>æ›´å¥½çš„è¾…åŠ©åŠŸèƒ½æ”¯æŒï¼Œä¾‹å¦‚ï¼šç¼©æ”¾ç­‰</li></ul><h3 id="Color"><a href="#Color" class="headerlink" title="Color"></a>Color</h3><ul><li>ä»¥æšä¸¾çš„å½¢å¼ä½¿ç”¨è‡ªå®šä¹‰é¢œè‰²ï¼Œä¸ç”¨å†æ‹…å¿ƒ typo-errors äº†</li></ul><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">Color</span>(.deeeepPurple)</span><br></pre></td></tr></table></figure><p><img src="/img/wwdc-23-whats-new-in-swiftui/bundle-color.jpeg"></p><h3 id="æ ·å¼"><a href="#æ ·å¼" class="headerlink" title="æ ·å¼"></a>æ ·å¼</h3><ul><li><code>ControlGroup</code> æ–°å¢ <code>CompactMenu</code> æ ·å¼</li><li><code>Picker</code> æ–°å¢ <code>Palette</code> æ ·å¼</li><li><code>.paletteSelectionEffect</code> ç®€åŒ–äº† Picker ä¸­çš„ â€œé€‰ä¸­&#x2F;æœªé€‰ä¸­â€ çŠ¶æ€æ˜¾ç¤º</li><li>æ–°å¢ <code>ButtonBorderShape.circle</code></li><li>æ–°å¢ <code>.springLoadingBehavior</code>ï¼Œå…è®¸åœ¨ Drag &amp; Drop æ—¶è§¦å‘æ“ä½œ</li><li>tvOS æ”¯æŒ <code>BorderlessButtonStyle</code></li><li>æ–°å¢ <code>.onKeyPress</code> ç”¨ä»¥å“åº”é”®ç›˜è¾“å…¥ &#x2F; å¿«æ·é”®</li></ul><h2 id="å†™åœ¨åé¢"><a href="#å†™åœ¨åé¢" class="headerlink" title="å†™åœ¨åé¢"></a>å†™åœ¨åé¢</h2><p>ä»Šå¹´ SwiftUI çš„æ”¹è¿›è¿˜æ˜¯å¾ˆå¤§çš„ï¼Œæ€»ç»“ä¸€ä¸‹ï¼š</p><ul><li>æ–°çš„é€‚ç”¨å¹³å°</li><li>ä¸ç°æœ‰æ¡†æ¶çš„æ›´å¥½èåˆ</li><li>æ–°çš„æ•°æ®æµç»“æ„ï¼Œ@Observableï¼Œ@Modelï¼ŒSwiftData</li><li>å¯æ§ã€ä¸ªæ€§åŒ–åŠ¨ç”»</li><li>å¤§é‡å…¨æ–° modifiers</li><li>ScrollView å¢å¼º</li><li>â€¦</li></ul><p>è¿™ç¯‡è¿˜å±äºæ˜¯ä¸€äº›çš®æ¯›ï¼Œåé¢è¿˜æœ‰å¾ˆå¤šæ›´åŠ æ·±å…¥çš„ Session æ¥è®¨è®ºå„ä¸ªæ¿å—çš„å†…å®¹ã€‚</p><p>æˆ‘ä»¬ä¸‹æœŸå†ä¼šã€‚ğŸ¤­</p>]]></content>
    
    
    <summary type="html">&lt;p&gt;æœ¬æ–‡ä¸º &lt;a href=&quot;https://developer.apple.com/wwdc23/10148&quot;&gt;Whatâ€™s new in SwiftUI&lt;/a&gt; çš„å­¦ä¹ ç¬”è®°&lt;/p&gt;</summary>
    
    
    
    <category term="æ’¸ä»£ç " scheme="https://liyanan2004.github.io/categories/%E6%92%B8%E4%BB%A3%E7%A0%81/"/>
    
    
    <category term="SwiftUI" scheme="https://liyanan2004.github.io/tags/SwiftUI/"/>
    
    <category term="WWDC 23" scheme="https://liyanan2004.github.io/tags/WWDC-23/"/>
    
  </entry>
  
  <entry>
    <title>ç”¨ Apple Script æ‰“å¼€ä»»åŠ¡æ èœå•</title>
    <link href="https://liyanan2004.github.io/open-menu-bar-extra-with-apple-script/"/>
    <id>https://liyanan2004.github.io/open-menu-bar-extra-with-apple-script/</id>
    <published>2023-05-01T13:50:45.000Z</published>
    <updated>2023-05-01T14:07:51.000Z</updated>
    
    <content type="html"><![CDATA[<p>ï¼ˆæœ¬æ–‡å¤§éƒ¨åˆ†ä¸º ChatGPT ç”Ÿæˆï¼‰</p><p>å¦‚æœä½ æ˜¯ä¸€ä¸ªè‹¹æœç”µè„‘çš„ç”¨æˆ·ï¼Œä½ å¯èƒ½å·²ç»ä¹ æƒ¯äº†ä½¿ç”¨ä»»åŠ¡æ èœå•æ¥å¿«é€Ÿåœ°æ‰“å¼€åº”ç”¨ç¨‹åºå’Œæ‰§è¡Œå…¶ä»–çš„ä»»åŠ¡ã€‚ä½†æ˜¯ï¼Œæœ‰æ—¶å€™ä½ å¯èƒ½ä¼šæ„Ÿåˆ°å¾ˆç¹çï¼Œå› ä¸ºæ¯æ¬¡æ‰“å¼€ä»»åŠ¡æ èœå•éƒ½éœ€è¦é€šè¿‡é¼ æ ‡ç‚¹å‡»æ¥å®Œæˆã€‚ä½†æ˜¯ï¼Œä½ å¯èƒ½ä¸çŸ¥é“çš„æ˜¯ï¼Œä½ å¯ä»¥ä½¿ç”¨Apple Scriptæ¥æ‰“å¼€ä»»åŠ¡æ èœå•ï¼Œå¹¶ä»¥æ›´å¿«çš„æ–¹å¼è®¿é—®å®ƒã€‚</p><p>Apple Script æ˜¯ä¸€ç§ç¼–ç¨‹è¯­è¨€ï¼Œå®ƒå¯ä»¥ç”¨æ¥è‡ªåŠ¨åŒ–å’Œæ§åˆ¶Macç”µè„‘ä¸­çš„å„ç§æ“ä½œã€‚ä½¿ç”¨Apple Scriptï¼Œä½ å¯ä»¥ç¼–å†™è„šæœ¬æ¥æ‰§è¡Œå„ç§ä»»åŠ¡ï¼ŒåŒ…æ‹¬æ‰“å¼€åº”ç”¨ç¨‹åºã€å‘é€ç”µå­é‚®ä»¶ã€è‡ªåŠ¨åŒ–å·¥ä½œæµç¨‹ç­‰ç­‰ã€‚</p><span id="more"></span><h2 id="ç³»ç»Ÿçº§èœå•"><a href="#ç³»ç»Ÿçº§èœå•" class="headerlink" title="ç³»ç»Ÿçº§èœå•"></a>ç³»ç»Ÿçº§èœå•</h2><p>æ‰“å¼€ä»»åŠ¡æ èœå•æ˜¯Apple Scriptçš„ä¸€é¡¹åŸºæœ¬æ“ä½œã€‚ä¸‹é¢æ˜¯ä¸€ä¸ªç®€å•çš„ç¤ºä¾‹è„šæœ¬ï¼Œç”¨äºæ‰“å¼€ä»»åŠ¡æ èœå•ï¼š</p><figure class="highlight applescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">tell</span> <span class="built_in">application</span> <span class="string">&quot;System Events&quot;</span></span><br><span class="line">    <span class="keyword">tell</span> process <span class="string">&quot;SystemUIServer&quot;</span></span><br><span class="line">        click (menu bar <span class="built_in">item</span> <span class="number">1</span> <span class="keyword">of</span> menu bar <span class="number">1</span>)</span><br><span class="line">    <span class="keyword">end</span> <span class="keyword">tell</span></span><br><span class="line"><span class="keyword">end</span> <span class="keyword">tell</span></span><br></pre></td></tr></table></figure><p>åœ¨è¿™ä¸ªè„šæœ¬ä¸­ï¼Œæˆ‘ä»¬ä½¿ç”¨äº†Apple Scriptçš„ tell è¯­å¥ï¼Œå®ƒå…è®¸æˆ‘ä»¬æ§åˆ¶ä¸åŒçš„åº”ç”¨ç¨‹åºå’Œè¿›ç¨‹ã€‚æˆ‘ä»¬é¦–å…ˆä½¿ç”¨ tell è¯­å¥å‘Šè¯‰Apple Scriptè¦æ§åˆ¶çš„åº”ç”¨ç¨‹åºæ˜¯â€œSystem Eventsâ€ã€‚ç„¶åï¼Œæˆ‘ä»¬å†æ¬¡ä½¿ç”¨ tell è¯­å¥å‘Šè¯‰Apple Scriptè¦æ§åˆ¶çš„è¿›ç¨‹æ˜¯â€œSystemUIServerâ€ï¼Œè¿™æ˜¯è´Ÿè´£ä»»åŠ¡æ èœå•çš„è¿›ç¨‹ã€‚</p><p>åœ¨æœ€åä¸€è¡Œä¸­ï¼Œæˆ‘ä»¬ä½¿ç”¨äº† click å‘½ä»¤æ¥æ¨¡æ‹Ÿç‚¹å‡»ä»»åŠ¡æ èœå•ã€‚å…·ä½“æ¥è¯´ï¼Œæˆ‘ä»¬ä½¿ç”¨äº† menu bar item 1 of menu bar 1 è¿™ä¸ªå‘½ä»¤æ¥å®šä½ä»»åŠ¡æ èœå•çš„ä½ç½®ï¼Œå¹¶å°†å…¶ä½œä¸º click å‘½ä»¤çš„å‚æ•°ã€‚</p><p>è¦è¿è¡Œè¿™ä¸ªè„šæœ¬ï¼Œä½ å¯ä»¥å°†å…¶ä¿å­˜åˆ°è„šæœ¬ç¼–è¾‘å™¨ä¸­ï¼Œå¹¶ç‚¹å‡»è¿è¡ŒæŒ‰é’®ã€‚å½“è„šæœ¬è¿è¡Œæ—¶ï¼Œå®ƒä¼šè‡ªåŠ¨æ‰“å¼€ä»»åŠ¡æ èœå•ï¼Œè®©ä½ å¿«é€Ÿè®¿é—®ä½ éœ€è¦çš„åº”ç”¨ç¨‹åºå’ŒåŠŸèƒ½ã€‚</p><p>æ€»çš„æ¥è¯´ï¼Œä½¿ç”¨Apple Scriptæ¥æ‰“å¼€ä»»åŠ¡æ èœå•æ˜¯ä¸€ä¸ªç®€å•è€Œæœ‰æ•ˆçš„æ–¹æ³•ï¼Œå¯ä»¥å¤§å¤§æé«˜ä½ çš„å·¥ä½œæ•ˆç‡ã€‚å¦‚æœä½ æ˜¯ä¸€ä¸ªè‹¹æœç”µè„‘çš„ç”¨æˆ·ï¼Œä¸å¦¨å°è¯•ä½¿ç”¨è¿™ä¸ªè„šæœ¬æ¥è‡ªåŠ¨åŒ–ä½ çš„æ—¥å¸¸æ“ä½œã€‚</p><p>ï¼ˆä»¥ä¸Šæ˜¯ AI ç”Ÿæˆï¼Œæ¥ä¸‹æ¥ï¼Œæˆ‘æ¥è¡¥å……ï¼‰</p><h2 id="ç¬¬ä¸‰æ–¹-App"><a href="#ç¬¬ä¸‰æ–¹-App" class="headerlink" title="ç¬¬ä¸‰æ–¹ App"></a>ç¬¬ä¸‰æ–¹ App</h2><p>å¦‚æœä½ çš„ç³»ç»Ÿæ˜¯ macOS Venturaï¼ˆå…¶ä»–ç³»ç»Ÿçš„ä½ å¯ä»¥å°è¯•ä¸€ä¸‹ï¼‰ï¼Œé‚£ä¹ˆ <code>tell process &quot;SystemUIServer&quot;</code> åªèƒ½è·å–åˆ°ç±»ä¼¼ Siri è¿™ç§çš„ç³»ç»Ÿè¿›ç¨‹ï¼Œ</p><p>ä½†æ˜¯ï¼Œæˆ‘ä»¬çš„ç›®æ ‡è¿œä¸æ­¢å¦‚æ­¤ã€‚</p><p>æƒ³è¦æ§åˆ¶ç¬¬ä¸‰æ–¹appï¼Œå¯ä»¥å‚è€ƒä»¥ä¸‹ä»£ç ï¼ˆä»£ç ç”± ChatGPT ç”Ÿæˆï¼Œå¹¶ä¸”å®æµ‹å¯ä»¥å®ç°æˆ‘ä»¬çš„ç›®æ ‡ï¼‰ï¼š</p><figure class="highlight applescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">tell</span> <span class="built_in">application</span> <span class="string">&quot;System Events&quot;</span></span><br><span class="line">    <span class="keyword">tell</span> process <span class="string">&quot;APPåç§°&quot;</span></span><br><span class="line">        click menu bar <span class="built_in">item</span> <span class="number">1</span> <span class="keyword">of</span> menu bar <span class="number">2</span></span><br><span class="line">        <span class="comment">-- ç‚¹å‡»ç¬¬ä¸€ä¸ªèœå•é¡¹</span></span><br><span class="line">        click menu <span class="built_in">item</span> <span class="number">1</span> <span class="keyword">of</span> menu <span class="number">1</span> <span class="keyword">of</span> menu bar <span class="built_in">item</span> <span class="number">1</span> <span class="keyword">of</span> menu bar <span class="number">2</span></span><br><span class="line">    <span class="keyword">end</span> <span class="keyword">tell</span></span><br><span class="line"><span class="keyword">end</span> <span class="keyword">tell</span></span><br></pre></td></tr></table></figure><blockquote><p>è¿™é‡Œè®°å¾—å§ â€œAPPåç§°â€ æ”¹ä¸‹å³å¯</p><p>è¿™ä¸€éƒ¨åˆ†æˆ‘ç¡®å®æ˜¯ä¸å¤ªä¼šï¼Œé—®çš„ ChatGPTï¼Œå®ƒçœŸçš„èƒ½ç»™æˆ‘æ­£ç¡®çš„ç­”æ¡ˆğŸ˜±</p></blockquote><p>ç†è®ºä¸Šå¦‚æœ App æ˜¯åŸç”Ÿå®ç°çš„ï¼ˆAppKitï¼ŒSwiftUIï¼ŒCatalyst è¿™ç§ï¼‰ï¼Œéƒ½èƒ½ç”¨ Apple Script æ§åˆ¶ï¼Œ</p><p>å¯ä»¥ç”¨ <code>entire contents</code> æ¥æ‰“å°å‡ºæ‰€æœ‰çš„å†…å®¹ï¼Œç„¶åé€ä¸€æŸ¥æ‰¾ï¼Œ</p><p>ç½‘é¡µå¥—å£³çš„ï¼ˆåŸºäº Electron æ¡†æ¶ï¼Œä¾‹å¦‚ï¼šæ–°ç‰ˆQQï¼ŒæŠ–éŸ³ï¼ŒBç«™è¿™ç§ï¼‰å°±ç®—äº†ã€‚</p>]]></content>
    
    
    <summary type="html">&lt;p&gt;ï¼ˆæœ¬æ–‡å¤§éƒ¨åˆ†ä¸º ChatGPT ç”Ÿæˆï¼‰&lt;/p&gt;
&lt;p&gt;å¦‚æœä½ æ˜¯ä¸€ä¸ªè‹¹æœç”µè„‘çš„ç”¨æˆ·ï¼Œä½ å¯èƒ½å·²ç»ä¹ æƒ¯äº†ä½¿ç”¨ä»»åŠ¡æ èœå•æ¥å¿«é€Ÿåœ°æ‰“å¼€åº”ç”¨ç¨‹åºå’Œæ‰§è¡Œå…¶ä»–çš„ä»»åŠ¡ã€‚ä½†æ˜¯ï¼Œæœ‰æ—¶å€™ä½ å¯èƒ½ä¼šæ„Ÿåˆ°å¾ˆç¹çï¼Œå› ä¸ºæ¯æ¬¡æ‰“å¼€ä»»åŠ¡æ èœå•éƒ½éœ€è¦é€šè¿‡é¼ æ ‡ç‚¹å‡»æ¥å®Œæˆã€‚ä½†æ˜¯ï¼Œä½ å¯èƒ½ä¸çŸ¥é“çš„æ˜¯ï¼Œä½ å¯ä»¥ä½¿ç”¨Apple Scriptæ¥æ‰“å¼€ä»»åŠ¡æ èœå•ï¼Œå¹¶ä»¥æ›´å¿«çš„æ–¹å¼è®¿é—®å®ƒã€‚&lt;/p&gt;
&lt;p&gt;Apple Script æ˜¯ä¸€ç§ç¼–ç¨‹è¯­è¨€ï¼Œå®ƒå¯ä»¥ç”¨æ¥è‡ªåŠ¨åŒ–å’Œæ§åˆ¶Macç”µè„‘ä¸­çš„å„ç§æ“ä½œã€‚ä½¿ç”¨Apple Scriptï¼Œä½ å¯ä»¥ç¼–å†™è„šæœ¬æ¥æ‰§è¡Œå„ç§ä»»åŠ¡ï¼ŒåŒ…æ‹¬æ‰“å¼€åº”ç”¨ç¨‹åºã€å‘é€ç”µå­é‚®ä»¶ã€è‡ªåŠ¨åŒ–å·¥ä½œæµç¨‹ç­‰ç­‰ã€‚&lt;/p&gt;</summary>
    
    
    
    <category term="çæŠ˜è…¾" scheme="https://liyanan2004.github.io/categories/%E7%9E%8E%E6%8A%98%E8%85%BE/"/>
    
    
    <category term="Apple Script" scheme="https://liyanan2004.github.io/tags/Apple-Script/"/>
    
  </entry>
  
  <entry>
    <title>WWDC 23 Swift Student Challenge</title>
    <link href="https://liyanan2004.github.io/wwdc-23-swift-student-challenge/"/>
    <id>https://liyanan2004.github.io/wwdc-23-swift-student-challenge/</id>
    <published>2023-04-15T14:14:29.000Z</published>
    <updated>2023-04-23T04:28:35.000Z</updated>
    
    <content type="html"><![CDATA[<p>æœ‰å¹¸åœ¨é«˜ä¸­å°±å‚ä¸è¿‡ WWDC 20 çš„ SSCï¼Œå¯æƒœå½“æ—¶è¯¾ä½™æ—¶é—´å¹¶ä¸å……è£•å¯¼è‡´ä½œå“çš„è´¨é‡å¹¶ä¸ç†æƒ³ï¼Œ</p><p>å¦‚ä»Šï¼Œå†æˆ˜ WWDC 23 SSC ğŸ˜‹</p><span id="more"></span><p>è¯åˆè¯´å›æ¥ï¼Œè¦ä¸æ˜¯å®˜ç½‘å®£å¸ƒ WWDC 23 çš„æ—¶é—´å¹¶å‘å¸ƒäº† SSC æ´»åŠ¨ï¼Œæˆ‘éƒ½å·®ç‚¹å¿˜è®°äº†ğŸ˜‚</p><p>ä½†æ˜¯ï¼Œæˆ‘å·²ä¸æ˜¯ä¸‰å¹´å‰çš„æˆ‘ï¼Œè¿™æ¬¡çš„åˆ¶ä½œå‘¨æœŸéå¸¸ç´§å‡‘ï¼Œä¹Ÿæ¯”è¾ƒé¡ºåˆ©ï¼ŒåŒæ—¶ï¼Œç›¸å¯¹æ¥è¯´ä¹Ÿæ¯”è¾ƒæ»¡æ„ã€‚</p><h2 id="æ—¶å…‰å€’æµï¼ˆ3æœˆ30æ—¥ï¼‰"><a href="#æ—¶å…‰å€’æµï¼ˆ3æœˆ30æ—¥ï¼‰" class="headerlink" title="æ—¶å…‰å€’æµï¼ˆ3æœˆ30æ—¥ï¼‰"></a>æ—¶å…‰å€’æµï¼ˆ3æœˆ30æ—¥ï¼‰</h2><p>æ—©æ™¨èµ·æ¥ï¼Œç„äº†ä¸€çœ¼æ‰‹è¡¨ï¼Œæˆ‘å»â€¦WWDC 23 å®šæ¡£äº†ï¼ï¼</p><p>éå¸¸æ¿€åŠ¨ï¼Œä¹Ÿå¾ˆå¼€å¿ƒï¼ˆå®Œå…¨ä¸è®°å¾—æœ‰ SSCï¼‰ï¼Œç‚¹å¼€å®˜ç½‘ï¼Œä¹ æƒ¯æ€§åœ°ç¿»äº†ç¿»ï¼Œ</p><p>è¯¶ï¼ŒSSCï¼ï¼ï¼è¿˜æ²¡å‡†å¤‡æ€ä¹ˆåŠï¼Ÿï¼ˆæˆ‘é¡¿æ—¶æ„£ä½äº†ï¼Œç«‹é©¬å¼€å§‹æ‰¾çµæ„Ÿï¼‰</p><p>å¾ˆå¿«å•Šï¼Œæœ‰çµæ„Ÿäº†ï¼ï¼ğŸ¤­</p><blockquote><p>ä»¥ä¸Šéƒ½æ˜¯åºŸè¯ï¼Œä½ å¯ä»¥ä¸çœ‹ï¼ˆå¥½åƒè¯´çš„æœ‰ç‚¹æ™šäº†ğŸ˜‚ï¼‰</p></blockquote><h2 id="çµæ„Ÿ"><a href="#çµæ„Ÿ" class="headerlink" title="çµæ„Ÿ"></a>çµæ„Ÿ</h2><p>SSC æ˜¯è®©å­¦ç”Ÿçˆ±å¥½è€…ä»¬ä½¿ç”¨æå…·åˆ›æ–°çš„æ–¹æ³•æ¥å±•ç°è‡ªå·±çš„ ideasï¼Œ</p><p>ä½¿ç”¨ Playgrounds æäº¤ä½œå“ï¼Œæ”¯æŒè¾ƒæ–°çš„ SDKï¼Œå› æ­¤ä½¿ç”¨æ–°çš„æ¡†æ¶ä¹Ÿèƒ½ä½“ç°å‡ºå¯¹å¼€å‘å›¢é˜Ÿçš„æ”¯æŒï¼ˆæ²¹ç®¡ä¸Šå¬æ¥çš„ï¼‰</p><p>é¦–å…ˆæƒ³åˆ°çš„å°±æ˜¯ <code>Swift Charts</code>ã€‚</p><p>å›¾è¡¨å¯ä»¥ç”¨åœ¨æ•°æ®å¯è§†åŒ–ï¼Œä½†æ˜¯å“ªæ¥é‚£ä¹ˆå¤šçš„æ•°æ®å‘¢ï¼Ÿå¹¶ä¸”æ‰€æœ‰çš„æ ¸å¿ƒè¦ç‚¹è¦åœ¨ä¸‰åˆ†é’Ÿä¹‹å†…è¢«å±•ç°å‡ºæ¥ã€‚</p><p>æˆ‘çªç„¶æƒ³èµ·äº†é«˜æ•°ä¸­çš„ã€Œæ³°å‹’å±•å¼€å¼ã€ï¼Œæ— é™è¶‹è¿‘çš„æ¦‚å¿µå¯ä»¥éå¸¸è½»æ¾çš„é€šè¿‡å›¾è¡¨çš„å¯è§†åŒ–æ¥å±•ç°ã€‚</p><p>åˆæƒ³èµ·äº†ä¸Šå­¦æœŸ C è¯­è¨€è¯¾ç¨‹ä¸­è®©æˆ‘ä»¬å®ç° Ï€ çš„è®¡ç®—ã€‚</p><p>å› æ­¤ï¼Œæœ¬æ¬¡ SSC çš„ä¸»é¢˜å°±å®šä¸ºäº†ã€Œä½¿ç”¨ Swift Charts æ¥å±•ç° Ï€ çš„è®¡ç®—è¿‡ç¨‹ã€ï¼Œåˆ©ç”¨å›¾è¡¨å¯è§†åŒ–å±•ç°å‡ºæ— é™è¶‹è¿‘çš„æ¦‚å¿µã€‚</p><h2 id="Playground-è®¾è®¡"><a href="#Playground-è®¾è®¡" class="headerlink" title="Playground è®¾è®¡"></a>Playground è®¾è®¡</h2><p>æˆ‘å¸Œæœ›å‘å„ä½è¯„å§”å±•ç°å‡ºæˆ‘â€œé«˜è¶…â€çš„ SwiftUI æœ¬é¢†ï¼Œä»å¸ƒå±€åˆ°ç¥å¥‡ç§»åŠ¨ï¼Œå†åˆ°åˆ›æ–°çš„äº¤äº’ï¼Œæœ€ååˆ°åŠ¨ç”»è®¾è®¡ä¸æ§åˆ¶ã€‚</p><p>æˆ‘ä¸ä»…å¸Œæœ›æˆ‘çš„å†…å®¹èƒ½å¤Ÿå¸å¼•è¯„å§”ï¼Œä¹Ÿå¸Œæœ›æˆ‘åˆ¶ä½œçš„åŠ¨ç”»èƒ½å¤Ÿè®©è¯„å§”ä»¬æ„Ÿå—åˆ°æˆ‘å¯¹ SwiftUI çš„çƒ­çˆ±ã€‚</p><p>å› æ­¤ï¼Œæˆ‘è®¾è®¡äº†6ä¸ªåˆ†é¡µã€‚</p><ol><li>æ¬¢è¿é¡µï¼šå±•ç¤º Playground çš„ä¸»é¢˜ã€åŠ¨æ€å›¾æ ‡</li></ol><p><img src="/img/wwdc-23-swift-student-challenge/welcome-page.jpeg"></p><ol start="2"><li>ç›®å½•é¡µï¼šå±•ç¤ºç¥å¥‡ç§»åŠ¨æ•ˆæœï¼ˆæœ‰ç‚¹ä¸ºäº†ç¥å¥‡ç§»åŠ¨è€Œç¥å¥‡ç§»åŠ¨çš„æ„Ÿè§‰ğŸ¤”ï¼‰</li></ol><p><img src="/img/wwdc-23-swift-student-challenge/toc-page.jpeg"></p><ol start="3"><li>ç®€å•æ€è€ƒé¡µï¼šå±•ç¤ºåˆ›æ–°ç‚¹ï¼šåˆ®åˆ®å¡</li></ol><p><img src="/img/wwdc-23-swift-student-challenge/ques-page.jpeg"></p><ol start="4"><li>åŸç†å±•ç¤ºé¡µï¼šå±•ç¤ºæ ¸å¿ƒè¦ç‚¹ï¼ŒSwift Chartsã€åŠ¨ç”»æ§åˆ¶</li></ol><p><img src="/img/wwdc-23-swift-student-challenge/demestify-page.jpeg"></p><ol start="5"><li>å›é¡¾é¡µï¼šå¯å‘æ¥æºäºä¹‹å‰è·å¥–ä½œå“ï¼Œä¸ºäº†å’Œç»“æŸé¡µåŠ¨ç”»é…åˆã€‚</li></ol><p><img src="/img/wwdc-23-swift-student-challenge/quiz-page.jpeg"></p><ol start="6"><li>ç»“æŸé¡µï¼šå±•ç¤ºåŠ¨æ€å›¾æ ‡å’Œäº”å½©çº¸å±‘æ•ˆæœï¼ˆæ²¡é”™ï¼Œå°±æ˜¯ iMessage ä¸­çš„äº”å½©çº¸å±‘ï¼Œç”¨ Canvas å®Œç¾å¤åˆ»äº†ä¸€ä¸ªï¼‰</li></ol><p><img src="/img/wwdc-23-swift-student-challenge/end-page.jpeg"></p><h2 id="å†™åœ¨æœ€å"><a href="#å†™åœ¨æœ€å" class="headerlink" title="å†™åœ¨æœ€å"></a>å†™åœ¨æœ€å</h2><p>å¦‚æœæœ€ç»ˆè·å¥–äº†ï¼ŒPlayground ä¸­æ‰€æœ‰çš„æºç æˆ‘ä¼šå¼€æºåœ¨ GitHubï¼š<a href="https://github.com/LiYanan2004/wwdc-23-ssc">WWDC 23 SSC</a></p><blockquote><p>5æœˆ10å·ä¹‹åé“¾æ¥è¿˜æ˜¾ç¤º 404ï¼Œå°±æ˜¯å¾ˆé—æ†¾æ²¡è·å¥–ï¼Œå†æ¥å†å‰ ğŸ¥¹</p></blockquote><p>äº”å½©çº¸å±‘æ•ˆæœæˆ‘åœ¨è¿‡å¹´é‚£ä¼šå„¿å°±å·²ç»å†™å¥½å¹¶æ”¾åœ¨ <a href="https://github.com/LiYanan2004/ColorfulPaper/">GitHub</a> å¼€æºäº†ï¼Œå¦‚æœä½ æœ‰å…´è¶£å¯ä»¥å»ç ”ç©¶ä¸‹å®ç°åŸç†ã€‚</p>]]></content>
    
    
    <summary type="html">&lt;p&gt;æœ‰å¹¸åœ¨é«˜ä¸­å°±å‚ä¸è¿‡ WWDC 20 çš„ SSCï¼Œå¯æƒœå½“æ—¶è¯¾ä½™æ—¶é—´å¹¶ä¸å……è£•å¯¼è‡´ä½œå“çš„è´¨é‡å¹¶ä¸ç†æƒ³ï¼Œ&lt;/p&gt;
&lt;p&gt;å¦‚ä»Šï¼Œå†æˆ˜ WWDC 23 SSC ğŸ˜‹&lt;/p&gt;</summary>
    
    
    
    <category term="æ’¸ä»£ç " scheme="https://liyanan2004.github.io/categories/%E6%92%B8%E4%BB%A3%E7%A0%81/"/>
    
    
    <category term="SwiftUI" scheme="https://liyanan2004.github.io/tags/SwiftUI/"/>
    
    <category term="WWDC 23" scheme="https://liyanan2004.github.io/tags/WWDC-23/"/>
    
    <category term="Swift Charts" scheme="https://liyanan2004.github.io/tags/Swift-Charts/"/>
    
    <category term="Swift Student Challenge" scheme="https://liyanan2004.github.io/tags/Swift-Student-Challenge/"/>
    
  </entry>
  
  <entry>
    <title>Swift Charts å…¥é—¨ â€”â€” è®¤è¯†å„ç§æ ‡è®°</title>
    <link href="https://liyanan2004.github.io/swift-charts-intro-marks/"/>
    <id>https://liyanan2004.github.io/swift-charts-intro-marks/</id>
    <published>2023-04-06T08:51:31.000Z</published>
    <updated>2023-04-06T12:19:57.000Z</updated>
    
    <content type="html"><![CDATA[<p>æœ€è¿‘åœ¨å­¦ä¹ å’Œä½¿ç”¨ WWDC 22 ä¸Šå…¨æ–°çš„ Swift Chartsï¼Œ</p><p>Swift Charts ä½¿ç”¨ SwiftUI çš„å£°æ˜å¼è¯­æ³•ï¼Œç”¨äºåœ¨ SwiftUI ä¸­æ„å»ºå¯è§†åŒ–å›¾è¡¨ï¼Œä¾¿äºæ•°æ®çš„å¯è§†åŒ–åˆ†æã€‚</p><p>æœ¬æœŸåšå®¢å°†ä¸“æ³¨äº Swift Charts çš„æ ‡è®°å’Œç¬¦å·ã€‚</p><p><img src="/img/swift-charts/animated-charts.gif"></p><span id="more"></span><h2 id="å¼€å§‹åˆ›å»ºå›¾è¡¨"><a href="#å¼€å§‹åˆ›å»ºå›¾è¡¨" class="headerlink" title="å¼€å§‹åˆ›å»ºå›¾è¡¨"></a>å¼€å§‹åˆ›å»ºå›¾è¡¨</h2><p>åœ¨æ­£å¼å¼€å§‹åˆ›å»ºå›¾è¡¨ä¹‹å‰ï¼Œéœ€è¦å…ˆå»ºç«‹ä¸€ä¸ªå›¾è¡¨åŒºåŸŸã€‚</p><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> Charts</span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">ChartView</span>: <span class="title class_">View</span> &#123;</span><br><span class="line">    <span class="keyword">var</span> body: <span class="keyword">some</span> <span class="type">View</span> &#123;</span><br><span class="line">        <span class="type">Chart</span> &#123;</span><br><span class="line">            <span class="comment">// ... </span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>Marks éœ€è¦è¢«æ”¾ç½®åœ¨ Charts å†…ä½œä¸ºå…ƒç´ ã€‚</p><p>å½“æœ‰å¤šä¸ª Marks é‡å æ—¶ï¼Œå…¶è¡¨ç°å½¢å¼ç±»ä¼¼äº <code>ZStack</code>ã€‚</p><p>ä½ å¯ä»¥åœ¨åˆ›å»º Chart æ—¶ç›´æ¥å¯¼å…¥æ•°æ®ï¼Œä¹Ÿå¯ä»¥åœ¨ Chart å†…ä½¿ç”¨ <code>ForEach</code> æ¥å¯¼å…¥æ•°æ®ã€‚</p><h2 id="æ ‡è®°ï¼ˆMarkï¼‰"><a href="#æ ‡è®°ï¼ˆMarkï¼‰" class="headerlink" title="æ ‡è®°ï¼ˆMarkï¼‰"></a>æ ‡è®°ï¼ˆMarkï¼‰</h2><h3 id="LineMark"><a href="#LineMark" class="headerlink" title="LineMark"></a>LineMark</h3><p>å¤šä¸ªç‚¹è¿æˆä¸€æ¡çº¿ï¼Œç®€å•ç›´æ¥ã€‚</p><p><img src="/img/swift-charts/line-mark.png"></p><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> SwiftUI</span><br><span class="line"><span class="keyword">import</span> Charts</span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">SunshineChart</span>: <span class="title class_">View</span> &#123;</span><br><span class="line">    <span class="keyword">var</span> body: <span class="keyword">some</span> <span class="type">View</span> &#123;</span><br><span class="line">        <span class="type">Chart</span>(data, id: \.date) &#123;</span><br><span class="line">            <span class="type">LineMark</span>(</span><br><span class="line">                x: .value(<span class="string">&quot;Month&quot;</span>, <span class="variable">$0</span>.date),</span><br><span class="line">                y: .value(<span class="string">&quot;Hours of Sunshine&quot;</span>, <span class="variable">$0</span>.hoursOfSunshine)</span><br><span class="line">            )</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">MonthlyHoursOfSunshine</span>: <span class="title class_">Hashable</span> &#123;</span><br><span class="line">    <span class="keyword">var</span> date: <span class="type">Date</span></span><br><span class="line">    <span class="keyword">var</span> hoursOfSunshine: <span class="type">Double</span></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">init</span>(<span class="params">month</span>: <span class="type">Int</span>, <span class="params">hoursOfSunshine</span>: <span class="type">Double</span>) &#123;</span><br><span class="line">        <span class="keyword">let</span> calendar <span class="operator">=</span> <span class="type">Calendar</span>.autoupdatingCurrent</span><br><span class="line">        <span class="keyword">self</span>.date <span class="operator">=</span> calendar.date(from: <span class="type">DateComponents</span>(year: <span class="number">2023</span>, month: month))<span class="operator">!</span></span><br><span class="line">        <span class="keyword">self</span>.hoursOfSunshine <span class="operator">=</span> hoursOfSunshine</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> data: [<span class="type">MonthlyHoursOfSunshine</span>] <span class="operator">=</span> [</span><br><span class="line">    <span class="type">MonthlyHoursOfSunshine</span>(month: <span class="number">1</span>, hoursOfSunshine: <span class="number">74</span>),</span><br><span class="line">    <span class="type">MonthlyHoursOfSunshine</span>(month: <span class="number">2</span>, hoursOfSunshine: <span class="number">99</span>),</span><br><span class="line">    <span class="type">MonthlyHoursOfSunshine</span>(month: <span class="number">3</span>, hoursOfSunshine: <span class="number">100</span>),</span><br><span class="line">    <span class="type">MonthlyHoursOfSunshine</span>(month: <span class="number">4</span>, hoursOfSunshine: <span class="number">110</span>),</span><br><span class="line">    <span class="type">MonthlyHoursOfSunshine</span>(month: <span class="number">5</span>, hoursOfSunshine: <span class="number">112</span>),</span><br><span class="line">    <span class="type">MonthlyHoursOfSunshine</span>(month: <span class="number">6</span>, hoursOfSunshine: <span class="number">125</span>),</span><br><span class="line">    <span class="type">MonthlyHoursOfSunshine</span>(month: <span class="number">7</span>, hoursOfSunshine: <span class="number">117</span>),</span><br><span class="line">    <span class="type">MonthlyHoursOfSunshine</span>(month: <span class="number">8</span>, hoursOfSunshine: <span class="number">112</span>),</span><br><span class="line">    <span class="type">MonthlyHoursOfSunshine</span>(month: <span class="number">9</span>, hoursOfSunshine: <span class="number">106</span>),</span><br><span class="line">    <span class="type">MonthlyHoursOfSunshine</span>(month: <span class="number">10</span>, hoursOfSunshine: <span class="number">102</span>),</span><br><span class="line">    <span class="type">MonthlyHoursOfSunshine</span>(month: <span class="number">11</span>, hoursOfSunshine: <span class="number">93</span>),</span><br><span class="line">    <span class="type">MonthlyHoursOfSunshine</span>(month: <span class="number">12</span>, hoursOfSunshine: <span class="number">78</span>)</span><br><span class="line">]</span><br></pre></td></tr></table></figure><h3 id="BarMark"><a href="#BarMark" class="headerlink" title="BarMark"></a>BarMark</h3><p>æ¡çŠ¶å›¾ï¼Œå¯ä»¥å¾ˆæ¸…æ™°çš„å±•ç°å‡ºå„ä¸ªé¡¹ç›®çš„æ•°é‡å¤šå°‘ã€‚</p><p><img src="/img/swift-charts/bar-mark.png"></p><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> SwiftUI</span><br><span class="line"><span class="keyword">import</span> Charts</span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">ContentView</span>: <span class="title class_">View</span> &#123;</span><br><span class="line">    <span class="keyword">var</span> body: <span class="keyword">some</span> <span class="type">View</span> &#123;</span><br><span class="line">        <span class="type">Chart</span>(data, id: \.<span class="keyword">self</span>) &#123;</span><br><span class="line">            <span class="type">BarMark</span>(</span><br><span class="line">                x: .value(<span class="string">&quot;Department&quot;</span>, <span class="variable">$0</span>.department),</span><br><span class="line">                y: .value(<span class="string">&quot;Profit&quot;</span>, <span class="variable">$0</span>.profit)</span><br><span class="line">            )</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">Profit</span>: <span class="title class_">Hashable</span> &#123;</span><br><span class="line">    <span class="keyword">let</span> department: <span class="type">String</span></span><br><span class="line">    <span class="keyword">let</span> profit: <span class="type">Double</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> data: [<span class="type">Profit</span>] <span class="operator">=</span> [</span><br><span class="line">    <span class="type">Profit</span>(department: <span class="string">&quot;Production&quot;</span>, profit: <span class="number">15000</span>),</span><br><span class="line">    <span class="type">Profit</span>(department: <span class="string">&quot;Marketing&quot;</span>, profit: <span class="number">8000</span>),</span><br><span class="line">    <span class="type">Profit</span>(department: <span class="string">&quot;Finance&quot;</span>, profit: <span class="number">10000</span>)</span><br><span class="line">]</span><br></pre></td></tr></table></figure><h3 id="PointMark"><a href="#PointMark" class="headerlink" title="PointMark"></a>PointMark</h3><p>ç‚¹æ ‡è®°ï¼Œç”¨äºæ ‡å®šå›¾æ ‡ä¸Šçš„æŸä¸€ä¸ªæˆ–ä¸€ç³»åˆ—ç‚¹ã€‚</p><p><img src="/img/swift-charts/point-mark.png"></p><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> SwiftUI</span><br><span class="line"><span class="keyword">import</span> Charts</span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">SunshineChart</span>: <span class="title class_">View</span> &#123;</span><br><span class="line">    <span class="keyword">var</span> body: <span class="keyword">some</span> <span class="type">View</span> &#123;</span><br><span class="line">        <span class="type">Chart</span>(data, id: \.date) &#123;</span><br><span class="line">            <span class="type">LineMark</span>(</span><br><span class="line">                x: .value(<span class="string">&quot;Month&quot;</span>, <span class="variable">$0</span>.date),</span><br><span class="line">                y: .value(<span class="string">&quot;Hours of Sunshine&quot;</span>, <span class="variable">$0</span>.hoursOfSunshine)</span><br><span class="line">            )</span><br><span class="line">            </span><br><span class="line">            <span class="type">PointMark</span>(</span><br><span class="line">                x: .value(<span class="string">&quot;Month&quot;</span>, <span class="variable">$0</span>.date),</span><br><span class="line">                y: .value(<span class="string">&quot;Hours of Sunshine&quot;</span>, <span class="variable">$0</span>.hoursOfSunshine)</span><br><span class="line">            )</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">// MonthlyHoursOfSunshine &amp; data å’Œ LineMark ä¸­çš„ä¸€è‡´ï¼Œå°±ä¸å†é‡å¤äº†</span></span><br><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="comment">// struct MonthlyHoursOfSunshine &#123; ... &#125;</span></span><br><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="comment">// let data = [ ... ]</span></span><br></pre></td></tr></table></figure><h3 id="RuleMark"><a href="#RuleMark" class="headerlink" title="RuleMark"></a>RuleMark</h3><p>åŸºå‡†æ ‡è®°ï¼Œå°±æ˜¯ä¸€æ¡çº¿ï¼Œå¯ä»¥ç›´è§‚çš„å±•ç°å‡ºä¾‹å¦‚å¹³å‡å€¼ã€æ³¢åŠ¨æƒ…å†µç­‰æ•°æ®ã€‚</p><p><img src="/img/swift-charts/rule-mark.png"></p><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> SwiftUI</span><br><span class="line"><span class="keyword">import</span> Charts</span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">ContentView</span>: <span class="title class_">View</span> &#123;</span><br><span class="line">    <span class="keyword">var</span> body: <span class="keyword">some</span> <span class="type">View</span> &#123;</span><br><span class="line">        <span class="type">Chart</span>(data, id: \.<span class="keyword">self</span>) &#123;</span><br><span class="line">            <span class="type">BarMark</span>(</span><br><span class="line">                x: .value(<span class="string">&quot;Department&quot;</span>, <span class="variable">$0</span>.department),</span><br><span class="line">                y: .value(<span class="string">&quot;Profit&quot;</span>, <span class="variable">$0</span>.profit)</span><br><span class="line">            )</span><br><span class="line">            .opacity(<span class="number">0.3</span>)</span><br><span class="line">            </span><br><span class="line">            <span class="type">RuleMark</span>(y: .value(<span class="string">&quot;Average&quot;</span>, <span class="number">11000</span>))</span><br><span class="line">                .lineStyle(<span class="type">StrokeStyle</span>(lineWidth: <span class="number">3</span>))</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Profit &amp; data å’Œ BarMark ä¸­çš„ä¸€è‡´ï¼Œå°±ä¸å†é‡å¤äº†</span></span><br><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="comment">// struct Profit &#123; ... &#125;</span></span><br><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="comment">// let data = [ ... ]</span></span><br></pre></td></tr></table></figure><h3 id="RectangleMark"><a href="#RectangleMark" class="headerlink" title="RectangleMark"></a>RectangleMark</h3><p>ä¸ PointMark ç±»ä¼¼ï¼Œåªæ˜¯å½¢çŠ¶å˜æˆäº†çŸ©å½¢ã€‚</p><p>å½“ç„¶ï¼Œä»–ä¹Ÿå¯ä»¥è¢«ç”¨æ¥å±•ç¤ºä¸€ä¸ªåŒºåŸŸã€‚</p><p><img src="/img/swift-charts/rectangle-mark.png"></p><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> SwiftUI</span><br><span class="line"><span class="keyword">import</span> Charts</span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">ContentView</span>: <span class="title class_">View</span> &#123;</span><br><span class="line">    <span class="keyword">var</span> body: <span class="keyword">some</span> <span class="type">View</span> &#123;</span><br><span class="line">        <span class="type">Chart</span>(data, id: \.<span class="keyword">self</span>) &#123;</span><br><span class="line">            <span class="type">RectangleMark</span>(</span><br><span class="line">                xStart: .value(<span class="string">&quot;Rect Start Width&quot;</span>, <span class="variable">$0</span>.x <span class="operator">-</span> <span class="number">0.25</span>),</span><br><span class="line">                xEnd: .value(<span class="string">&quot;Rect End Width&quot;</span>, <span class="variable">$0</span>.x <span class="operator">+</span> <span class="number">0.25</span>),</span><br><span class="line">                yStart: .value(<span class="string">&quot;Rect Start Height&quot;</span>, <span class="variable">$0</span>.y <span class="operator">-</span> <span class="number">0.25</span>),</span><br><span class="line">                yEnd: .value(<span class="string">&quot;Rect End Height&quot;</span>, <span class="variable">$0</span>.y <span class="operator">+</span> <span class="number">0.25</span>)</span><br><span class="line">            )</span><br><span class="line">            .opacity(<span class="number">0.2</span>)</span><br><span class="line">            </span><br><span class="line">            <span class="type">PointMark</span>(</span><br><span class="line">                x: .value(<span class="string">&quot;X&quot;</span>, <span class="variable">$0</span>.x),</span><br><span class="line">                y: .value(<span class="string">&quot;Y&quot;</span>, <span class="variable">$0</span>.y)</span><br><span class="line">            )</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">Coord</span>: <span class="title class_">Hashable</span> &#123;</span><br><span class="line">    <span class="keyword">var</span> x: <span class="type">Double</span></span><br><span class="line">    <span class="keyword">var</span> y: <span class="type">Double</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> data: [<span class="type">Coord</span>] <span class="operator">=</span> [</span><br><span class="line">    <span class="type">Coord</span>(x: <span class="number">5</span>, y: <span class="number">5</span>),</span><br><span class="line">    <span class="type">Coord</span>(x: <span class="number">2.5</span>, y: <span class="number">2.5</span>),</span><br><span class="line">    <span class="type">Coord</span>(x: <span class="number">3</span>, y: <span class="number">3</span>)</span><br><span class="line">]</span><br></pre></td></tr></table></figure><h3 id="AreaMark"><a href="#AreaMark" class="headerlink" title="AreaMark"></a>AreaMark</h3><p>é€šè¿‡å¤šä¸ªç‚¹ç»„æˆçº¿ï¼Œå¹¶å¯¹å…¶åŒ…è£¹çš„åŒºåŸŸåšå¡«å……ï¼Œç”¨æ¥å±•ç¤ºæŸä¸€ä¸ªåŒºåŸŸã€‚</p><p>å¦‚æœæ˜¯ç®€å•çš„çŸ©å½¢åŒºåŸŸï¼Œä¹Ÿå¯ä»¥ç›´æ¥ä½¿ç”¨ RectangleMarkã€‚</p><blockquote><p>ä¾‹å¦‚ï¼šå¤©æ°”appä¸­ï¼Œæ¯å¤©çš„æœ€é«˜æ¸©ã€æœ€ä½æ¸©åŒºé—´ã€‚</p></blockquote><p><img src="/img/swift-charts/area-mark.png"></p><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> SwiftUI</span><br><span class="line"><span class="keyword">import</span> Charts</span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">WeatherChart</span>: <span class="title class_">View</span> &#123;</span><br><span class="line">    <span class="keyword">var</span> body: <span class="keyword">some</span> <span class="type">View</span> &#123;</span><br><span class="line">        <span class="type">Chart</span>(data) &#123; day <span class="keyword">in</span></span><br><span class="line">            <span class="type">AreaMark</span>(</span><br><span class="line">                x: .value(<span class="string">&quot;Date&quot;</span>, day.date),</span><br><span class="line">                yStart: .value(<span class="string">&quot;Minimum Temperature&quot;</span>, day.minimumTemperature),</span><br><span class="line">                yEnd: .value(<span class="string">&quot;Maximum Temperature&quot;</span>, day.maximumTemperature)</span><br><span class="line">            )</span><br><span class="line">            .interpolationMethod(.catmullRom)</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">Weather</span>: <span class="title class_">Identifiable</span> &#123;</span><br><span class="line">    <span class="keyword">let</span> date: <span class="type">Date</span></span><br><span class="line">    <span class="keyword">let</span> maximumTemperature: <span class="type">Double</span></span><br><span class="line">    <span class="keyword">let</span> minimumTemperature: <span class="type">Double</span></span><br><span class="line">    <span class="keyword">let</span> id: <span class="type">Int</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> data <span class="operator">=</span> [</span><br><span class="line">    <span class="type">Weather</span>(date: .now, maximumTemperature: <span class="number">20</span>, minimumTemperature: <span class="number">10</span>, id: <span class="number">1</span>),</span><br><span class="line">    <span class="type">Weather</span>(date: .now.addingTimeInterval(<span class="number">24</span> <span class="operator">*</span> <span class="number">60</span> <span class="operator">*</span> <span class="number">60</span>), maximumTemperature: <span class="number">25</span>, minimumTemperature: <span class="number">13</span>, id: <span class="number">2</span>),</span><br><span class="line">    <span class="type">Weather</span>(date: .now.addingTimeInterval(<span class="number">2</span> <span class="operator">*</span> <span class="number">24</span> <span class="operator">*</span> <span class="number">60</span> <span class="operator">*</span> <span class="number">60</span>), maximumTemperature: <span class="number">23</span>, minimumTemperature: <span class="number">12</span>, id: <span class="number">3</span>),</span><br><span class="line">    <span class="type">Weather</span>(date: .now.addingTimeInterval(<span class="number">3</span> <span class="operator">*</span> <span class="number">24</span> <span class="operator">*</span> <span class="number">60</span> <span class="operator">*</span> <span class="number">60</span>), maximumTemperature: <span class="number">24</span>, minimumTemperature: <span class="number">13</span>, id: <span class="number">4</span>),</span><br><span class="line">]</span><br></pre></td></tr></table></figure><h2 id="ç¬¦å·ï¼ˆSymbolï¼‰"><a href="#ç¬¦å·ï¼ˆSymbolï¼‰" class="headerlink" title="ç¬¦å·ï¼ˆSymbolï¼‰"></a>ç¬¦å·ï¼ˆSymbolï¼‰</h2><p>å¦‚æœæ¶‰åŠåˆ°å¤šæ ·æœ¬å¤„ç†ï¼Œä¾‹å¦‚ï¼šæ¯”è¾ƒå¤šä¸ªåŸå¸‚çš„æ°”æ¸©æ›²çº¿ï¼Œ</p><p>ä¸ºäº†è®©å›¾è¡¨çœ‹èµ·æ¥æ›´åŠ ç›´è§‚ï¼Œé€šå¸¸ä¼šä½¿ç”¨ä¸€äº›ç¬¦å·æˆ–è€…é¢œè‰²æ¥åšåŒºåˆ†ã€‚</p><p>æœ‰ä»¥ä¸‹å‡ ç§æ–¹å¼ï¼š</p><h3 id="ä»¥é¢œè‰²åŒºåˆ†ï¼šforegroundStyle"><a href="#ä»¥é¢œè‰²åŒºåˆ†ï¼šforegroundStyle" class="headerlink" title="ä»¥é¢œè‰²åŒºåˆ†ï¼šforegroundStyle"></a>ä»¥é¢œè‰²åŒºåˆ†ï¼šforegroundStyle</h3><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">Chart</span>(data, id: \.date) &#123;</span><br><span class="line">    <span class="type">LineMark</span>(</span><br><span class="line">        x: .value(<span class="string">&quot;Month&quot;</span>, <span class="variable">$0</span>.date),</span><br><span class="line">        y: .value(<span class="string">&quot;Hours of Sunshine&quot;</span>, <span class="variable">$0</span>.hoursOfSunshine)</span><br><span class="line">    )</span><br><span class="line">    .foregroundStyle(.value(<span class="string">&quot;City&quot;</span>, <span class="variable">$0</span>.city))</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="ä»¥å½¢çŠ¶åŒºåˆ†ï¼šsymbol"><a href="#ä»¥å½¢çŠ¶åŒºåˆ†ï¼šsymbol" class="headerlink" title="ä»¥å½¢çŠ¶åŒºåˆ†ï¼šsymbol"></a>ä»¥å½¢çŠ¶åŒºåˆ†ï¼šsymbol</h3><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">Chart</span>(data, id: \.date) &#123;</span><br><span class="line">    <span class="type">LineMark</span>(</span><br><span class="line">        x: .value(<span class="string">&quot;Month&quot;</span>, <span class="variable">$0</span>.date),</span><br><span class="line">        y: .value(<span class="string">&quot;Hours of Sunshine&quot;</span>, <span class="variable">$0</span>.hoursOfSunshine)</span><br><span class="line">    )</span><br><span class="line">    .symbol(.value(<span class="string">&quot;City&quot;</span>, <span class="variable">$0</span>.city))</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>åˆ›å»ºä¹‹ååœ¨å›¾è¡¨å·¦ä¸‹è§’ä¼šå‡ºç° Legendï¼Œ</p><p><img src="/img/swift-charts/legend.png"></p><p>é€šè¿‡ä¸Šè¿°çš„ä¸¤ä¸ª modifiers ä¹Ÿå¯ä»¥è‡ªå®šä¹‰é¢œè‰²å’Œå½¢çŠ¶ï¼Œéƒ½ä¼šå±•ç¤ºåœ¨ Legend ä¸­ã€‚</p><p>å¦‚æœæƒ³éšè— Legendï¼Œå¯ä»¥ä½¿ç”¨ <code>.chartLegend(.hidden)</code></p>]]></content>
    
    
    <summary type="html">&lt;p&gt;æœ€è¿‘åœ¨å­¦ä¹ å’Œä½¿ç”¨ WWDC 22 ä¸Šå…¨æ–°çš„ Swift Chartsï¼Œ&lt;/p&gt;
&lt;p&gt;Swift Charts ä½¿ç”¨ SwiftUI çš„å£°æ˜å¼è¯­æ³•ï¼Œç”¨äºåœ¨ SwiftUI ä¸­æ„å»ºå¯è§†åŒ–å›¾è¡¨ï¼Œä¾¿äºæ•°æ®çš„å¯è§†åŒ–åˆ†æã€‚&lt;/p&gt;
&lt;p&gt;æœ¬æœŸåšå®¢å°†ä¸“æ³¨äº Swift Charts çš„æ ‡è®°å’Œç¬¦å·ã€‚&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;/img/swift-charts/animated-charts.gif&quot;&gt;&lt;/p&gt;</summary>
    
    
    
    <category term="æ’¸ä»£ç " scheme="https://liyanan2004.github.io/categories/%E6%92%B8%E4%BB%A3%E7%A0%81/"/>
    
    
    <category term="SwiftUI" scheme="https://liyanan2004.github.io/tags/SwiftUI/"/>
    
    <category term="Swift Charts" scheme="https://liyanan2004.github.io/tags/Swift-Charts/"/>
    
    <category term="WWDC 22" scheme="https://liyanan2004.github.io/tags/WWDC-22/"/>
    
  </entry>
  
  <entry>
    <title>Magic Keyboard ä½¿ç”¨ä½“éªŒ</title>
    <link href="https://liyanan2004.github.io/magic-keyboard-with-touchid-unbox/"/>
    <id>https://liyanan2004.github.io/magic-keyboard-with-touchid-unbox/</id>
    <published>2023-04-04T06:36:31.000Z</published>
    <updated>2023-04-04T11:48:51.000Z</updated>
    
    <content type="html"><![CDATA[<p>ä¹°äº† Apple Magic Keyboard å·²ç»ä¸€å‘¨å¤šäº†ï¼Œä½“éªŒäº†è‹¹æœçš„ã€Œçº¿ä¸Šä¹°ï¼Œçº¿ä¸‹æã€ï¼Œ</p><p>ç»è¿‡ä¸€ç•ªæŠ˜è…¾ï¼Œåˆä½“éªŒäº†ã€Œ14å¤©æ— ç†ç”±é€€è´§ã€ï¼Œ</p><p>æ¥åˆ†äº«ä¸‹æˆ‘çš„ä½¿ç”¨æ„Ÿå—å’ŒæŠ˜è…¾è¿‡ç¨‹ã€‚</p><span id="more"></span><h2 id="é€‰è´­"><a href="#é€‰è´­" class="headerlink" title="é€‰è´­"></a>é€‰è´­</h2><h3 id="ä¸ºä»€ä¹ˆä¼šä¹°ï¼Ÿ"><a href="#ä¸ºä»€ä¹ˆä¼šä¹°ï¼Ÿ" class="headerlink" title="ä¸ºä»€ä¹ˆä¼šä¹°ï¼Ÿ"></a>ä¸ºä»€ä¹ˆä¼šä¹°ï¼Ÿ</h3><p>ä¸»è¦æ˜¯å› ä¸ºæˆ‘å®¿èˆçš„æ¡Œå­ä¸Šæ”¾äº†ç”µè„‘ä¹‹åï¼Œæ²¡è¶³å¤Ÿç©ºé—´å†™ä½œä¸šäº†ï¼Œä¸€å¼  A4 çº¸éƒ½æ”¾ä¸å¹³ï¼Œ</p><p>äºæ˜¯ï¼Œ</p><p>å°±ä¹°äº†ä¸ªå¢é«˜æ¶ï¼Œç”µè„‘è¢«æŠ¬é«˜äº†ï¼Œé”®ç›˜è§¦æ§æ¿ç”¨èµ·æ¥å°±ä¸é¡ºæ‰‹äº†ï¼Œ</p><p>æ‰€ä»¥ï¼Œå°±è¦é…ä¸€æŠŠé”®ç›˜ã€‚</p><h3 id="ä¸ºä»€ä¹ˆæ˜¯-Magic-Keyboard-å‘¢ï¼Ÿ"><a href="#ä¸ºä»€ä¹ˆæ˜¯-Magic-Keyboard-å‘¢ï¼Ÿ" class="headerlink" title="ä¸ºä»€ä¹ˆæ˜¯ Magic Keyboard å‘¢ï¼Ÿ"></a>ä¸ºä»€ä¹ˆæ˜¯ Magic Keyboard å‘¢ï¼Ÿ</h3><p>å¸‚é¢ä¸Šçš„é”®ç›˜æ™®éè¦ 200+ å·¦å³ï¼Œè´¨é‡å‚å·®ä¸é½ï¼Œ</p><p>åŒæ—¶ï¼Œæˆ‘ä¹Ÿä¸æ˜¯å¾ˆä¹ æƒ¯æœºæ¢°é”®ç›˜çš„æ‰‹æ„Ÿï¼Œ</p><p>è€ƒè™‘åˆ°ä»¥åä¹Ÿå¯èƒ½ä¼šä½¿ç”¨ Mac miniï¼Œ</p><p>äºæ˜¯ï¼Œå°±å†³å®šä¸€æ­¥åˆ°ä½ï¼Œä¹°äº†è¿™æŠŠ Magic Keyboardï¼Œæ„Ÿå—ä¸‹å‰ªåˆ€è„šé”®ç›˜ã€‚</p><p><img src="/img/magic-keyboard-with-touchid-unbox/keyboard.jpeg"></p><h3 id="ä½“éªŒã€Œçº¿ä¸‹æè´§ã€"><a href="#ä½“éªŒã€Œçº¿ä¸‹æè´§ã€" class="headerlink" title="ä½“éªŒã€Œçº¿ä¸‹æè´§ã€"></a>ä½“éªŒã€Œçº¿ä¸‹æè´§ã€</h3><p>è¿™æ˜¯ Apple å»å¹´å¼€å§‹çš„ä¸€ä¸ªæ–°çš„è´­ç‰©é€‰æ‹©ï¼Œè®©ä½ æ›´å¿«åœ°æ‹¿åˆ°äº§å“ã€‚</p><p>Apple Store ä¸‹å•ï¼Œç­‰å¾…é‚®ä»¶æé†’å¯å–è´§ï¼Œå»çº¿ä¸‹å–è´§å°±è¡Œã€‚</p><p>å› ä¸ºå½“ä¸‹ä¸æ˜¯æ–°å“å‘å”®ï¼Œè€Œé”®ç›˜ä¹Ÿæ˜¯å±äºé…ä»¶ä¸€ç±»ï¼Œæ‰€ä»¥ä¸å­˜åœ¨ç¼ºè´§çš„æƒ…å†µã€‚</p><p>ä»æˆ‘åˆ°åº—ï¼Œåˆ°æ‹¿åˆ° Magic Keyboardï¼Œæ•´ä¸ªè¿‡ç¨‹ä¸è¶…è¿‡ 3 åˆ†é’Ÿï¼Œè¿˜æ˜¯éå¸¸è¿…é€Ÿçš„ã€‚</p><p><img src="/img/magic-keyboard-with-touchid-unbox/order-pickup.jpeg"></p><p>è¿…é€Ÿåœ°å®Œæˆäº†é…å¯¹ï¼Œæµ‹è¯•äº†ä¸‹æŒ‰é”®åŠŸèƒ½æ­£å¸¸å°±é«˜é«˜å…´å…´åœ°èµ°äº†ã€‚</p><p><img src="/img/magic-keyboard-with-touchid-unbox/quick-unbox.jpeg"></p><h2 id="æŒ‰é”®æ‰‹æ„Ÿ"><a href="#æŒ‰é”®æ‰‹æ„Ÿ" class="headerlink" title="æŒ‰é”®æ‰‹æ„Ÿ"></a>æŒ‰é”®æ‰‹æ„Ÿ</h2><p>æˆ‘ä¸ªäººæ˜¯æ›´åŠ ä¹ æƒ¯é”®ç¨‹çŸ­çš„è–„è†œé”®ç›˜çš„ï¼Œæ‰“å­—æ—¶æœ‰è‚Œè‚‰è®°å¿†ï¼Œå‡ºé”™æ¦‚ç‡ç›¸å¯¹è¾ƒä½ã€‚</p><p>å‰ªåˆ€è„šé”®ç›˜çš„é”®ç¨‹ç›¸è¾ƒäºè¶å¼é”®ç›˜æ›´é•¿ä¸€äº›äº›ï¼ŒæŒ‰é”®æ‰‹æ„Ÿæ›´è½¯ä¸€äº›ï¼Œæ•´ä½“è¿˜æ˜¯æ¯”è¾ƒèˆ’æœçš„ã€‚</p><p>Touch ID æŒ‰é’®æ˜¯é‚£ç§å¼€å…³çš„æŒ‰é’®çš„æ„Ÿè§‰ï¼ŒæŒ‰ä¸‹éœ€è¦æ¯”å…¶ä»–æŒ‰é”®æ›´å¤§çš„åŠ›æ°”ï¼Œä¸å®¹æ˜“è¯¯è§¦é”å®šã€‚</p><p><img src="/img/magic-keyboard-with-touchid-unbox/touchid-sensor.jpeg" alt="Touch ID Sensor"></p><h2 id="è¿æ¥æ€§èƒ½"><a href="#è¿æ¥æ€§èƒ½" class="headerlink" title="è¿æ¥æ€§èƒ½"></a>è¿æ¥æ€§èƒ½</h2><ul><li>MacBook Pro å¼€ç›–è‡ªåŠ¨ä¼‘çœ åï¼Œä¾ç„¶å¯ä»¥é€šè¿‡é”®ç›˜å”¤é†’ç”µè„‘</li><li>MacBook Pro å¼€æœºæ—¶ç¬¬ä¸€æ¬¡è¾“å…¥å¯†ç æ—¶é”®ç›˜è‡ªåŠ¨è¿æ¥ï¼Œæ— éœ€ç­‰å¾…</li><li>MacBook Pro å¼€ç›–è‡ªåŠ¨å”¤é†’åï¼Œé”®ç›˜ä¿æŒè¿æ¥</li></ul><p>ä½†æ˜¯æœ‰æ—¶ä¼šå‡ºç°æ‰“å­—æ²¡ååº”çš„æƒ…å†µï¼Œç”µè„‘æ˜¾ç¤ºé”®ç›˜å·²è¿æ¥ï¼Œé‡æ–°è¿æ¥åæ¢å¤æ­£å¸¸ã€‚</p><p>å¶å°”çš„ï¼Œä¹Ÿèƒ½ç†è§£ï¼Œæ­£å¸¸ã€‚</p><h2 id="åŠŸèƒ½æŒ‰é”®"><a href="#åŠŸèƒ½æŒ‰é”®" class="headerlink" title="åŠŸèƒ½æŒ‰é”®"></a>åŠŸèƒ½æŒ‰é”®</h2><p>åˆšæ‹¿åˆ° Magic Keyboard çš„æ—¶å€™æ˜¯éœ€è¦ä½¿ç”¨ <code>fn + åŠŸèƒ½æŒ‰é”®</code> æ‰èƒ½è§¦å‘å¯¹åº”åŠŸèƒ½ï¼Œä¸”æœ‰äº›åŠŸèƒ½ï¼ˆå‹¿æ‰°ã€è¯­éŸ³è¾“å…¥ï¼‰æ— æ³•ä½¿ç”¨ã€‚</p><p>åæ¥åœ¨ macOS è®¾ç½®ä¸­æ‰¾åˆ° â€œå°†F1ã€F2ç­‰é”®ç”¨ä½œæ ‡å‡†åŠŸèƒ½é”®â€ï¼Œå…³é—­åæŒ‰é”®å…¨éƒ¨å¯ç”¨ï¼Œå¹¶ä¸”ä¹Ÿä¸éœ€è¦æ­é… fn äº†ã€‚</p><p><img src="/img/magic-keyboard-with-touchid-unbox/func-button-activate.png"></p><h2 id="ç”µæ± ç»­èˆª"><a href="#ç”µæ± ç»­èˆª" class="headerlink" title="ç”µæ± ç»­èˆª"></a>ç”µæ± ç»­èˆª</h2><p>ç¬¬ä¸€æŠŠé”®ç›˜çš„ç»­èˆªå®Œå…¨å°¿å´©ï¼Œæœ€å¤¸å¼ çš„æ˜¯å…³é—­é”®ç›˜ç”µæºåä¸€æ™šä¸Šè€—ç”µ70%ï¼Œä¸å…·å¤‡ä»»ä½•å‚è€ƒä»·å€¼ã€‚</p><p>ç¬¬äºŒæŠŠé”®ç›˜æ­£å¸¸ï¼Œé«˜å¼ºåº¦æ•²äº†ä¸¤å¤©åŠçš„ä»£ç ï¼Œé”®ç›˜ä¿æŒå¼€å¯ï¼Œåªè€—ç”µ3%ã€‚</p><p>èƒ½å¤Ÿè¾¾åˆ°å®£ç§°çš„ã€Œä¸€æ¬¡å……ç”µï¼Œç»­èˆªä¸€ä¸ªæœˆã€</p><blockquote><p>æˆ‘åˆæŠŠæ–°çš„é”®ç›˜å……æ»¡äº†ç”µï¼Œæµ‹æµ‹èƒ½ç”¨å¤šä¹…ã€‚</p></blockquote><h2 id="é€€æ¢è´§ç»å†"><a href="#é€€æ¢è´§ç»å†" class="headerlink" title="é€€æ¢è´§ç»å†"></a>é€€æ¢è´§ç»å†</h2><h3 id="è½»å¾®ç£•ç¢°"><a href="#è½»å¾®ç£•ç¢°" class="headerlink" title="è½»å¾®ç£•ç¢°"></a>è½»å¾®ç£•ç¢°</h3><p>ä»…åœ¨æµ‹è¯•æŒ‰é”®åŠŸèƒ½ï¼Œå’Œç¬¬ä¸€æ¬¡å……ç”µæ—¶æ­å¼€äº†å¤–åŒ…è†œï¼Œä¹ŸåŸºæœ¬æ²¡æœ‰ä½¿ç”¨è¿‡é”®ç›˜ã€‚</p><p>åˆ°å­¦æ ¡åæ— æ„é—´ç”¨æŒ‡ç”²æ„Ÿå—åˆ° Option é”®ä¸‹æ–¹ä¸å¹³ï¼Œæ‰å‘ç°å‡¹è¿›å»ä¸€å—ã€‚</p><p><img src="/img/magic-keyboard-with-touchid-unbox/cosmetic-problem.jpeg"></p><p>å‡ ä¹å¯ä»¥æ’é™¤è®¤ä¸ºé€ æˆï¼Œä½†æ˜¯ï¼Œè¿™ä¸æ˜¯æ¢è´§çš„ä¸»è¦åŸå› ã€‚</p><h3 id="ç»­èˆªé—®é¢˜ã€è´¨é‡é—®é¢˜"><a href="#ç»­èˆªé—®é¢˜ã€è´¨é‡é—®é¢˜" class="headerlink" title="ç»­èˆªé—®é¢˜ã€è´¨é‡é—®é¢˜"></a>ç»­èˆªé—®é¢˜ã€è´¨é‡é—®é¢˜</h3><p>æˆ‘è®¤ä¸ºç¬¬ä¸€æŠŠé”®ç›˜çš„ç”µæ± æ˜¯æœ‰é—®é¢˜çš„ã€‚</p><p>ç¬¬ä¸€æ¬¡è¿æ¥æ—¶ï¼Œç”µæ± æ˜¾ç¤º 0%ï¼Œæˆ‘ä»¥ä¸ºå°±æ˜¯æ­£å¸¸çš„æ²¡ç”µäº†ã€‚</p><p>æ²¡ç”µäº†å……å‘—ã€‚</p><p>å½“æ™šå……æ»¡ç”µï¼Œç¬¬äºŒå¤©æ—©ä¸Šå°±å¸¦å»å­¦æ ¡äº†ï¼Œè¿˜å‰© <strong>27%</strong> ğŸ˜±</p><p>ä¸åˆ° 12 å°æ—¶å•Šï¼Œè€Œä¸”ï¼Œé”®ç›˜çš„å¼€å…³æ˜¯ã€Œå…³é—­ã€çš„çŠ¶æ€ã€‚</p><p>æ¥ä¸‹æ¥çš„å‡ å¤©ï¼Œæˆ‘åˆé’ˆå¯¹æ€§çš„è¿›è¡Œäº†ä¸€äº›è®°å½•ï¼š</p><p><img src="/img/magic-keyboard-with-touchid-unbox/battery-report.jpeg"></p><p>å¯ä»¥çœ‹å‡ºï¼Œæ— è®ºæ˜¯æ‰“å¼€è¿˜æ˜¯å…³é—­é”®ç›˜ç”µæºï¼Œéƒ½æ˜¯æœ‰é—®é¢˜çš„ï¼Œè¿™å°±æ’é™¤äº†æˆ‘ç”µè„‘è¿æ¥ã€å…¼å®¹æ€§çš„é—®é¢˜äº†ã€‚</p><p>è·Ÿ 400 å®¢æœæ²Ÿé€šåï¼Œå»ºè®®æˆ‘æ— ç†ç”±é€€è´§ï¼Œå†ä¹°ä¸€æŠŠæ–°çš„ï¼ˆçº¿ä¸‹ä¸èƒ½ç›´æ¥æ¢è´§ï¼Œå¥½å¥‡æ€ªâ€¦ï¼‰ã€‚</p><p>ä¸è¿‡æ•´ä¸ªæ¢è´§è¿‡ç¨‹è¿˜æ˜¯éå¸¸è½»æ¾æ„‰å¿«çš„ï¼Œåº—å‘˜è¿˜è·Ÿæˆ‘è¯´ï¼Œå¸Œæœ›è¿™æŠŠé”®ç›˜æ²¡é—®é¢˜ğŸ˜‚</p><h2 id="ç»éªŒä¸æ€»ç»“"><a href="#ç»éªŒä¸æ€»ç»“" class="headerlink" title="ç»éªŒä¸æ€»ç»“"></a>ç»éªŒä¸æ€»ç»“</h2><p>æ”¶åˆ°ç¬¬äºŒæŠŠé”®ç›˜åï¼Œæˆ‘ä»”ç»†æ£€æŸ¥äº†å¤–è§‚ï¼Œåˆå§‹ç”µæ± å‰©ä½™å®¹é‡ï¼ˆ95%ï¼‰ã€‚</p><p><img src="/img/magic-keyboard-with-touchid-unbox/new-keyboard.png"></p><p>å›æƒ³èµ·æ¥ï¼Œ2023 å¹´ç”Ÿäº§çš„é”®ç›˜ï¼ˆç›’å­ä¸Šå†™çš„ï¼‰ï¼Œåˆå§‹ç”µé‡ä¸º 0% ç¡®å®ä¸æ­£å¸¸ï¼Œä¸‹æ¬¡ä¹Ÿè¦æ³¨æ„æ£€æŸ¥è¿™ä¸€éƒ¨åˆ†ã€‚</p><p><strong>å¯¹äº é“é‡‘å± ä¸” æœ‰æ£±è§’çš„å¤–å£³ï¼Œç”¨æŒ‡ç”²æ¥æ£€æŸ¥æ˜¯å¦å¹³æ•´ï¼Œé¿å…åˆå§‹ç£•ç¢°ï¼ˆè¿™ç§é—®é¢˜å¾ˆéš¾è¯æ˜ä¸æ˜¯åæœŸäººä¸ºé€ æˆï¼‰</strong></p><p>æ€»çš„æ¥è¯´ï¼Œæˆ‘ä»ç„¶å–œæ¬¢è¿™æŠŠé”®ç›˜ï¼Œå–œæ¬¢åœ¨ Apple è´­ç‰©çš„ä½“éªŒï¼Œ</p><p>æ²¡æœ‰ä»€ä¹ˆåºŸè¯ï¼Œä¸è·Ÿä½ æ‰¯çš®ï¼Œè¯¥æ¢å°±æ¢ï¼Œå¾ˆå–œæ¬¢è¿™æ ·çš„é£æ ¼ã€‚</p>]]></content>
    
    
    <summary type="html">&lt;p&gt;ä¹°äº† Apple Magic Keyboard å·²ç»ä¸€å‘¨å¤šäº†ï¼Œä½“éªŒäº†è‹¹æœçš„ã€Œçº¿ä¸Šä¹°ï¼Œçº¿ä¸‹æã€ï¼Œ&lt;/p&gt;
&lt;p&gt;ç»è¿‡ä¸€ç•ªæŠ˜è…¾ï¼Œåˆä½“éªŒäº†ã€Œ14å¤©æ— ç†ç”±é€€è´§ã€ï¼Œ&lt;/p&gt;
&lt;p&gt;æ¥åˆ†äº«ä¸‹æˆ‘çš„ä½¿ç”¨æ„Ÿå—å’ŒæŠ˜è…¾è¿‡ç¨‹ã€‚&lt;/p&gt;</summary>
    
    
    
    <category term="æ–°ç©å…·" scheme="https://liyanan2004.github.io/categories/%E6%96%B0%E7%8E%A9%E5%85%B7/"/>
    
    
    <category term="Magic Keyboard" scheme="https://liyanan2004.github.io/tags/Magic-Keyboard/"/>
    
  </entry>
  
  <entry>
    <title>æç¬‘ä½“è‚² ä¹‹ è·‘æ­¥æ˜¯ä¸å¯èƒ½è·‘æ­¥çš„</title>
    <link href="https://liyanan2004.github.io/hack-college-sport/"/>
    <id>https://liyanan2004.github.io/hack-college-sport/</id>
    <published>2023-03-13T12:42:25.000Z</published>
    <updated>2023-03-13T14:20:18.000Z</updated>
    
    <content type="html"><![CDATA[<p>ä¼—æ‰€å‘¨çŸ¥ï¼Œé«˜æ ¡ä½“è‚²å°±æ˜¯ä¸€å¨â€¦</p><p>ä¸”ä¸è¯´åŠŸèƒ½å¦‚ä½•ï¼Œ</p><p>ä½ ä¸€ä¸ªç»™å¤§å­¦ç”Ÿç”¨çš„â€œè¿åŠ¨â€è½¯ä»¶ï¼Œ</p><p>å¼€å±ä¸€å¤§å †å¹¿å‘Šï¼Œæ‰‹æœºåŠ¨ä¸€ä¸‹å°±ä¹±è·³appï¼Œ</p><p>è·‘ä¸ªæ­¥è¿˜ä¸å¿˜ç»™æˆ‘æ‰“å¹¿å‘Šï¼Œä»å¤´æ‰“åˆ°å°¾ï¼ŒçœŸç‰›â€¦</p><p>å‚»*è½¯ä»¶ï¼Œåƒåƒå¤ªéš¾çœ‹ï¼</p><p><img src="/img/hack-college-sport/full-ads.jpeg"></p><p>è·‘ä¸ªæ­¥è¿˜è¦æ‰“å¡ç‚¹ä½ï¼ŒçœŸçš„æ¶å¿ƒï¼Œä½†æ˜¯ï¼Œè·‘æ­¥æ˜¯è‚¯å®šä¸ä¼šè·‘çš„å•¦ï½</p><span id="more"></span><h1 id="æµç¨‹åˆ†æ"><a href="#æµç¨‹åˆ†æ" class="headerlink" title="æµç¨‹åˆ†æ"></a>æµç¨‹åˆ†æ</h1><p>å¯¹ APP çš„ç½‘ç»œè¯·æ±‚è¿›è¡Œä¸€ç•ªæŠ“åŒ…ï¼Œæ•´ä¸ªæµç¨‹æ¯”è¾ƒç®€å•ï¼š</p><ol><li>æ‰‹æœºç‚¹å‡»å¼€å§‹ä½“è‚²é”»ç‚¼è·‘ï¼ŒAPP å‘é€ä¸€ä¸ªè¯·æ±‚</li><li>æœåŠ¡å™¨è¿”å›å½“å‰è·‘æ­¥çš„ RunPageID å’Œéœ€è¦ç»è¿‡çš„ç‚¹ä½ä¿¡æ¯</li><li>å¼€è·‘ï¼Œè®°å¾—è¦æ»¡è¶³è·‘æ­¥è¦æ±‚ï¼ˆ2å…¬é‡Œ + 3ä¸ªç‚¹ï¼‰</li><li>å®Œæˆè·‘æ­¥ä¹‹åï¼Œå°†é€”å¾„çš„ä¸€ä¸ªä¸ªé‡‡æ ·ç‚¹è¿›è¡Œå¤„ç†ï¼Œä¸€å¹¶å‘ç»™æœåŠ¡å™¨ï¼Œå®Œæˆè·‘æ­¥è®°å½•ä¸ŠæŠ¥ä¿å­˜ã€‚</li></ol><h1 id="ä¸€äº›ç»†èŠ‚"><a href="#ä¸€äº›ç»†èŠ‚" class="headerlink" title="ä¸€äº›ç»†èŠ‚"></a>ä¸€äº›ç»†èŠ‚</h1><ul><li>æ‰€æœ‰è¯·æ±‚å‡ä»¥ POST æ–¹å¼å‘é€</li><li>æ‰€æœ‰è¯·æ±‚çš„ body ä¸­çš„å‡å«æœ‰ sign ç”¨äºæ ¡éªŒï¼Œä½¿ç”¨çš„æ˜¯ MD5 ç”Ÿæˆå“ˆå¸Œå€¼</li></ul><h1 id="æ•°æ®ç»“æ„"><a href="#æ•°æ®ç»“æ„" class="headerlink" title="æ•°æ®ç»“æ„"></a>æ•°æ®ç»“æ„</h1><p>åœ¨æ¯ä¸€ä¸ªè¯·æ±‚çš„ body ä¸­çš„æ•°æ®ç»“æ„é•¿è¿™æ ·ï¼š<code>data=[JSON Data]&amp;sign=[MD5 Hash]</code></p><h2 id="å¼€å§‹è·‘æ­¥"><a href="#å¼€å§‹è·‘æ­¥" class="headerlink" title="å¼€å§‹è·‘æ­¥"></a>å¼€å§‹è·‘æ­¥</h2><p>URLï¼š <code>https://www.sportcampus.cn/api/run/runPage</code></p><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">[</span><br><span class="line">  <span class="string">&quot;initLocation&quot;</span> : <span class="string">&quot;121.00000,30.00000â€,   // èµ·å§‹ä½ç½®çš„ç»çº¬åº¦</span></span><br><span class="line"><span class="string">          &quot;</span>type<span class="string">&quot; : &quot;</span><span class="number">1</span><span class="string">&quot;,                    // ä¸çŸ¥é“ä»€ä¹ˆå«ä¹‰</span></span><br><span class="line"><span class="string">        &quot;</span>userid<span class="string">&quot; : &quot;</span><span class="number">1234567</span><span class="string">&quot;               // å½“å‰ç”¨æˆ·çš„ ID</span></span><br><span class="line"><span class="string">]</span></span><br></pre></td></tr></table></figure><p>æœåŠ¡å™¨è¿”å›çš„ JSON ä¸­ï¼Œ<code>ibeacon</code> å’Œ <code>gpsinfo</code>åˆ†åˆ«å¯¹åº” å¿…ç»ç‚¹ğŸ”´ å’Œ é€”å¾„ç‚¹ğŸŸ¢</p><p>ibeacon ä¸­å…³é”®ä¿¡æ¯æ˜¯ majorã€minorå’Œuuidï¼Œåç»­ä¿å­˜è·‘æ­¥è®°å½•æ˜¯ä¼šç”¨åˆ°ã€‚</p><p>gpsinfo å°±æ˜¯ç®€å•çš„å­—å…¸ï¼ŒåŒ…å« <code>latitude</code> å’Œ <code>longitude</code>ã€‚</p><h2 id="ç»“æŸè·‘æ­¥"><a href="#ç»“æŸè·‘æ­¥" class="headerlink" title="ç»“æŸè·‘æ­¥"></a>ç»“æŸè·‘æ­¥</h2><p>URLï¼š<code>https://www.sportcampus.cn/api/run/saveRunV2</code></p><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">[</span><br><span class="line">      <span class="string">&quot;endTime&quot;</span> : <span class="string">&quot;2023-3-13 14:50:39&quot;</span>,</span><br><span class="line">    <span class="string">&quot;startTime&quot;</span> : <span class="string">&quot;2023-3-13 14:38:15&quot;</span>,</span><br><span class="line">       <span class="string">&quot;userid&quot;</span> : <span class="string">&quot;1234567&quot;</span>, </span><br><span class="line">         <span class="string">&quot;goal&quot;</span> : <span class="string">&quot;2.00&quot;</span>,</span><br><span class="line">         <span class="string">&quot;type&quot;</span> : <span class="number">1</span>,</span><br><span class="line">       <span class="string">&quot;frombp&quot;</span> : <span class="number">0</span>,</span><br><span class="line">    <span class="string">&quot;runPageId&quot;</span> : pageID,</span><br><span class="line">        <span class="string">&quot;buPin&quot;</span> : <span class="string">&quot;100&quot;</span>,</span><br><span class="line">        <span class="string">&quot;speed&quot;</span> : <span class="string">&quot;6&#x27;13<span class="subst">\&quot;</span>&quot;</span>,</span><br><span class="line">         <span class="string">&quot;real&quot;</span> : <span class="string">&quot;300&quot;</span>,                      <span class="comment">// è·ç¦»ï¼Œå•ä½ï¼ˆç±³ï¼‰</span></span><br><span class="line">     <span class="string">&quot;duration&quot;</span> : <span class="string">&quot;658&quot;</span>,                      <span class="comment">// æ—¶å¸¸ï¼Œå•ä½ï¼ˆç§’ï¼‰</span></span><br><span class="line">        <span class="string">&quot;track&quot;</span> : [],                         <span class="comment">// è·‘æ­¥è¿‡ç¨‹ä¸­ GPS é‡‡æ ·ç‚¹</span></span><br><span class="line">        <span class="string">&quot;bNode&quot;</span> : bNode,                      <span class="comment">// å¿…ç»ç‚¹æ•°æ®ğŸ”´</span></span><br><span class="line">        <span class="string">&quot;tNode&quot;</span> : tNode,                      <span class="comment">// é€”å¾„ç‚¹æ•°æ®ğŸŸ¢</span></span><br><span class="line">     <span class="string">&quot;totalNum&quot;</span> : <span class="string">&quot;1024&quot;</span>,                     <span class="comment">// æ­¥æ•°</span></span><br><span class="line">        <span class="string">&quot;trend&quot;</span> : [[<span class="string">&quot;x&quot;</span> : <span class="string">&quot;0&quot;</span>, <span class="string">&quot;y&quot;</span> : <span class="string">&quot;0&quot;</span>]]</span><br><span class="line">]</span><br></pre></td></tr></table></figure><p>è¿™é‡Œåªè¦ç»™é€Ÿåº¦ç”Ÿæˆä¸€ä¸ªéšæœºæ•°ï¼Œå…¶ä»–åŸºæœ¬éƒ½èƒ½ç®—å‡ºæ¥ã€‚</p><p>é€”å¾„ç‚¹ã€å¿…ç»ç‚¹æ‰“å¡å®é™…ä¸Šå°±æ˜¯ bNode å’Œ tNodeï¼ŒæŠŠâ€œæƒ³ç»è¿‡çš„â€ç‚¹ç»™è¿›å»å°±å¥½å•¦ã€‚</p><p>bNode æ˜¯ä¸€ä¸ªå­—å…¸æ•°ç»„ï¼Œå­—å…¸çš„ç»“æ„å¦‚ä¸‹ï¼š</p><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">[</span><br><span class="line">     <span class="string">&quot;major&quot;</span> : <span class="type">String</span>,</span><br><span class="line">     <span class="string">&quot;minor&quot;</span> : <span class="type">String</span>,</span><br><span class="line">     <span class="string">&quot;uuid&quot;</span>  : <span class="type">UUID</span></span><br><span class="line">]</span><br></pre></td></tr></table></figure><p>tNode ç›¸å¯¹ç®€å•ï¼Œä¹Ÿæ˜¯ä¸€ä¸ªå­—å…¸æ•°ç»„ï¼Œç»“æ„å¦‚ä¸‹ï¼š</p><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">[</span><br><span class="line">    <span class="string">&quot;longitude&quot;</span> : <span class="type">String</span>,</span><br><span class="line">     <span class="string">&quot;latitude&quot;</span> : <span class="type">String</span></span><br><span class="line">]</span><br></pre></td></tr></table></figure><p>track æ˜¯é—´éš”ä¸€æ®µæ—¶é—´çš„ GPS é‡‡æ ·ç‚¹ï¼Œä¹Ÿæ˜¯å­—å…¸æ•°ç»„ï¼Œç»“æ„å¦‚ä¸‹ï¼š</p><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">[</span><br><span class="line">        <span class="string">&quot;speed&quot;</span> : <span class="type">String</span>,   <span class="comment">// åº”è¯¥æ˜¯è®°å½•é‡‡æ ·æ—¶çš„é€Ÿåº¦ï¼Œå…·ä½“å•ä½ä¸æ¸…æ¥šï¼Œä¸€èˆ¬è·‘æ­¥åœ¨ 2.0 - 3.0 å·¦å³</span></span><br><span class="line">    <span class="string">&quot;longitude&quot;</span> : <span class="type">String</span>,</span><br><span class="line">     <span class="string">&quot;latitude&quot;</span> : <span class="type">String</span></span><br><span class="line">]</span><br></pre></td></tr></table></figure><h1 id="Sign-çš„è·å–"><a href="#Sign-çš„è·å–" class="headerlink" title="Sign çš„è·å–"></a>Sign çš„è·å–</h1><p>åœ¨ GitHub ä¸Šæ‰¾åˆ°äº† Python çš„ç‰ˆæœ¬ï¼Œç›´æ¥æ‹¿åˆ°äº† keyï¼Œ</p><p>å€ŸåŠ© <a href="https://github.com/LiYanan2004/ChatBot">ChatBot</a> å¾—åˆ°äº† Swift ç‰ˆæœ¬çš„ MD5 å“ˆå¸Œç”Ÿæˆå‡½æ•°ï¼Œ</p><p>æŠŠ data æ„å»ºå¥½ä¹‹åï¼Œè½¬ä¸º String ä¼ è¿›å»å°±å¥½å•¦ã€‚</p><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> CryptoKit</span><br><span class="line"><span class="keyword">import</span> Foundation</span><br><span class="line"></span><br><span class="line"><span class="keyword">func</span> <span class="title function_">getMD5Code</span>(<span class="keyword">_</span> <span class="params">s</span>: <span class="type">String</span>) -&gt; <span class="type">String</span> &#123;</span><br><span class="line">    <span class="keyword">let</span> key <span class="operator">=</span> <span class="string">&quot;lpKK*TJE8WaIg%93O0pfn0#xS0i3xE$z&quot;</span></span><br><span class="line">    <span class="keyword">let</span> message <span class="operator">=</span> key <span class="operator">+</span> <span class="string">&quot;data&quot;</span> <span class="operator">+</span> s</span><br><span class="line">    <span class="keyword">let</span> data <span class="operator">=</span> <span class="type">Data</span>(message.utf8)</span><br><span class="line">    <span class="keyword">var</span> hasher <span class="operator">=</span> <span class="type">Insecure</span>.<span class="type">MD5</span>()</span><br><span class="line">    hasher.update(data: data)</span><br><span class="line">    <span class="keyword">return</span> hasher.finalize().map &#123; <span class="type">String</span>(format: <span class="string">&quot;%02hhx&quot;</span>, <span class="variable">$0</span>) &#125;.joined()</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1 id="å¦‚ä½•è§„åˆ’è·¯å¾„"><a href="#å¦‚ä½•è§„åˆ’è·¯å¾„" class="headerlink" title="å¦‚ä½•è§„åˆ’è·¯å¾„"></a>å¦‚ä½•è§„åˆ’è·¯å¾„</h1><p>ç­”ï¼šå¾—åˆ°å¿…ç»ç‚¹å’Œé€”å¾„ç‚¹åï¼Œæ‰‹åŠ¨è§„åˆ’ã€‚</p><p>ç”¨ SwiftUI + MapKit åšäº†ä¸€ä¸ª UIï¼Œåœ¨åœ°å›¾ä¸Šæ ‡æ³¨å‡ºå…³é”®ç‚¹ï¼Œ</p><p>æ¥ä¸‹æ¥å°±æ˜¯é¼ æ ‡ç‚¹ç‚¹ç‚¹ï¼</p><p>ç›¸é‚»çš„ä¸¤ä¸ªç‚¹ä¸­é—´ä¼šè¡¥é½æ¥å®ç° â€œGPS é—´éš”é‡‡æ ·â€ï¼Œ</p><p>å½“ç„¶ï¼Œè·‘æ­¥ä¸€å®šä¸ä¼šæ˜¯ç¬”ç¬”ç›´çš„ï¼Œä¹Ÿé€‚å½“çš„å¯¹æ¯ä¸€ä¸ªä¸­é—´ç‚¹åšäº†æ¨ªçºµå‘çš„éšæœºåç§»ã€‚</p><p>ä»éœ€æ³¨æ„çš„æ˜¯ï¼šåœ¨è¿‡æ²³ä»¥åŠè½¬å¼¯æ—¶è¦å°å¿ƒä¸€äº›ğŸ˜‚</p><p><img src="/img/hack-college-sport/route.png"></p><h1 id="è·‘æ­¥æµç¨‹"><a href="#è·‘æ­¥æµç¨‹" class="headerlink" title="è·‘æ­¥æµç¨‹"></a>è·‘æ­¥æµç¨‹</h1><ol><li>ç‚¹å‡»è·‘æ­¥æŒ‰é’®</li><li>è§„åˆ’è·¯çº¿</li><li>ç‚¹å‡»ç»“æŸè·‘æ­¥</li><li>ç­‰å¾…æäº¤â€¦</li></ol><p>èˆ’æœï¼è€¶ï¼è·‘æ­¥æ˜¯ä¸å¯èƒ½è·‘æ­¥çš„å•¦ï½</p><p><img src="/img/hack-college-sport/submit.png"></p><p><em>é¡¹ç›®ä¸å¼€æºï¼Œæ¶‰åŠå¤šæ–¹åˆ©ç›Šä¸åˆä½œï¼Œä»…åœ¨æˆ‘è‡ªå·±ç”µè„‘ä¸Šè¿è¡Œä½¿ç”¨ã€‚</em></p>]]></content>
    
    
    <summary type="html">&lt;p&gt;ä¼—æ‰€å‘¨çŸ¥ï¼Œé«˜æ ¡ä½“è‚²å°±æ˜¯ä¸€å¨â€¦&lt;/p&gt;
&lt;p&gt;ä¸”ä¸è¯´åŠŸèƒ½å¦‚ä½•ï¼Œ&lt;/p&gt;
&lt;p&gt;ä½ ä¸€ä¸ªç»™å¤§å­¦ç”Ÿç”¨çš„â€œè¿åŠ¨â€è½¯ä»¶ï¼Œ&lt;/p&gt;
&lt;p&gt;å¼€å±ä¸€å¤§å †å¹¿å‘Šï¼Œæ‰‹æœºåŠ¨ä¸€ä¸‹å°±ä¹±è·³appï¼Œ&lt;/p&gt;
&lt;p&gt;è·‘ä¸ªæ­¥è¿˜ä¸å¿˜ç»™æˆ‘æ‰“å¹¿å‘Šï¼Œä»å¤´æ‰“åˆ°å°¾ï¼ŒçœŸç‰›â€¦&lt;/p&gt;
&lt;p&gt;å‚»*è½¯ä»¶ï¼Œåƒåƒå¤ªéš¾çœ‹ï¼&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;/img/hack-college-sport/full-ads.jpeg&quot;&gt;&lt;/p&gt;
&lt;p&gt;è·‘ä¸ªæ­¥è¿˜è¦æ‰“å¡ç‚¹ä½ï¼ŒçœŸçš„æ¶å¿ƒï¼Œä½†æ˜¯ï¼Œè·‘æ­¥æ˜¯è‚¯å®šä¸ä¼šè·‘çš„å•¦ï½&lt;/p&gt;</summary>
    
    
    
    <category term="çæŠ˜è…¾" scheme="https://liyanan2004.github.io/categories/%E7%9E%8E%E6%8A%98%E8%85%BE/"/>
    
    
    <category term="hack" scheme="https://liyanan2004.github.io/tags/hack/"/>
    
  </entry>
  
  <entry>
    <title>Selection Range in SwiftUI</title>
    <link href="https://liyanan2004.github.io/swiftui-selection-range/"/>
    <id>https://liyanan2004.github.io/swiftui-selection-range/</id>
    <published>2023-02-12T11:33:00.000Z</published>
    <updated>2023-03-01T10:40:21.000Z</updated>
    
    <content type="html"><![CDATA[<p>åœ¨ SwiftUI ä¸­ï¼Œæ²¡æœ‰æä¾›é»˜è®¤çš„ modifier æ¥ç›‘å¬ <code>TextView</code> çš„ <code>selectionRange</code>ï¼Œ</p><p>è¿™å¯¹äºæ–‡æœ¬ç¼–è¾‘ç±» app æ¥è¯´æ˜¯å¾ˆè‡´å‘½çš„ï¼Œå› ä¸ºæ— æ³•æ§åˆ¶å…‰æ ‡çš„ä½ç½®ï¼Œ</p><p>ä½†æ˜¯å¯ä»¥ä»å…¶ä»–çš„æ–‡ç« ä¸­æ‰¾åˆ°ä¸€äº›æ€è·¯ï¼š</p><ul><li><a href="https://swiftui-lab.com/a-powerful-combo/">The Power of the Hosting+Representable Combo</a></li><li><a href="https://github.com/siteline/SwiftUI-Introspect">siteline&#x2F;SwiftUI-Introspect</a></li></ul><p>å¯»æ‰¾ NSView &#x2F; UIView çš„æ–¹æ³•æ¥æºäºï¼š<a href="https://github.com/siteline/SwiftUI-Introspect">siteline&#x2F;SwiftUI-Introspect</a></p><p>æœ¬æ–‡æ¥ä»‹ç»ä¸€ç§è§£å†³æ–¹æ¡ˆï¼Œå¯ä»¥å®ç°å‡ºä»¥ä¸‹çš„ä»£ç ï¼š</p><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> SwiftUI</span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">Example</span>: <span class="title class_">View</span> &#123;</span><br><span class="line">    <span class="meta">@State</span> <span class="keyword">private</span> <span class="keyword">var</span> selectionRange <span class="operator">=</span> <span class="type">NSRange</span>()</span><br><span class="line">    <span class="meta">@State</span> <span class="keyword">private</span> <span class="keyword">var</span> text <span class="operator">=</span> <span class="string">&quot;&quot;</span></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">var</span> body: <span class="keyword">some</span> <span class="type">View</span> &#123;</span><br><span class="line">        <span class="type">TextEditor</span>(text: <span class="variable">$text</span>)</span><br><span class="line">            .selectionRange(<span class="variable">$selectionRange</span>)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><span id="more"></span><h2 id="åŸç†"><a href="#åŸç†" class="headerlink" title="åŸç†"></a>åŸç†</h2><p>é¦–å…ˆä» SwiftUI çš„åº•å±‚å…¥æ‰‹ï¼Œ</p><p>SwiftUI åœ¨æ„å»º View æ—¶ä¼šä½¿ç”¨åˆ° NSView(Controller) &#x2F; UIVIew(Controller)ï¼Œ</p><p>åœ¨ä»–ä»¬çš„ä¸Šå±‚è¿˜ä¼šåŒ…ä¸€å±‚ <code>ViewHost</code>ï¼Œ</p><p>ç±»ä¼¼è¿™æ ·ï¼š</p><p><img src="/img/swiftui-selection-range/view-hierachy.jpeg" alt="macOS View Hierachy"></p><p>åªè¦æˆ‘ä»¬é¡ºç€ ViewHost æ‰¾åˆ°äº†å¯¹åº”çš„ NSView(Controller) &#x2F; UIVIew(Controller)ï¼Œ</p><p>å°±èƒ½å®ç°å¯¹æ§ä»¶çš„è‡ªå®šä¹‰æ›´æ”¹ã€‚</p><h2 id="ä»£ç å®ç°"><a href="#ä»£ç å®ç°" class="headerlink" title="ä»£ç å®ç°"></a>ä»£ç å®ç°</h2><h3 id="STEP-1-å¯»æ‰¾-NSTextView-x2F-UITextView"><a href="#STEP-1-å¯»æ‰¾-NSTextView-x2F-UITextView" class="headerlink" title="STEP 1: å¯»æ‰¾ NSTextView &#x2F; UITextView"></a>STEP 1: å¯»æ‰¾ <code>NSTextView</code> &#x2F; <code>UITextView</code></h3><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">fileprivate</span> <span class="keyword">class</span> <span class="title class_">_TextViewFinder</span>: <span class="title class_">PlatformView</span> &#123;</span><br><span class="line">    <span class="keyword">init</span>() &#123;</span><br><span class="line">        <span class="keyword">super</span>.<span class="keyword">init</span>(frame: .zero)</span><br><span class="line">        isHidden <span class="operator">=</span> <span class="literal">true</span></span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">override</span> <span class="keyword">func</span> <span class="title function_">hitTest</span>(<span class="keyword">_</span> <span class="params">point</span>: <span class="type">NSPoint</span>) -&gt; <span class="type">PlatformView</span>? &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">nil</span></span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">@available</span>(<span class="operator">*</span>, unavailable)</span><br><span class="line">    <span class="keyword">required</span> <span class="keyword">init?</span>(<span class="params">coder</span>: <span class="type">NSCoder</span>) &#123;</span><br><span class="line">        <span class="built_in">fatalError</span>(<span class="string">&quot;init(coder:) has not been implemented&quot;</span>)</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">func</span> <span class="title function_">findTextView</span>(<span class="params">view</span>: <span class="type">PlatformView</span>?) -&gt; <span class="type">TextView</span>? &#123;</span><br><span class="line">        <span class="keyword">var</span> superview <span class="operator">=</span> view</span><br><span class="line">        <span class="keyword">while</span> <span class="keyword">let</span> s <span class="operator">=</span> superview &#123;</span><br><span class="line">            <span class="keyword">if</span> <span class="type">NSStringFromClass</span>(<span class="built_in">type</span>(of: s)).contains(<span class="string">&quot;ViewHost&quot;</span>) &#123;</span><br><span class="line">                <span class="keyword">let</span> viewHost <span class="operator">=</span> s</span><br><span class="line">                <span class="keyword">guard</span> <span class="keyword">let</span> superview <span class="operator">=</span> viewHost.superview,</span><br><span class="line">                    <span class="keyword">let</span> entryIndex <span class="operator">=</span> superview.subviews.firstIndex(of: viewHost),</span><br><span class="line">                    entryIndex <span class="operator">&gt;</span> <span class="number">0</span></span><br><span class="line">                <span class="keyword">else</span> &#123;</span><br><span class="line">                    <span class="keyword">return</span> <span class="literal">nil</span></span><br><span class="line">                &#125;</span><br><span class="line">                </span><br><span class="line">                <span class="keyword">for</span> subview <span class="keyword">in</span> superview.subviews[<span class="number">0</span><span class="operator">..&lt;</span>entryIndex].reversed() &#123;</span><br><span class="line">                    <span class="keyword">if</span> <span class="keyword">let</span> typed <span class="operator">=</span> findChild(in: subview) &#123;</span><br><span class="line">                        <span class="keyword">return</span> typed</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">                </span><br><span class="line">                <span class="keyword">return</span> <span class="literal">nil</span></span><br><span class="line">            &#125;</span><br><span class="line">            superview <span class="operator">=</span> s.superview</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">return</span> <span class="literal">nil</span></span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">func</span> <span class="title function_">findChild</span>(<span class="params">in</span> <span class="params">root</span>: <span class="type">PlatformView</span>) -&gt; <span class="type">TextView</span>? &#123;</span><br><span class="line">        <span class="keyword">for</span> subview <span class="keyword">in</span> root.subviews &#123;</span><br><span class="line">            <span class="keyword">if</span> <span class="keyword">let</span> typed <span class="operator">=</span> subview <span class="keyword">as?</span> <span class="type">TextView</span> &#123;</span><br><span class="line">                <span class="keyword">return</span> typed</span><br><span class="line">            &#125; <span class="keyword">else</span> <span class="keyword">if</span> <span class="keyword">let</span> typed <span class="operator">=</span> findChild(in: subview) &#123;</span><br><span class="line">                <span class="keyword">return</span> typed</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">nil</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">#if</span> os(macOS)</span><br><span class="line"><span class="keyword">fileprivate</span> <span class="keyword">typealias</span> <span class="type">TextView</span> <span class="operator">=</span> <span class="type">NSTextView</span></span><br><span class="line"><span class="keyword">fileprivate</span> <span class="keyword">typealias</span> <span class="type">PlatformView</span> <span class="operator">=</span> <span class="type">NSView</span></span><br><span class="line"><span class="keyword">#elseif</span> <span class="operator">!</span>os(watchOS)</span><br><span class="line"><span class="keyword">fileprivate</span> <span class="keyword">typealias</span> <span class="type">TextView</span> <span class="operator">=</span> <span class="type">UITextView</span></span><br><span class="line"><span class="keyword">fileprivate</span> <span class="keyword">typealias</span> <span class="type">PlatformView</span> <span class="operator">=</span> <span class="type">NSView</span></span><br><span class="line"><span class="keyword">#endif</span></span><br></pre></td></tr></table></figure><h3 id="STEP-2-æŠŠ-PlatformView-åŒ…è£…æˆ-SwiftUI-View"><a href="#STEP-2-æŠŠ-PlatformView-åŒ…è£…æˆ-SwiftUI-View" class="headerlink" title="STEP 2: æŠŠ PlatformView åŒ…è£…æˆ SwiftUI View"></a>STEP 2: æŠŠ <code>PlatformView</code> åŒ…è£…æˆ <code>SwiftUI View</code></h3><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">fileprivate</span> <span class="keyword">struct</span> <span class="title class_">_TextViewFinderWrapper</span>: <span class="title class_">ViewRepresentable</span> &#123;</span><br><span class="line">    <span class="meta">@Binding</span> <span class="keyword">var</span> textView: <span class="type">TextView</span>?</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">typealias</span> _Finder <span class="operator">=</span> _TextViewFinder</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">func</span> <span class="title function_">makeView</span>(<span class="params">context</span>: <span class="type">Context</span>) -&gt; _Finder &#123;</span><br><span class="line">        _TextViewFinder()</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">func</span> <span class="title function_">updateView</span>(<span class="keyword">_</span> <span class="params">finder</span>: _Finder, <span class="params">context</span>: <span class="type">Context</span>) &#123;</span><br><span class="line">        <span class="type">DispatchQueue</span>.main.async &#123;</span><br><span class="line">            <span class="keyword">if</span> <span class="keyword">let</span> textView <span class="operator">=</span> finder.findTextView(view: finder.superview) &#123;</span><br><span class="line">                <span class="keyword">self</span>.textView <span class="operator">=</span> textView</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">#if</span> os(macOS)</span><br><span class="line"><span class="keyword">protocol</span> <span class="title class_">ViewRepresentable</span>: <span class="title class_">NSViewRepresentable</span> &#123;</span><br><span class="line">    <span class="keyword">associatedtype</span> <span class="type">NSViewType</span></span><br><span class="line">    <span class="keyword">func</span> <span class="title function_">makeView</span>(<span class="params">context</span>: <span class="type">Context</span>) -&gt; <span class="type">NSViewType</span></span><br><span class="line">    <span class="keyword">func</span> <span class="title function_">updateView</span>(<span class="keyword">_</span> <span class="params">nsView</span>: <span class="type">NSViewType</span>, <span class="params">context</span>: <span class="type">Context</span>)</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">extension</span> <span class="title class_">ViewRepresentable</span> &#123;</span><br><span class="line">    <span class="keyword">func</span> <span class="title function_">makeNSView</span>(<span class="params">context</span>: <span class="type">Context</span>) -&gt; <span class="type">NSViewType</span> &#123;</span><br><span class="line">        makeView(context: context)</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">func</span> <span class="title function_">updateNSView</span>(<span class="keyword">_</span> <span class="params">nsView</span>: <span class="type">NSViewType</span>, <span class="params">context</span>: <span class="type">Context</span>) &#123;</span><br><span class="line">        updateView(nsView, context: context)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">#else</span></span><br><span class="line"><span class="keyword">protocol</span> <span class="title class_">ViewRepresentable</span>: <span class="title class_">UIViewRepresentable</span> &#123;</span><br><span class="line">    <span class="keyword">associatedtype</span> <span class="type">UIViewType</span></span><br><span class="line">    <span class="keyword">func</span> <span class="title function_">makeView</span>(<span class="params">context</span>: <span class="type">Context</span>) -&gt; <span class="type">UIViewType</span></span><br><span class="line">    <span class="keyword">func</span> <span class="title function_">updateView</span>(<span class="keyword">_</span> <span class="params">uiView</span>: <span class="type">UIViewType</span>, <span class="params">context</span>: <span class="type">Context</span>)</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">extension</span> <span class="title class_">ViewRepresentable</span> &#123;</span><br><span class="line">    <span class="keyword">func</span> <span class="title function_">makeUIView</span>(<span class="params">context</span>: <span class="type">Context</span>) -&gt; <span class="type">UIViewType</span> &#123;</span><br><span class="line">        makeView(context: context)</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">func</span> <span class="title function_">updateUIView</span>(<span class="keyword">_</span> <span class="params">uiView</span>: <span class="type">UIViewType</span>, <span class="params">context</span>: <span class="type">Context</span>) &#123;</span><br><span class="line">        updateView(uiView, context: context)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">#endif</span></span><br></pre></td></tr></table></figure><p>åˆ©ç”¨ <code>finder.findTextView </code> å¯»æ‰¾ <code>TextView</code> å¹¶ä¸”å°†å…¶ä¿å­˜åˆ° <code>textView</code>ï¼Œ</p><p>ä½¿ç”¨ <code>@Binding</code> å¯ä»¥ä½¿å…¶ç”Ÿå‘½å‘¨æœŸä¸è§†å›¾ä¿æŒåŒå¹¶ä¸ä¸Šå±‚è§†å›¾åŒæ­¥ä¿¡æ¯ã€‚</p><h3 id="STEP-3-ç”¨-TextViewFinderWrapper-æ¥å¯»æ‰¾å¯¹åº”çš„-NSView-x2F-UIView"><a href="#STEP-3-ç”¨-TextViewFinderWrapper-æ¥å¯»æ‰¾å¯¹åº”çš„-NSView-x2F-UIView" class="headerlink" title="STEP 3: ç”¨ _TextViewFinderWrapper æ¥å¯»æ‰¾å¯¹åº”çš„ NSView &#x2F; UIView"></a>STEP 3: ç”¨ <code>_TextViewFinderWrapper</code> æ¥å¯»æ‰¾å¯¹åº”çš„ NSView &#x2F; UIView</h3><p><code>overlay</code> ç›¸å½“äº AppKit å’Œ UIKit ä¸­çš„ <code>addSubview</code>ï¼Œ</p><p>ä½¿ç”¨ <code>superview</code> å³å¯æ‰¾åˆ°ä¸Šå±‚çš„ ViewRepresentation ä¹Ÿå°±æ˜¯ SwiftUI Viewï¼Œ</p><p>å¯ä»¥å†™ä¸€ä¸ª <code>ViewModifier</code></p><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">fileprivate</span> <span class="keyword">struct</span> <span class="title class_">_SelectionRangeModifier</span>: <span class="title class_">ViewModifier</span> &#123;</span><br><span class="line">    <span class="keyword">func</span> <span class="title function_">body</span>(<span class="params">content</span>: <span class="type">Content</span>) -&gt; <span class="keyword">some</span> <span class="type">View</span> &#123;</span><br><span class="line">        content</span><br><span class="line">            .overlay(_TextViewFinderWrapper(textView: <span class="variable">$textView</span>).frame(width: <span class="number">0</span>, height: <span class="number">0</span>))</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="STEP-4-å®ç°-selectionRange-çš„åŒå‘ç»‘å®š"><a href="#STEP-4-å®ç°-selectionRange-çš„åŒå‘ç»‘å®š" class="headerlink" title="STEP 4: å®ç° selectionRange çš„åŒå‘ç»‘å®š"></a>STEP 4: å®ç° <code>selectionRange</code> çš„åŒå‘ç»‘å®š</h3><p>å‘ä¸Šç»‘å®šï¼š</p><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">.onReceive(</span><br><span class="line">    <span class="type">NotificationCenter</span>.default.publisher(for: <span class="type">TextView</span>.didChangeSelectionNotification, object: textView)</span><br><span class="line">) &#123; <span class="keyword">_</span> <span class="keyword">in</span></span><br><span class="line">   <span class="comment">// Selection Range did change.</span></span><br><span class="line">   <span class="comment">// Update selection range using `textView` instance.</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å‘ä¸‹ç»‘å®šï¼š</p><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">.task(id: range) &#123;</span><br><span class="line">   <span class="comment">// Selection range changed by SwiftUI State.</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å°è£…èµ·æ¥å¤§è‡´æ˜¯è¿™æ ·çš„ï¼š</p><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">fileprivate</span> <span class="keyword">struct</span> <span class="title class_">_SelectionRangeModifier</span>: <span class="title class_">ViewModifier</span> &#123;</span><br><span class="line">    <span class="meta">@Binding</span> <span class="keyword">var</span> range: <span class="type">NSRange</span></span><br><span class="line">    <span class="meta">@State</span> <span class="keyword">private</span> <span class="keyword">var</span> textView: <span class="type">TextView</span>?</span><br><span class="line"></span><br><span class="line">    <span class="keyword">func</span> <span class="title function_">body</span>(<span class="params">content</span>: <span class="type">Content</span>) -&gt; <span class="keyword">some</span> <span class="type">View</span> &#123;</span><br><span class="line">        content</span><br><span class="line">            .overlay(_TextViewFinderWrapper(textView: <span class="variable">$textView</span>).frame(width: <span class="number">0</span>, height: <span class="number">0</span>))</span><br><span class="line">            <span class="keyword">#if</span> os(macOS)</span><br><span class="line">            .onReceive(</span><br><span class="line">                <span class="type">NotificationCenter</span>.default.publisher(for: <span class="type">TextView</span>.didChangeSelectionNotification, object: textView)</span><br><span class="line">            ) &#123; <span class="keyword">_</span> <span class="keyword">in</span></span><br><span class="line">                <span class="keyword">guard</span> <span class="keyword">let</span> textView <span class="keyword">else</span> &#123; <span class="keyword">return</span> &#125;</span><br><span class="line">                range <span class="operator">=</span> textView.selectedRange()</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">#endif</span></span><br><span class="line">            .task(id: range) &#123;</span><br><span class="line">                <span class="keyword">let</span> newRange <span class="operator">=</span> range</span><br><span class="line">                <span class="keyword">#if</span> os(macOS)</span><br><span class="line">                textView<span class="operator">?</span>.setSelectedRange(newRange)</span><br><span class="line">                <span class="keyword">#else</span></span><br><span class="line">                textView<span class="operator">?</span>.selectedRange <span class="operator">=</span> newRange</span><br><span class="line">                <span class="keyword">#endif</span></span><br><span class="line">            &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="STEP-5-æ‰©å±•ä¸€ä¸‹-View"><a href="#STEP-5-æ‰©å±•ä¸€ä¸‹-View" class="headerlink" title="STEP 5: æ‰©å±•ä¸€ä¸‹ View"></a>STEP 5: æ‰©å±•ä¸€ä¸‹ View</h3><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">extension</span> <span class="title class_">View</span> &#123;</span><br><span class="line">    <span class="keyword">@available</span>(<span class="keyword">watchOS</span>, unavailable)</span><br><span class="line">    <span class="keyword">@available</span>(<span class="keyword">iOS</span> <span class="number">13.0</span>, <span class="keyword">macOS</span> <span class="number">10.15</span>, <span class="keyword">tvOS</span> <span class="number">13.0</span>, <span class="operator">*</span>)</span><br><span class="line">    <span class="keyword">func</span> <span class="title function_">selectionRange</span>(<span class="keyword">_</span> <span class="params">range</span>: <span class="type">Binding</span>&lt;<span class="type">NSRange</span>&gt;) -&gt; <span class="keyword">some</span> <span class="type">View</span> &#123;</span><br><span class="line">        modifier(_SelectionRangeModifier(range: range))</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å¥½å•¦ï¼Œæå®šï¼</p><h2 id="å°é—®é¢˜"><a href="#å°é—®é¢˜" class="headerlink" title="å°é—®é¢˜"></a>å°é—®é¢˜</h2><ul><li><p>æœ¬æ–¹æ³•å±äº Hackï¼Œå¾ˆæœ‰å¯èƒ½åœ¨æœªæ¥çš„ SwiftUI å¤§ç‰ˆæœ¬ä¸­å¤±æ•ˆï¼ˆå¦‚æœ SwiftUI ä¿®æ”¹äº† View Hierarchyï¼‰</p></li><li><p>æ–‡æœ¬æ¡†è¿˜æ˜¯å¯èƒ½ä¼šå‡ºç°é—ªçƒçš„é—®é¢˜ï¼Œæˆ‘å·²ç»å°½å¯èƒ½åœ°è§„é¿äº†ï¼Œä½†æ˜¯å¯èƒ½è¿˜æ˜¯ä¼šå‡ºç°â€¦ç›®å‰æ— è§£ã€‚</p></li></ul>]]></content>
    
    
    <summary type="html">&lt;p&gt;åœ¨ SwiftUI ä¸­ï¼Œæ²¡æœ‰æä¾›é»˜è®¤çš„ modifier æ¥ç›‘å¬ &lt;code&gt;TextView&lt;/code&gt; çš„ &lt;code&gt;selectionRange&lt;/code&gt;ï¼Œ&lt;/p&gt;
&lt;p&gt;è¿™å¯¹äºæ–‡æœ¬ç¼–è¾‘ç±» app æ¥è¯´æ˜¯å¾ˆè‡´å‘½çš„ï¼Œå› ä¸ºæ— æ³•æ§åˆ¶å…‰æ ‡çš„ä½ç½®ï¼Œ&lt;/p&gt;
&lt;p&gt;ä½†æ˜¯å¯ä»¥ä»å…¶ä»–çš„æ–‡ç« ä¸­æ‰¾åˆ°ä¸€äº›æ€è·¯ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;https://swiftui-lab.com/a-powerful-combo/&quot;&gt;The Power of the Hosting+Representable Combo&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://github.com/siteline/SwiftUI-Introspect&quot;&gt;siteline&amp;#x2F;SwiftUI-Introspect&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;å¯»æ‰¾ NSView &amp;#x2F; UIView çš„æ–¹æ³•æ¥æºäºï¼š&lt;a href=&quot;https://github.com/siteline/SwiftUI-Introspect&quot;&gt;siteline&amp;#x2F;SwiftUI-Introspect&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;æœ¬æ–‡æ¥ä»‹ç»ä¸€ç§è§£å†³æ–¹æ¡ˆï¼Œå¯ä»¥å®ç°å‡ºä»¥ä¸‹çš„ä»£ç ï¼š&lt;/p&gt;
&lt;figure class=&quot;highlight swift&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;import&lt;/span&gt; SwiftUI&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;struct&lt;/span&gt; &lt;span class=&quot;title class_&quot;&gt;Example&lt;/span&gt;: &lt;span class=&quot;title class_&quot;&gt;View&lt;/span&gt; &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;meta&quot;&gt;@State&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;var&lt;/span&gt; selectionRange &lt;span class=&quot;operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;type&quot;&gt;NSRange&lt;/span&gt;()&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;meta&quot;&gt;@State&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;var&lt;/span&gt; text &lt;span class=&quot;operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;&amp;quot;&amp;quot;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;var&lt;/span&gt; body: &lt;span class=&quot;keyword&quot;&gt;some&lt;/span&gt; &lt;span class=&quot;type&quot;&gt;View&lt;/span&gt; &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;type&quot;&gt;TextEditor&lt;/span&gt;(text: &lt;span class=&quot;variable&quot;&gt;$text&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            .selectionRange(&lt;span class=&quot;variable&quot;&gt;$selectionRange&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;</summary>
    
    
    
    <category term="æ’¸ä»£ç " scheme="https://liyanan2004.github.io/categories/%E6%92%B8%E4%BB%A3%E7%A0%81/"/>
    
    
    <category term="swift" scheme="https://liyanan2004.github.io/tags/swift/"/>
    
    <category term="swiftui" scheme="https://liyanan2004.github.io/tags/swiftui/"/>
    
  </entry>
  
  <entry>
    <title>MarkdownView ä» 0 åˆ° 1 â€”â€” å›é¡¾æ•´æ¡æ—¶é—´çº¿</title>
    <link href="https://liyanan2004.github.io/the-road-of-markdown-view/"/>
    <id>https://liyanan2004.github.io/the-road-of-markdown-view/</id>
    <published>2023-02-02T11:45:04.000Z</published>
    <updated>2023-02-19T05:21:10.000Z</updated>
    
    <content type="html"><![CDATA[<p>ç†Ÿæ‚‰æˆ‘çš„æœ‹å‹åº”è¯¥çŸ¥é“ï¼Œæˆ‘ä¸€ç›´åœ¨å¼€å‘ä¸€ä¸ªæ¡†æ¶ï¼Œ</p><p>ç”¨äºåœ¨ SwiftUI ä¸­ä»¥åŸç”Ÿçš„æ–¹å¼æ¥æ¸²æŸ“ Markdown æ–‡æœ¬ã€‚</p><p>P.S. è¿™ç¯‡æ–‡ç« ä¹Ÿæ˜¯åœ¨æˆ‘åšçš„ç¼–è¾‘å™¨ä¸­å®Œæˆçš„ã€‚</p><p>æ—©æ™¨å‘å¸ƒäº† <a href="https://github.com/LiYanan2004/MarkdownView/releases">MarkdownView</a> çš„ <code>1.0.0-rc</code>ï¼Œä¹Ÿå°±æ˜¯æ­£å¼ç‰ˆçš„å€™é€‰ç‰ˆæœ¬ï¼Œ</p><p>å†™è¿™ç¯‡æ–‡ç« ä¸»è¦æ˜¯æƒ³å›é¡¾å’Œæ€»ç»“ä¸€è·¯è¿‡æ¥çš„æŠ€æœ¯ç‚¹å’Œä¸€äº›è§£å†³æ–¹æ¡ˆã€‚</p><span id="more"></span><h2 id="ä¸ºä»€ä¹ˆè¦åšè¿™ä¸ªé¡¹ç›®"><a href="#ä¸ºä»€ä¹ˆè¦åšè¿™ä¸ªé¡¹ç›®" class="headerlink" title="ä¸ºä»€ä¹ˆè¦åšè¿™ä¸ªé¡¹ç›®"></a>ä¸ºä»€ä¹ˆè¦åšè¿™ä¸ªé¡¹ç›®</h2><h3 id="æ— å¥ˆå’Œæœºé‡"><a href="#æ— å¥ˆå’Œæœºé‡" class="headerlink" title="æ— å¥ˆå’Œæœºé‡"></a>æ— å¥ˆå’Œæœºé‡</h3><p>å…¶å®ï¼Œå¾ˆæ—©ä¹‹å‰ï¼Œæˆ‘å°±æƒ³åšä¸€æ¬¾ç¬”è®°åº”ç”¨ï¼Œ</p><p>å†™å­—åŠŸèƒ½ç”¨ PencilKit èƒ½å®ç°ï¼Œä½†æ˜¯æ€»ä¸èƒ½åªæ”¯æŒæ‰‹å†™å§â€¦</p><p>ä½†æ˜¯æ‰¾äº†ä¸€åœˆå¼€æºç¤¾åŒºéƒ½æ‰¾ä¸åˆ°å¾ˆå¥½çš„ç”¨äºæ¸²æŸ“ Markdown æ–‡æœ¬çš„ç»„ä»¶ï¼Œ</p><p>æ°å¥½åœ¨æˆ‘é«˜è€ƒå®Œä¹‹åï¼Œå‘ç°è‹¹æœå¼€æºäº†è‡ªå·±çš„ <code>swift-markdown</code> ç”¨äºå¤„ç† Markdown æ–‡æœ¬çš„è§£æã€‚</p><h3 id="Typora-ç»“æŸå…¬æµ‹ï¼Œå¼€å§‹æ”¶è´¹"><a href="#Typora-ç»“æŸå…¬æµ‹ï¼Œå¼€å§‹æ”¶è´¹" class="headerlink" title="Typora ç»“æŸå…¬æµ‹ï¼Œå¼€å§‹æ”¶è´¹"></a>Typora ç»“æŸå…¬æµ‹ï¼Œå¼€å§‹æ”¶è´¹</h3><p>å…¶å®æ˜¯æœ‰æ›¿ä»£çš„ <code>Notion</code>ï¼Œä½†æ˜¯ Web å¥—å£³çš„ app å¤šå°‘è¿˜æœ‰ç‚¹ä¸å–œæ¬¢ï¼Œè€Œä¸”è®¿é—®ä¹Ÿä¸æ˜¯å¾ˆç¨³å®šã€‚</p><h2 id="åŸºæœ¬åŸç†"><a href="#åŸºæœ¬åŸç†" class="headerlink" title="åŸºæœ¬åŸç†"></a>åŸºæœ¬åŸç†</h2><p>å…ˆæ¥è¯´è¯´ <code>swift-markdown</code> è§£æå¥½çš„æ•°æ®æ˜¯å¦‚ä½•å˜æˆæœ€ç»ˆçš„ <code>View</code> çš„ï¼š</p><ol><li>åŸå§‹æ–‡æœ¬ç”± <code>swift-markdown</code> è§£æç”Ÿæˆæ–‡æ¡£æ ‘</li><li>å¯¹åº”æ¯ä¸€ä¸ªèŠ‚ç‚¹ï¼Œè¿”å›ä¸€ä¸ªåŸç”Ÿçš„ <code>SwiftUI View</code></li><li>ç”¨åˆé€‚çš„æ–¹æ³•å°†æ‰€æœ‰èŠ‚ç‚¹çš„ <code>View</code> åˆå¹¶åœ¨ä¸€èµ·æ‰“åŒ…</li><li>ç”± SwiftUI è®¡ç®—å’Œæ˜¾ç¤º</li></ol><p>åœ¨ç¬¬äºŒæ­¥ä¸­è¿”å›çš„æ¯ä¸€ä¸ªå­ <code>View</code> éƒ½éœ€è¦æ˜¯ç›¸åŒç±»å‹çš„ï¼Œä¸è¿‡å¥½åœ¨ SwiftUI ç»™æˆ‘ä»¬æä¾›äº† <code>AnyView</code> æ¥æ“¦é™¤ç±»å‹ã€‚</p><p><img src="/img/the-road-of-markdown-view/markdown-view-workflow.jpeg" alt="åŸç†å›¾ç¤º"></p><h2 id="å¸ƒå±€é—®é¢˜"><a href="#å¸ƒå±€é—®é¢˜" class="headerlink" title="å¸ƒå±€é—®é¢˜"></a>å¸ƒå±€é—®é¢˜</h2><p>ç”±äºæ–‡æ¡£æ ‘ä¸­çš„æ¯ä¸€ä¸ªèŠ‚ç‚¹éƒ½æ˜¯ä¸€ä¸ª <code>AnyView</code>ï¼Œé¢ä¸´ä¸¤ä¸ªé—®é¢˜ï¼š</p><ol><li>å¦‚ä½•æ§åˆ¶æ¯ä¸€ä¸ªè§†å›¾çš„å¤§å°</li><li>å¦‚ä½•åŠ¨æ€çš„ä½¿ç”¨ <code>HStack</code> å’Œ <code>VStack</code> æ¥æ”¾ç½®æ¨ªç«–ä¸¤ä¸ªæ–¹å‘</li></ol><p>å¹¸è¿çš„æ˜¯ï¼Œåœ¨ WWDC 22 ä¸Šï¼Œæˆ‘ä»¬å¯ä»¥è‡ªå®šä¹‰ä¸€ä¸ª <code>Layout</code>ï¼Œ</p><p>ä½†ä¸å¹¸çš„æ˜¯ï¼Œ<code>Layout Protocol</code> åªæ”¯æŒæœ€æ–°çš„ç³»ç»Ÿï¼Œæ— æ³•å‘åå…¼å®¹ã€‚</p><h3 id="æ‹†åˆ†æ–‡æœ¬ï¼Œå†ç»“åˆ"><a href="#æ‹†åˆ†æ–‡æœ¬ï¼Œå†ç»“åˆ" class="headerlink" title="æ‹†åˆ†æ–‡æœ¬ï¼Œå†ç»“åˆ"></a>æ‹†åˆ†æ–‡æœ¬ï¼Œå†ç»“åˆ</h3><p>é™¤äº†å›¾ç‰‡ä¹‹å¤–çš„å†…å®¹ï¼Œå½’æ ¹ç»“åº•éƒ½æ˜¯æ–‡æœ¬ï¼Œ</p><p>å› æ­¤å°†æ–‡æœ¬æ‹†åˆ†æˆå°½å¯èƒ½å°çš„éƒ¨åˆ†ï¼ˆä¸€ä¸ªå•è¯æˆ–è€…ä¸€ä¸ªè¯ç»„ï¼‰</p><p>é…åˆè‡ªå®šä¹‰çš„çµæ´»å¸ƒå±€ï¼ˆ<code>FlowLayout</code>ï¼‰æ¥å®ç°å¸ƒå±€ã€‚</p><p>ä½†æ˜¯è¿™æ ·çš„æ–¹æ¡ˆå±äºåœ¨è¿è¡Œæ—¶æ‹†åˆ†ï¼ˆæ–‡æœ¬ï¼‰åˆåˆå¹¶ï¼ˆè§†å›¾ï¼‰ï¼Œéå¸¸æ¶ˆè€—ç³»ç»Ÿèµ„æºã€‚</p><p>ä¹‹å‰çš„ <a href="/markdownview-performance-optimization/" title="è®°å½•ä¸‹ MarkdownView çš„æ€§èƒ½ä¼˜åŒ–">è®°å½•ä¸‹ MarkdownView çš„æ€§èƒ½ä¼˜åŒ–</a> ä¸­æåˆ°çš„è§£å†³æ–¹æ¡ˆåªèƒ½è§£å†³å¯åŠ¨æ—¶çš„å¡é¡¿å’Œè¿ç»­è¾“å…¥æ—¶çš„å¡é¡¿ï¼Œ</p><p>è€Œå¯¹äºå†…å®¹çš„åŠ è½½é€Ÿåº¦æ²¡æœ‰å¸®åŠ©ï¼ŒåŒæ—¶å¤šä¸ªå¼‚æ­¥æ“ä½œä¹Ÿéœ€è¦ç­‰å¾… CPU ç©ºé—²æ—¶æ‰èƒ½è¢«æ´¾å‘ä¸Šå»ã€‚</p><p>æœ€å…³é”®çš„æ˜¯ï¼ŒæŒ‰ç…§è¿™æ ·çš„æ¨¡å¼ç»§ç»­ä¸‹å»ï¼Œæ–‡æœ¬å§‹ç»ˆæ— æ³•é€‰æ‹©å’Œå¤åˆ¶ã€‚</p><hr><h3 id="å°†è§†å›¾æš‚å­˜ï¼Œåˆå¹¶ç›¸åŒçš„ç±»å‹"><a href="#å°†è§†å›¾æš‚å­˜ï¼Œåˆå¹¶ç›¸åŒçš„ç±»å‹" class="headerlink" title="å°†è§†å›¾æš‚å­˜ï¼Œåˆå¹¶ç›¸åŒçš„ç±»å‹"></a>å°†è§†å›¾æš‚å­˜ï¼Œåˆå¹¶ç›¸åŒçš„ç±»å‹</h3><p>ä¸»è¦æƒ³è¦è§£å†³çš„é—®é¢˜æ˜¯ <em>åŠ è½½æ—¶é—´é•¿</em> å’Œ <em>æ— æ³•å¤åˆ¶</em> è¿™ä¸¤ä¸ªé—®é¢˜ã€‚</p><p>åŠ è½½æ—¶é—´é•¿ä¸»è¦æ˜¯å› ä¸ºé¢‘ç¹åœ°æ–‡æœ¬æ‹†åˆ†å’Œå¤§é‡çš„å­è§†å›¾çš„ä½ç½®å¤§å°è®¡ç®—å¯¼è‡´çš„ï¼Œ</p><p>è§£å†³æ–¹æ¡ˆæ˜¯ä½¿ç”¨ SwiftUI ä¸­çš„ <code>Text</code> åšæ‹¼æ¥ï¼ŒåŒæ—¶è§£å†³äº†æ— æ³•å¤åˆ¶çš„é—®é¢˜ï¼Œé¡ºä¾¿å¯ä»¥å‘åå…¼å®¹äº†ä¸€ä¸ªå¤§ç‰ˆæœ¬ã€‚</p><p>è¿™ä¸€å—çš„çµæ„Ÿæ˜¯å—åˆ° <a href="https://www.fatbobman.com/posts/mixing_text_and_graphics_with_Text_in_SwiftUI">åœ¨ SwiftUI ä¸­ç”¨ Text å®ç°å›¾æ–‡æ··æ’</a> çš„å¯å‘ã€‚</p><p>åˆ›å»ºäº†ä¸€ä¸ª <code>ViewContent</code> ç”¨æ¥æš‚å­˜ç”±èŠ‚ç‚¹ç”Ÿæˆçš„è§†å›¾ï¼š</p><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">struct</span> <span class="title class_">ViewContent</span> &#123;</span><br><span class="line">    <span class="keyword">var</span> text: <span class="type">Text</span></span><br><span class="line">    <span class="keyword">var</span> view: <span class="type">AnyView</span></span><br><span class="line">    <span class="keyword">var</span> type: <span class="type">ContentType</span></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">enum</span> <span class="title class_">ContentType</span>: <span class="title class_">String</span> &#123;</span><br><span class="line">        <span class="keyword">case</span> text, view</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å½“ä¼ å…¥å¤šä¸ª <code>ViewContent</code> çš„æ—¶å€™ï¼Œä¼šæ£€æŸ¥å¹¶åˆå¹¶ç›¸é‚»çš„ã€åŒç±»å‹çš„ <code>ViewContent</code>ï¼Œ</p><p>åé¢å†ç”¨ <code>VStack</code> æŠŠä¸€ä¸ªä¸ªçš„ paragraph ä¸²èµ·æ¥å³å¯å¾—åˆ°å®Œæ•´çš„è§†å›¾ï¼Œ</p><p>æµ‹è¯•äº†ä¸‹ï¼Œ<em>åŒä¸€æ–‡æ¡£çš„åŠ è½½é€Ÿåº¦æå‡äº†çº¦ 5x</em></p><h2 id="å›¾ç‰‡å’Œè‡ªå®šä¹‰å—çš„æ”¯æŒ"><a href="#å›¾ç‰‡å’Œè‡ªå®šä¹‰å—çš„æ”¯æŒ" class="headerlink" title="å›¾ç‰‡å’Œè‡ªå®šä¹‰å—çš„æ”¯æŒ"></a>å›¾ç‰‡å’Œè‡ªå®šä¹‰å—çš„æ”¯æŒ</h2><p>é€šè¿‡ <code>ImageDisplayable</code> å’Œ <code>BlockDirectiveDisplayable</code>ï¼Œå…è®¸å¼€å‘è€…è‡ªå·±å®šä¹‰å¦‚ä½•æ˜¾ç¤ºç›¸å…³å†…å®¹ï¼Œ</p><p><strong>å­¦ä¹ äº†<a href="../tags/%E7%B1%BB%E5%9E%8B%E6%93%A6%E9%99%A4">ç±»å‹æ“¦é™¤</a>çš„å®ç°æ–¹æ¡ˆ</strong>ã€‚</p><h2 id="AdaptiveGrid"><a href="#AdaptiveGrid" class="headerlink" title="AdaptiveGrid"></a>AdaptiveGrid</h2><p>ç”±äºå‘åå…¼å®¹äº†ä¸€ä¸ªå¤§ç‰ˆæœ¬å¯¼è‡´æ— æ³•ç›´æ¥ä½¿ç”¨æ–°çš„ Grid ç»„ä»¶ï¼Œ</p><p>å› æ­¤ï¼Œè¿˜éœ€å¯¹è€ç‰ˆæœ¬ç³»ç»Ÿæä¾›ä¸€ä¸ªç±»ä¼¼çš„è§†å›¾ï¼Œ</p><p>äºæ˜¯å†™äº†ä¸€ä¸ª <code>AdaptiveGrid</code>ï¼Œå…¶è¡¨ç°è¡Œä¸ºä¸ <code>Grid</code> å‡ ä¹ä¸€è‡´ã€‚</p><p>åé¢æˆ‘åº”è¯¥ä¼šå†å†™ä¸€ç¯‡åšå®¢æ¥è¯´è¯´å…¶èƒŒåçš„å®ç°åŸç†ã€‚</p><p><img src="/img/the-road-of-markdown-view/AdaptiveGrid-tweet.jpeg"></p><p><strong>å­¦ä¹ äº† <code>@resultBuilder</code> çš„æ„å»º</strong>ï¼Œåœ¨è¿™é‡Œå†æ¬¡æ„Ÿè°¢è‚˜å­å“¥çš„ä¸¤ç¯‡åšå®¢ï¼š</p><ol><li><a href="https://www.fatbobman.com/posts/viewBuilder1/">ViewBuilder ç ”ç©¶ï¼ˆä¸Šï¼‰â€”â€” æŒæ¡ Result builders</a></li><li><a href="https://www.fatbobman.com/posts/viewBuilder2/">ViewBuilder ç ”ç©¶ï¼ˆä¸‹ï¼‰ â€”â€” ä»æ¨¡ä»¿ä¸­å­¦ä¹ </a></li></ol><h2 id="SVG-å¢å¼º"><a href="#SVG-å¢å¼º" class="headerlink" title="SVG å¢å¼º"></a>SVG å¢å¼º</h2><p>ä¸€ç›´ä»¥æ¥ï¼ŒSVG çš„æ¸²æŸ“éƒ½æ˜¯ç”± <code>SVGKit</code> æ¥å¤„ç†çš„ï¼Œ</p><p>ä½†æ˜¯é—®é¢˜æ˜¯ï¼Œæœ‰ç¼–è¯‘è­¦å‘Šã€ Package è¿‡äºè‡ƒè‚¿ ä¸” éƒ¨åˆ†SVGæ— æ³•æ­£ç¡®æ¸²æŸ“ã€‚</p><p>æœ€è¿‘æ”¹ç”¨äº†åŸç”Ÿçš„ <code>WKWebView</code> æ¥æ¸²æŸ“ SVGï¼ˆç›¸å½“äºä¸€ä¸ªç½‘é¡µï¼‰</p><p><img src="/img/the-road-of-markdown-view/SVG-tweet.jpeg"></p><p><strong>å­¦ä¹ äº†å¦‚ä½•ä½¿ç”¨ JS æ¥è·å–ç½‘é¡µå…ƒç´ çš„å¤§å°</strong>ï¼Œä»¥æ­¤æ¥ä½œä¸ºæœ€ç»ˆæ•´ä¸ª SVG çš„å¤§å°ï¼Œ</p><p>å¹¶ä¸”èƒ½å¤Ÿæ ¹æ®å¯ç”¨å®½åº¦æ¥è‡ªåŠ¨åˆ¤æ–­æ˜¯å¦å¯ç”¨æ»šåŠ¨æ¡ç­‰ç­‰â€¦</p><p>å…·ä½“çš„å®ç°å¯ä»¥åœ¨ä»£ç ä¸­æ‰¾åˆ°ï¼Œæˆ‘ä¸åœ¨åšè¿‡å¤šçš„èµ˜è¿°ã€‚</p><h2 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h2><p>é“è·¯ä¸æ˜¯ä¸€å¸†é£é¡ºçš„ï¼Œæ€»è¦åœ¨è·Œè·Œæ’æ’ä¸­æˆé•¿ï¼Œ</p><p>ä½†åº†å¹¸çš„æ˜¯ï¼Œè¿™ä¸ªè‡ªä¸»é¡¹ç›®ï¼Œ<em>æˆ‘åšå‡ºäº†è‡ªå·±æ»¡æ„çš„æ ·å­</em>ï¼Œè€¶ï½</p><p>é¡¹ç›®åœ°å€ï¼š<a href="https://github.com/LiYanan2004/MarkdownView">Github</a> OR <a href="https://swiftpackageindex.com/LiYanan2004/MarkdownView">Swift Package Index</a></p>]]></content>
    
    
    <summary type="html">&lt;p&gt;ç†Ÿæ‚‰æˆ‘çš„æœ‹å‹åº”è¯¥çŸ¥é“ï¼Œæˆ‘ä¸€ç›´åœ¨å¼€å‘ä¸€ä¸ªæ¡†æ¶ï¼Œ&lt;/p&gt;
&lt;p&gt;ç”¨äºåœ¨ SwiftUI ä¸­ä»¥åŸç”Ÿçš„æ–¹å¼æ¥æ¸²æŸ“ Markdown æ–‡æœ¬ã€‚&lt;/p&gt;
&lt;p&gt;P.S. è¿™ç¯‡æ–‡ç« ä¹Ÿæ˜¯åœ¨æˆ‘åšçš„ç¼–è¾‘å™¨ä¸­å®Œæˆçš„ã€‚&lt;/p&gt;
&lt;p&gt;æ—©æ™¨å‘å¸ƒäº† &lt;a href=&quot;https://github.com/LiYanan2004/MarkdownView/releases&quot;&gt;MarkdownView&lt;/a&gt; çš„ &lt;code&gt;1.0.0-rc&lt;/code&gt;ï¼Œä¹Ÿå°±æ˜¯æ­£å¼ç‰ˆçš„å€™é€‰ç‰ˆæœ¬ï¼Œ&lt;/p&gt;
&lt;p&gt;å†™è¿™ç¯‡æ–‡ç« ä¸»è¦æ˜¯æƒ³å›é¡¾å’Œæ€»ç»“ä¸€è·¯è¿‡æ¥çš„æŠ€æœ¯ç‚¹å’Œä¸€äº›è§£å†³æ–¹æ¡ˆã€‚&lt;/p&gt;</summary>
    
    
    
    <category term="æ’¸ä»£ç " scheme="https://liyanan2004.github.io/categories/%E6%92%B8%E4%BB%A3%E7%A0%81/"/>
    
    
    <category term="MarkdownView" scheme="https://liyanan2004.github.io/tags/MarkdownView/"/>
    
    <category term="swift" scheme="https://liyanan2004.github.io/tags/swift/"/>
    
  </entry>
  
  <entry>
    <title>åœ¨ Mac ä¸Šæ›´å®‰å…¨åœ°ä½¿ç”¨ EasyConnect</title>
    <link href="https://liyanan2004.github.io/use-easy-connect-safely-on-your-mac/"/>
    <id>https://liyanan2004.github.io/use-easy-connect-safely-on-your-mac/</id>
    <published>2023-01-17T10:16:52.000Z</published>
    <updated>2023-01-17T12:48:52.000Z</updated>
    
    <content type="html"><![CDATA[<p>èµ·å› è¿˜æ˜¯å¶ç„¶åœ¨ B ç«™åˆ·åˆ°è¿™ä¹ˆä¸€ä¸ªè§†é¢‘ï¼š</p><iframe src="//player.bilibili.com/player.html?aid=435357348&bvid=BV163411Z7BD&cid=967016106&page=1" scrolling="no" border="0" frameborder="no" framespacing="0" allowfullscreen="true"> </iframe><p>å“Ÿï¼ŒåŸæ¥æ˜¯ä¸ªæµæ°“è½¯ä»¶å•Šï¼Œè‰ï¼ï¼ï¼ï¼ï¼ï¼</p><span id="more"></span><p>å®‰è£…å®ƒï¼Œä¸»è¦æ˜¯å› ä¸ºå­¦æ ¡å†…ç½‘è¦ç”¨ VPN æ‰èƒ½ç™»é™†ï¼Œ</p><p>èµ·åˆå®‰è£…å®Œæˆ‘å°±å‘ç°æœ‰åå°æƒé™çš„å¼€å…³ï¼Œ</p><p>æˆ‘ä¹Ÿå°è¯•å…³æ‰äº†ï¼Œä½†æ˜¯æ²¡æ³•è¿æ¥äº†ï¼ˆè¡¨ç°ä¸ºä¸€ç›´åœ¨åˆå§‹åŒ–ï¼‰</p><p><img src="/img/use-easy-connect-safely-on-your-mac/initializing.jpeg"></p><h2 id="ä¸ºä»€ä¹ˆè¯´ä»–æµæ°“"><a href="#ä¸ºä»€ä¹ˆè¯´ä»–æµæ°“" class="headerlink" title="ä¸ºä»€ä¹ˆè¯´ä»–æµæ°“"></a>ä¸ºä»€ä¹ˆè¯´ä»–æµæ°“</h2><h3 id="åå°æŒç»­æ´»åŠ¨"><a href="#åå°æŒç»­æ´»åŠ¨" class="headerlink" title="åå°æŒç»­æ´»åŠ¨"></a>åå°æŒç»­æ´»åŠ¨</h3><p>æ‰“å¼€â€œæ´»åŠ¨ç›‘è§†å™¨â€ï¼ˆWindows ä¸Šæ˜¯ â€œä»»åŠ¡ç®¡ç†å™¨â€ï¼‰ï¼Œ</p><p>å°±èƒ½æ‰¾åˆ°åä¸º <code>EasyMonitor</code> å’Œ <code>ECAgent</code> çš„ä¸¤ä¸ªè¿›ç¨‹ï¼Œå…³é”®æ˜¯ä»¥ <code>root</code> æƒé™è¿è¡Œï¼Œ</p><p><img src="/img/use-easy-connect-safely-on-your-mac/easy-monitor.jpeg"><br><img src="/img/use-easy-connect-safely-on-your-mac/ecagent.jpeg"></p><p>æ„å‘³ç€ï¼Œä»–æƒ³å¹²å˜›å°±å¹²å˜›ï¼Œä¸éœ€è¦æˆ‘ä»»ä½•æˆæƒï¼Œæˆ‘ä¹Ÿæµ‘ç„¶ä¸çŸ¥ã€‚</p><p>è§‚å¯Ÿäº†ä¸€ä¼šå„¿ï¼ŒCPU ä¸€ç›´éƒ½æœ‰ 0.3 - 0.5 çš„å ç”¨ï¼Œ</p><p>æ„å‘³ç€ï¼Œæœ‰å°‘é‡ä»£ç åœ¨æŒç»­è¿è¡Œï¼Œåœ¨å¹²å˜›ï¼Œä¸çŸ¥é“ã€‚</p><p>å°è¯•å…³æ‰å®ƒï¼Ÿå‘µå‘µï¼Œå¤ªå°çœ‹å®ƒäº†ã€‚<strong>å…³äº†åˆè‡ªåŠ¨å¯åŠ¨äº†ã€‚</strong></p><h3 id="å®‰è£…äº†ç³»ç»Ÿæ ¹è¯ä¹¦"><a href="#å®‰è£…äº†ç³»ç»Ÿæ ¹è¯ä¹¦" class="headerlink" title="å®‰è£…äº†ç³»ç»Ÿæ ¹è¯ä¹¦"></a>å®‰è£…äº†ç³»ç»Ÿæ ¹è¯ä¹¦</h3><p>æ‰“å¼€ <code>é’¥åŒ™ä¸²è®¿é—® - ç³»ç»Ÿé’¥åŒ™ä¸² - ç³»ç»Ÿ - è¯ä¹¦</code>ï¼Œæœç´¢ <code>Sangfor</code>ï¼Œ</p><p>å°±èƒ½çœ‹åˆ°ä¸€ä¸ª <code>è‡ªå·±é¢ç»™è‡ªå·±</code> çš„ä¸€ä¸ªè¯ä¹¦ï¼Œåˆ° 2117 å¹´è¿‡æœŸâ€¦</p><p><img src="/img/use-easy-connect-safely-on-your-mac/self-given-cert.png"></p><p>ç†è®ºä¸Šè¿™æ ·å¯ä»¥åŠ«æŒ HTTPS æ´»åŠ¨ã€‚</p><blockquote><p>å¼•ç”¨ <a href="https://soulike.tech/article/64">åœ¨ macOS ä¸Šå®‰å…¨ä½¿ç”¨ EasyConnect</a> çš„è¯´æ³•ï¼š</p><p>ä»¥ root æƒé™å¸¸é©»è¿›ç¨‹ï¼Œæ„å‘³ç€è¿™äº›è¿›ç¨‹å¯ä»¥è¯»å–å’Œå†™å…¥ä»»ä½•ä¸œè¥¿ï¼›</p><p>å®‰è£…æ ¹è¯ä¹¦ï¼Œæ„å‘³ç€å¯ä»¥ç›´æ¥è¿›è¡Œä¸­é—´äººæ”»å‡»ã€‚å› æ­¤æˆ‘ä»¬éœ€è¦è§£å†³è¿™äº›é—®é¢˜ã€‚</p></blockquote><h2 id="è§£å†³æ–¹æ³•"><a href="#è§£å†³æ–¹æ³•" class="headerlink" title="è§£å†³æ–¹æ³•"></a>è§£å†³æ–¹æ³•</h2><p>å…·ä½“æ–¹æ³•å¯ä»¥å‚è€ƒ <a href="https://soulike.tech/article/64">åœ¨ macOS ä¸Šå®‰å…¨ä½¿ç”¨ EasyConnect</a></p><h3 id="å…³é—­è‡ªå¯åŠ¨-å’Œ-åå°é©»ç•™"><a href="#å…³é—­è‡ªå¯åŠ¨-å’Œ-åå°é©»ç•™" class="headerlink" title="å…³é—­è‡ªå¯åŠ¨ å’Œ åå°é©»ç•™"></a>å…³é—­è‡ªå¯åŠ¨ å’Œ åå°é©»ç•™</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">sudo su</span><br><span class="line"><span class="built_in">rm</span> -r -f /Library/LaunchDaemons/com.sangfor.EasyMonitor.plist</span><br><span class="line"><span class="built_in">rm</span> -r -f /Library/LaunchAgents/com.sangfor.ECAgentProxy.plist</span><br></pre></td></tr></table></figure><blockquote><p>ä»¥ä¸Šä»£ç é€‚ç”¨äº Mac</p></blockquote><h3 id="é‡å¯ç”µè„‘"><a href="#é‡å¯ç”µè„‘" class="headerlink" title="é‡å¯ç”µè„‘"></a>é‡å¯ç”µè„‘</h3><p>ä¸€å®šè¦é‡å¯â€¼ï¸å› ä¸ºç°åœ¨å®ƒè¿˜æœ‰åå°é©»ç•™çš„æƒé™â€¼ï¸</p><h3 id="åˆ é™¤æ ¹è¯ä¹¦"><a href="#åˆ é™¤æ ¹è¯ä¹¦" class="headerlink" title="åˆ é™¤æ ¹è¯ä¹¦"></a>åˆ é™¤æ ¹è¯ä¹¦</h3><p>åœ¨ <code>é’¥åŒ™ä¸²è®¿é—® - ç³»ç»Ÿé’¥åŒ™ä¸² - ç³»ç»Ÿ - è¯ä¹¦</code> ä¸‹æœç´¢ <code>Sangfor</code>ï¼Œåˆ é™¤å¯¹åº”çš„æ‰€æœ‰è¯ä¹¦ã€‚</p><hr><p>åˆ°æ­¤ï¼Œ<strong>å¼€æœºè‡ªå¯åŠ¨</strong> å’Œ <strong>åå°é©»ç•™</strong> çš„é—®é¢˜è§£å†³äº†ï¼Œä½†æ˜¯ EasyConnect ä¹Ÿå½»åº•ç”¨ä¸äº†äº†ï¼Œ</p><p>å¯èƒ½ä¼šå‡ºç° â€œä¸€ç›´åˆå§‹åŒ–ä¸­â€¦â€ çš„é—®é¢˜ã€‚</p><h3 id="è„šæœ¬é…ç½®"><a href="#è„šæœ¬é…ç½®" class="headerlink" title="è„šæœ¬é…ç½®"></a>è„šæœ¬é…ç½®</h3><p>ä¸Šé¢é‚£ä¸ªå‚è€ƒé“¾æ¥é‡Œé¢ç»™å‡ºäº†å…·ä½“è„šæœ¬ï¼Œæœ‰æ‰“å¼€å’Œå…³é—­ä¸¤ä¸ªï¼Œ</p><p>æˆ‘å°†ä»–ä»¬ç»Ÿä¸€äº†ï¼Œ<a href="/assets/easyconnect">ç‚¹è¿™é‡Œä¸‹è½½</a></p><p>è¿™æ˜¯ä¸€ä¸ªæ²¡æœ‰æ‰©å±•åçš„æ–‡ä»¶ï¼Œç”¨æ–‡æœ¬ç¼–è¾‘å™¨æ‰“å¼€å°±èƒ½çœ‹åˆ° bash å‘½ä»¤ã€‚</p><h4 id="ä¸ºè„šæœ¬æ·»åŠ è¿è¡Œæƒé™"><a href="#ä¸ºè„šæœ¬æ·»åŠ è¿è¡Œæƒé™" class="headerlink" title="ä¸ºè„šæœ¬æ·»åŠ è¿è¡Œæƒé™"></a>ä¸ºè„šæœ¬æ·»åŠ è¿è¡Œæƒé™</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">chmod</span> +x &lt;easyconnect æ–‡ä»¶è·¯å¾„&gt;</span><br></pre></td></tr></table></figure><blockquote><p>å›¾æ ‡å˜æˆä¸€ä¸ªé»‘è‰²çš„æ¡†æ¡†ï¼Œé‡Œé¢å†™ç€ <code>exec</code> å°±å¯¹äº†ã€‚</p></blockquote><h4 id="å¯¼å…¥æˆ‘çš„è„šæœ¬"><a href="#å¯¼å…¥æˆ‘çš„è„šæœ¬" class="headerlink" title="å¯¼å…¥æˆ‘çš„è„šæœ¬"></a>å¯¼å…¥æˆ‘çš„è„šæœ¬</h4><p>æŠŠ <code>easyconnect</code> æ”¾åˆ° <code>/usr/local/bin</code> æ–‡ä»¶å¤¹ä¸‹ã€‚</p><blockquote><p>è¿™ä¸ªç›®å½•å¯èƒ½éœ€è¦åœ¨è®¿è¾¾ä¸­æŒ‰ <kbd>Command</kdb> + <kbd>Shift</kdb> + <kbd>G</kdb> åè¾“å…¥ã€‚<br><img src="/img/use-easy-connect-safely-on-your-mac/go-to-bash-path.jpeg"></p></blockquote><h3 id="ä¸€åˆ‡å°±ç»ª"><a href="#ä¸€åˆ‡å°±ç»ª" class="headerlink" title="ä¸€åˆ‡å°±ç»ª"></a>ä¸€åˆ‡å°±ç»ª</h3><h4 id="å®‰å…¨åœ°å¯åŠ¨"><a href="#å®‰å…¨åœ°å¯åŠ¨" class="headerlink" title="å®‰å…¨åœ°å¯åŠ¨"></a>å®‰å…¨åœ°å¯åŠ¨</h4><ul><li>ä½¿ç”¨ EasyConnect çš„æ—¶å€™ï¼Œåªéœ€åœ¨ç»ˆç«¯è¾“å…¥è¿™è¡Œå‘½ä»¤ï¼š</li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">easyconnnect open</span><br></pre></td></tr></table></figure><article class="message is-danger">                <div class="message-body">            <p>åœ¨ä½¿ç”¨è¿‡ç¨‹ä¸­ä¸è¦å…³é—­ç»ˆç«¯çª—å£â€¼ï¸</p>        </div>    </article><p>è™½ç„¶ä½†æ˜¯ï¼Œ</p><p>ä½ å¯èƒ½ä¼šå‘ç°ï¼Œ<code>EasyMonitor</code> å’Œ <code>ECAgent</code> ä»ç„¶æ˜¯ä»¥ root æƒé™è¿è¡Œçš„ï¼Œ</p><p>å› æ­¤è¿˜éœ€è¦æ‰‹åŠ¨å…³é—­ä»–ä»¬ã€‚</p><h4 id="å½»åº•åœ°å…³é—­"><a href="#å½»åº•åœ°å…³é—­" class="headerlink" title="å½»åº•åœ°å…³é—­"></a>å½»åº•åœ°å…³é—­</h4><ul><li>æ–­å¼€ VPN åï¼Œé™¤äº†é€€å‡º <code>EasyConnect</code> æœ¬èº«ï¼Œéœ€è¦æ‰§è¡Œè¿™è¡Œå‘½ä»¤ï¼š</li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">easyconnect <span class="built_in">kill</span></span><br></pre></td></tr></table></figure><p>è¿™æ ·ä¸€æ¥ï¼Œåˆšæ‰å¯åŠ¨çš„ <code>EasyMonitor</code> å’Œ <code>ECAgent</code> å°±ä¼šè¢«å…³é—­ï¼Œ</p><p>ç”±äºæ²¡æœ‰åå°é©»ç•™çš„æƒé™ï¼Œä¹Ÿå°±ä¸ä¼šé‡æ–°å¯åŠ¨äº†ã€‚</p><p>æ•´ä¸ªæ–¹æ¡ˆæ˜¯<em>æŒ‰éœ€ä½¿ç”¨</em>çš„ç­–ç•¥ï¼Œå› ä¸º <code>EasyMonitor</code> å’Œ <code>ECAgent</code> æ˜¯åˆå§‹åŒ–æ—¶å¿…è¦çš„è¿›ç¨‹ã€‚</p><h4 id="å¿«æ·æŒ‡ä»¤"><a href="#å¿«æ·æŒ‡ä»¤" class="headerlink" title="å¿«æ·æŒ‡ä»¤"></a>å¿«æ·æŒ‡ä»¤</h4><p>å¦‚æœä½ è§‰å¾—æ•´ä¸ªè¿‡ç¨‹æ¯”è¾ƒå¤æ‚ï¼Œ</p><p>ä¹Ÿå¯ä»¥ä½¿ç”¨æˆ‘åˆ¶ä½œçš„å¿«æ·æŒ‡ä»¤ï¼š<a href="https://www.icloud.com/shortcuts/085b7d286bfe4c3b839b1deda8f3756c">Toggle Easy Connect</a> æ¥è®©è¿™ä¸€åˆ‡å˜å¾—è‡ªåŠ¨åŒ–ã€‚</p><p>å¿«æ·æŒ‡ä»¤ä¼šè‡ªåŠ¨æ£€æµ‹ <code>EasyMonitor</code> çš„è¿è¡Œæƒ…å†µæ¥ä½œä¸º <code>EasyConnect</code> æ˜¯å¦æ­£åœ¨è¿è¡Œçš„æ ‡å¿—ï¼Œ</p><p>è¿›è€Œè‡ªåŠ¨é€‰æ‹©åˆé€‚çš„å‘½ä»¤ã€‚</p><h3 id="ç–‘éš¾è§£ç­”"><a href="#ç–‘éš¾è§£ç­”" class="headerlink" title="ç–‘éš¾è§£ç­”"></a>ç–‘éš¾è§£ç­”</h3><ul><li>ç™»é™†ä¹‹åé—ªé€€</li></ul><p>é‡å¯ç”µè„‘å³å¯ã€‚è¿™æ˜¯ç”±äºæŸäº›ç»„å»ºå¯åŠ¨äº†å¤šæ¬¡åäº§ç”Ÿäº†å†²çªã€‚</p>]]></content>
    
    
    <summary type="html">&lt;p&gt;èµ·å› è¿˜æ˜¯å¶ç„¶åœ¨ B ç«™åˆ·åˆ°è¿™ä¹ˆä¸€ä¸ªè§†é¢‘ï¼š&lt;/p&gt;
&lt;iframe src=&quot;//player.bilibili.com/player.html?aid=435357348&amp;bvid=BV163411Z7BD&amp;cid=967016106&amp;page=1&quot; scrolling=&quot;no&quot; border=&quot;0&quot; frameborder=&quot;no&quot; framespacing=&quot;0&quot; allowfullscreen=&quot;true&quot;&gt; &lt;/iframe&gt;

&lt;p&gt;å“Ÿï¼ŒåŸæ¥æ˜¯ä¸ªæµæ°“è½¯ä»¶å•Šï¼Œè‰ï¼ï¼ï¼ï¼ï¼ï¼&lt;/p&gt;</summary>
    
    
    
    <category term="çæŠ˜è…¾" scheme="https://liyanan2004.github.io/categories/%E7%9E%8E%E6%8A%98%E8%85%BE/"/>
    
    
    <category term="ç½‘ç»œå®‰å…¨" scheme="https://liyanan2004.github.io/tags/%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8/"/>
    
    <category term="macOS" scheme="https://liyanan2004.github.io/tags/macOS/"/>
    
  </entry>
  
  <entry>
    <title>ç†è§£å‡½æ•°ä¸­çš„æ³›å‹ &amp; æ³›å‹çº¦æŸ â€”â€” ç©¶ç«Ÿè°æ‰æ˜¯å…¥å£ï¼Ÿ</title>
    <link href="https://liyanan2004.github.io/generic-type-function-entry-point/"/>
    <id>https://liyanan2004.github.io/generic-type-function-entry-point/</id>
    <published>2023-01-16T14:04:04.000Z</published>
    <updated>2023-01-16T15:59:27.000Z</updated>
    
    <content type="html"><![CDATA[<p>ç»§ç»­æ¥ä¸Šç¯‡ï¼Œåšå®Œ <code>AnyMyCollection</code> ä¹‹åï¼Œ</p><p>æˆ‘åˆæ·»åŠ äº†ä¸€ä¸ªæ‰©å±•æ¥ä¿®æ”¹ <code>CustomCollection</code> åœ¨ç‰¹å®šç±»å‹ä¸‹çš„è¡Œä¸ºï¼š</p><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">extension</span> <span class="title class_">CustomCollection</span> <span class="title class_">where</span> <span class="title class_">Element</span> == <span class="title class_">Int</span> &#123;</span><br><span class="line">    <span class="keyword">func</span> <span class="title function_">allValues</span>() -&gt; [<span class="type">Element</span>] &#123;</span><br><span class="line">        [<span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>]</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å½“ <code>Element</code> æ˜¯ <code>Int</code> æ—¶ï¼Œä¸ç®¡ä¸‰ä¸ƒäºŒåä¸€ï¼Œç›´æ¥è¿”å› <code>[4, 5, 6]</code></p><p>ä½†æ˜¯ï¼Œè¿è¡Œæ˜¯å‘ç°äº†è¿™æ ·çš„ç°è±¡ï¼š</p><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> collection <span class="operator">=</span> <span class="type">CustomCollection</span>(<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>)</span><br><span class="line"><span class="built_in">print</span>(collection.allValues()) <span class="comment">// [4, 5, 6]</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> <span class="keyword">any</span> <span class="operator">=</span> <span class="type">AnyMyCollection</span>(collection)</span><br><span class="line"><span class="built_in">print</span>(<span class="keyword">any</span>.allValues()) <span class="comment">// [1, 2, 3]</span></span><br></pre></td></tr></table></figure><span id="more"></span><p>åŒä¸€ä¸ªä¸œè¥¿ï¼Œæ“¦é™¤ç±»å‹ä¹‹åå°±ä¸å— <code>Element == Int</code> çº¦æŸäº†å˜›ï¼Ÿ<del>ä¸æ˜¯</del></p><p>å†™äº†ä¸€ä¸ªæœ€å°å¯å¤ç°é—®é¢˜çš„ä»£ç ï¼Œå¦‚ä¸‹ï¼š</p><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> collection <span class="operator">=</span> <span class="type">CustomCollection</span>(<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">func</span> <span class="title function_">genericFuntion</span>&lt;<span class="type">C</span>: <span class="type">MyCollection</span>&gt;(<span class="keyword">_</span> <span class="params">base</span>: <span class="type">C</span>) &#123;</span><br><span class="line">    <span class="built_in">print</span>(base.allValues()) <span class="comment">// [1, 2, 3]</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">genericFuntion(collection)</span><br></pre></td></tr></table></figure><p>é‡æ–°æ¥çœ‹è¿™ä¸ªå‡½æ•°ï¼Œ</p><p><code>base</code> æ˜¯ä¸€ä¸ªç¬¦åˆ <code>MyCollection</code> åè®®çš„ç±»å‹ï¼Œ</p><p>ä»ç¨‹åºçš„è§’åº¦çœ‹ï¼Œè°ƒç”¨å‡½æ•°çš„æ—¶å€™ï¼Œå®ƒä¼šå»æ‰¾ä¸€ä¸ªå…¥å£ï¼Œ</p><p>åœ¨è¿™é‡Œï¼Œå…¥å£å°±åº”è¯¥æ˜¯è®© <code>CustomCollection</code> ç¬¦åˆåè®®çš„é‚£ä¸ª <code>allValues()</code>ï¼Œ</p><p>è€Œ <code>Element == Int</code> çº¦æŸåˆ™å¯ä»¥ç†è§£ä¸ºï¼Œå½“ç¬¦åˆæ¡ä»¶æ—¶ï¼Œå¯¹ <code>allValues()</code> è¿›è¡Œé‡å†™ï¼Œ</p><p>è¿™é‡ŒçœŸæ­£è®© <code>CustomCollection</code> ç¬¦åˆ <code>MyCollection</code> çš„æ˜¯ä¸å—çº¦æŸçš„é‚£ä¸ªæ‰©å±•ä¸­çš„æ–¹æ³•ã€‚</p><blockquote><p>ä»”ç»†ä¸€æƒ³ï¼Œè²Œä¼¼å®é™…æ“ä½œä¸­è²Œä¼¼ä¸ä¼šè¿™æ ·â€œé‡å†™â€å‡½æ•°ï¼Œ</p><p>è€Œæ˜¯ä¼šå¯¹ä¸€äº›ç‰¹å®šçš„ç±»å‹å¢åŠ ä¸€ä¸ªç‰¹æ®Šçš„å‡½æ•°ï¼Œ</p><p>æ¯”å¦‚ï¼šå¯¹äºç±»å‹æ˜¯ <code>Int</code> çš„ <code>Array</code> å¢åŠ æ±‚å¹³å‡å€¼çš„å‡½æ•°ç­‰ç­‰ã€‚</p></blockquote>]]></content>
    
    
    <summary type="html">&lt;p&gt;ç»§ç»­æ¥ä¸Šç¯‡ï¼Œåšå®Œ &lt;code&gt;AnyMyCollection&lt;/code&gt; ä¹‹åï¼Œ&lt;/p&gt;
&lt;p&gt;æˆ‘åˆæ·»åŠ äº†ä¸€ä¸ªæ‰©å±•æ¥ä¿®æ”¹ &lt;code&gt;CustomCollection&lt;/code&gt; åœ¨ç‰¹å®šç±»å‹ä¸‹çš„è¡Œä¸ºï¼š&lt;/p&gt;
&lt;figure class=&quot;highlight swift&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;extension&lt;/span&gt; &lt;span class=&quot;title class_&quot;&gt;CustomCollection&lt;/span&gt; &lt;span class=&quot;title class_&quot;&gt;where&lt;/span&gt; &lt;span class=&quot;title class_&quot;&gt;Element&lt;/span&gt; == &lt;span class=&quot;title class_&quot;&gt;Int&lt;/span&gt; &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;func&lt;/span&gt; &lt;span class=&quot;title function_&quot;&gt;allValues&lt;/span&gt;() -&amp;gt; [&lt;span class=&quot;type&quot;&gt;Element&lt;/span&gt;] &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        [&lt;span class=&quot;number&quot;&gt;4&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;5&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;6&lt;/span&gt;]&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;

&lt;p&gt;å½“ &lt;code&gt;Element&lt;/code&gt; æ˜¯ &lt;code&gt;Int&lt;/code&gt; æ—¶ï¼Œä¸ç®¡ä¸‰ä¸ƒäºŒåä¸€ï¼Œç›´æ¥è¿”å› &lt;code&gt;[4, 5, 6]&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;ä½†æ˜¯ï¼Œè¿è¡Œæ˜¯å‘ç°äº†è¿™æ ·çš„ç°è±¡ï¼š&lt;/p&gt;
&lt;figure class=&quot;highlight swift&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;let&lt;/span&gt; collection &lt;span class=&quot;operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;type&quot;&gt;CustomCollection&lt;/span&gt;(&lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;2&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;3&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;built_in&quot;&gt;print&lt;/span&gt;(collection.allValues()) &lt;span class=&quot;comment&quot;&gt;// [4, 5, 6]&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;let&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;any&lt;/span&gt; &lt;span class=&quot;operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;type&quot;&gt;AnyMyCollection&lt;/span&gt;(collection)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;built_in&quot;&gt;print&lt;/span&gt;(&lt;span class=&quot;keyword&quot;&gt;any&lt;/span&gt;.allValues()) &lt;span class=&quot;comment&quot;&gt;// [1, 2, 3]&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;</summary>
    
    
    
    <category term="æ’¸ä»£ç " scheme="https://liyanan2004.github.io/categories/%E6%92%B8%E4%BB%A3%E7%A0%81/"/>
    
    
    <category term="Swift" scheme="https://liyanan2004.github.io/tags/Swift/"/>
    
    <category term="æ³›å‹" scheme="https://liyanan2004.github.io/tags/%E6%B3%9B%E5%9E%8B/"/>
    
  </entry>
  
  <entry>
    <title>Swift ä¸­çš„ç±»å‹æ“¦é™¤ï¼ˆä¸‹ï¼‰â€”â€” ä»æ¨¡ä»¿ä¸­å­¦ä¹ </title>
    <link href="https://liyanan2004.github.io/type-erasure-in-swift-2/"/>
    <id>https://liyanan2004.github.io/type-erasure-in-swift-2/</id>
    <published>2023-01-16T03:57:30.000Z</published>
    <updated>2023-01-16T07:31:58.000Z</updated>
    
    <content type="html"><![CDATA[<p>ä¸Šç¯‡åšå®¢ä¸­ï¼Œæˆ‘ä»¬åˆæ­¥äº†è§£äº†ä¸ºä»€ä¹ˆéœ€è¦ä¸€ä¸ª Type Eraser ï¼Œ</p><p>ä¹Ÿåˆ†äº«äº†ä¸€ä¸ªç®€å•å®ç° Type Erasure çš„æ–¹æ¡ˆã€‚</p><p>ä¸ºäº†æ›´åŠ æ·±å…¥äº†è§£ç±»å‹æ“¦é™¤ï¼Œæˆ‘ä»¬è¿˜æ˜¯å¾—æ¥çœ‹çœ‹ Swift è‡ªå¸¦çš„ä¸€äº› Type Eraser æ˜¯å¦‚ä½•å®ç°çš„ã€‚</p><p>ç›®æ ‡æ˜¯ï¼šç†è§£ä¸€ä¸‹å…¶åŸºæœ¬æ€è·¯ï¼Œå¹¶ä¸”ä»¿åˆ¶ä¸€ä¸ªå‡ºæ¥ã€‚</p><span id="more"></span><h2 id="åº•å±‚åŸç†"><a href="#åº•å±‚åŸç†" class="headerlink" title="åº•å±‚åŸç†"></a>åº•å±‚åŸç†</h2><p>ä¸ºäº†æ–¹ä¾¿ç†è§£ï¼Œæˆ‘ä»¬èšç„¦äºä¸€ä¸ª Type Eraserï¼š<code>AnyIterator</code></p><p>ä¸ºä»€ä¹ˆæ˜¯å®ƒå‘¢ï¼Ÿ</p><p>å› ä¸ºå®ƒå‡ºç°åœ¨<a href="https://github.com/apple/swift/blob/main/stdlib/public/core/ExistentialCollection.swift">æºç </a>çš„æœ€ä¸Šé¢ğŸ˜‚ï¼Œè€Œä¸”ä¸‹é¢çš„ <code>AnySequence</code> å’Œ <code>AnyCollection</code> éƒ½å¾—å›åˆ° <code>AnyIterator</code>ã€‚</p><p>å…ˆçœ‹æºç ï¼ˆæˆ‘è¿™é‡Œå»é™¤äº†æ³¨é‡Šå’Œä¸€äº›ä¸å¤ªé‡è¦çš„ä»£ç ï¼Œæ–¹ä¾¿å¤§å®¶é˜…è¯»ï¼‰ï¼š</p><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@inline</span>(never)</span><br><span class="line"><span class="keyword">@usableFromInline</span></span><br><span class="line"><span class="keyword">internal</span> <span class="keyword">func</span> <span class="title function_">_abstract</span>(</span><br><span class="line">  <span class="params">file</span>: <span class="type">StaticString</span> <span class="operator">=</span> <span class="keyword">#file</span>,</span><br><span class="line">  <span class="params">line</span>: <span class="type">UInt</span> <span class="operator">=</span> <span class="keyword">#line</span></span><br><span class="line">) -&gt; <span class="type">Never</span> &#123;</span><br><span class="line">  <span class="built_in">fatalError</span>(<span class="string">&quot;Method must be overridden&quot;</span>, file: file, line: line)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">struct</span> <span class="title class_">AnyIterator</span>&lt;<span class="title class_">Element</span>&gt; &#123;</span><br><span class="line">  <span class="keyword">@usableFromInline</span></span><br><span class="line">  <span class="keyword">internal</span> <span class="keyword">let</span> _box: _AnyIteratorBoxBase<span class="operator">&lt;</span><span class="type">Element</span><span class="operator">&gt;</span></span><br><span class="line"></span><br><span class="line">  <span class="keyword">@inlinable</span></span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">init</span>&lt;<span class="type">I</span>: <span class="type">IteratorProtocol</span>&gt;(<span class="keyword">_</span> <span class="params">base</span>: <span class="type">I</span>) <span class="keyword">where</span> <span class="type">I</span>.<span class="type">Element</span> <span class="operator">==</span> <span class="type">Element</span> &#123;</span><br><span class="line">    <span class="keyword">self</span>._box <span class="operator">=</span> _IteratorBox(base)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">extension</span> <span class="title class_">AnyIterator</span>: <span class="title class_">IteratorProtocol</span> &#123;</span><br><span class="line">  <span class="keyword">@inlinable</span></span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">func</span> <span class="title function_">next</span>() -&gt; <span class="type">Element</span>? &#123;</span><br><span class="line">    <span class="keyword">return</span> _box.next()</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">@_fixed_layout</span></span><br><span class="line"><span class="keyword">@usableFromInline</span></span><br><span class="line"><span class="keyword">internal</span> <span class="keyword">class</span> <span class="title class_">_AnyIteratorBoxBase</span>&lt;<span class="title class_">Element</span>&gt;: <span class="title class_">IteratorProtocol</span> &#123;</span><br><span class="line">  <span class="keyword">@inlinable</span> <span class="comment">// FIXME(sil-serialize-all)</span></span><br><span class="line">  <span class="keyword">internal</span> <span class="keyword">init</span>() &#123;&#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">@inlinable</span> <span class="comment">// FIXME(sil-serialize-all)</span></span><br><span class="line">  <span class="keyword">deinit</span> &#123;&#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">@inlinable</span> <span class="comment">// FIXME(sil-serialize-all)</span></span><br><span class="line">  <span class="keyword">internal</span> <span class="keyword">func</span> <span class="title function_">next</span>() -&gt; <span class="type">Element</span>? &#123; _abstract() &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">@_fixed_layout</span></span><br><span class="line"><span class="keyword">@usableFromInline</span></span><br><span class="line"><span class="keyword">internal</span> <span class="keyword">final</span> <span class="keyword">class</span> <span class="title class_">_IteratorBox</span>&lt;<span class="title class_">Base</span>: <span class="title class_">IteratorProtocol</span>&gt;</span><br><span class="line">  : <span class="title class_">_AnyIteratorBoxBase</span>&lt;<span class="title class_">Base</span>.<span class="title class_">Element</span>&gt; &#123;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">@inlinable</span></span><br><span class="line">  <span class="keyword">internal</span> <span class="keyword">init</span>(<span class="keyword">_</span> <span class="params">base</span>: <span class="type">Base</span>) &#123; <span class="keyword">self</span>._base <span class="operator">=</span> base &#125;</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">@inlinable</span> <span class="comment">// FIXME(sil-serialize-all)</span></span><br><span class="line">  <span class="keyword">deinit</span> &#123;&#125;</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">@inlinable</span></span><br><span class="line">  <span class="keyword">internal</span> <span class="keyword">override</span> <span class="keyword">func</span> <span class="title function_">next</span>() -&gt; <span class="type">Base</span>.<span class="type">Element</span>? &#123; <span class="keyword">return</span> _base.next() &#125;</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">@usableFromInline</span></span><br><span class="line">  <span class="keyword">internal</span> <span class="keyword">var</span> _base: <span class="type">Base</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æ•´ç†ä¸€ä¸‹ï¼Œä¸€å…±ç”¨åˆ°ä¸¤ä¸ªç±»ï¼Œ<code>_AnyIteratorBoxBase</code>ï¼ˆåŸºç±»ï¼‰ å’Œ <code>_IteratorBox</code>ï¼ˆä¸­è½¬ç±»ï¼‰</p><p>åŸºç±»ç¬¦åˆåè®®ï¼Œå¹¶ä¸”ç”¨ä¸€äº›å ä½ç¬¦åšå¥½å¡«å……ï¼ˆéœ€è¦åœ¨ä¸­è½¬ç±»ä¸­é‡å†™è¿™äº›æ–¹æ³•ï¼‰</p><p>ä¸­è½¬ç±»ç»§æ‰¿è‡ªåŸºç±»ï¼Œå¹¶ä»å¤–éƒ¨æ¥æ”¶ä¸€ä¸ªç¬¦åˆåè®®çš„å®ä¾‹ï¼Œç”¨æ¥é‡å†™ï¼ˆè¦†ç›–ï¼‰åŸºç±»ä¸­çš„æ–¹æ³•å’Œå±æ€§ã€‚</p><p>æœ€åï¼Œç”¨ä¸€ä¸ªå¯¹å¤–çš„ Type Eraser å†åšä¸€æ¬¡ä¸­è½¬ã€‚</p><h2 id="ä»¿åˆ¶è¿‡ç¨‹ä¸­çš„ä¸€äº›å‘"><a href="#ä»¿åˆ¶è¿‡ç¨‹ä¸­çš„ä¸€äº›å‘" class="headerlink" title="ä»¿åˆ¶è¿‡ç¨‹ä¸­çš„ä¸€äº›å‘"></a>ä»¿åˆ¶è¿‡ç¨‹ä¸­çš„ä¸€äº›å‘</h2><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// MARK: - Protocol and Type Eraser</span></span><br><span class="line"><span class="keyword">protocol</span> <span class="title class_">MyCollection</span> &#123; <span class="operator">â€¦</span> &#125;</span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">AnyMyCollection</span>&lt;<span class="title class_">Element</span>&gt; &#123; <span class="operator">â€¦</span> &#125;</span><br><span class="line"><span class="keyword">extension</span> <span class="title class_">AnyMyCollection</span>: <span class="title class_">MyCollection</span> &#123; <span class="operator">â€¦</span> &#125;</span><br><span class="line"><span class="operator">â€¦</span></span><br><span class="line"><span class="comment">// MARK: - Custom Types</span></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">Animals</span>: <span class="title class_">MyCollection</span> &#123; <span class="operator">â€¦</span> &#125;</span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">Digits</span>: <span class="title class_">MyCollection</span> &#123; <span class="operator">â€¦</span> &#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// MARK: - Type Erasure</span></span><br><span class="line"><span class="comment">// âŒ Heterogeneous collection literal could only be inferred to &#x27;[Any]&#x27;; add explicit type annotation if this is intentional</span></span><br><span class="line"><span class="keyword">var</span> collections <span class="operator">=</span> [<span class="type">AnyMyCollection</span>(<span class="type">Animals</span>()), <span class="type">AnyMyCollection</span>(<span class="type">Digits</span>())] </span><br></pre></td></tr></table></figure><p>é¦–å…ˆï¼Œæˆ‘æ³¨æ„åˆ°çš„æ˜¯ç±»å‹æ¨æ–­çš„é—®é¢˜ï¼Œ</p><p>å¯ä»¥å°è¯•ä¸‹ <code>AnyCollection</code>ï¼Œ<code>AnyIterator</code> è¿™äº›ï¼Œå‘ç° <code>collections</code> ä¸­çš„ Element å˜æˆäº† <code>Any</code>ï¼Œ</p><p>ä¹Ÿå°±å¼•å‡ºäº†ç¬¬ä¸€ä¸ªé—®é¢˜ã€‚</p><h3 id="Swift-çš„ç‰¹æ€§ä¹‹ä¸€ï¼šç±»å‹æ¨æ–­"><a href="#Swift-çš„ç‰¹æ€§ä¹‹ä¸€ï¼šç±»å‹æ¨æ–­" class="headerlink" title="Swift çš„ç‰¹æ€§ä¹‹ä¸€ï¼šç±»å‹æ¨æ–­"></a>Swift çš„ç‰¹æ€§ä¹‹ä¸€ï¼šç±»å‹æ¨æ–­</h3><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Type: AnyIterator&lt;Int&gt;</span></span><br><span class="line"><span class="type">AnyIterator</span>([<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>].makeIterator())</span><br><span class="line"></span><br><span class="line"><span class="comment">// Type: AnyIterator&lt;String&gt;</span></span><br><span class="line"><span class="type">AnyIterator</span>([<span class="string">&quot;a&quot;</span>, <span class="string">&quot;b&quot;</span>, <span class="string">&quot;c&quot;</span>].makeIterator())</span><br><span class="line"></span><br><span class="line"><span class="comment">// Type: [AnyIterator&lt;Any&gt;]</span></span><br><span class="line">[<span class="type">AnyIterator</span>([<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>].makeIterator()), <span class="type">AnyIterator</span>([<span class="string">&quot;a&quot;</span>, <span class="string">&quot;b&quot;</span>, <span class="string">&quot;c&quot;</span>].makeIterator())]</span><br></pre></td></tr></table></figure><p>è¿™ä¿©ä¸œè¥¿çš„ Element ç±»å‹ä¸ä¸€è‡´ï¼Œä¸ºä»€ä¹ˆæ”¾åœ¨ä¸€èµ·è¿˜èƒ½ç¼–è¯‘å¹¶ä¸” Element å˜æˆ <code>Any</code> äº†å‘¢ï¼Ÿ</p><p>å®é™…ä¸Šï¼Œæ˜¯ Swift çš„ç±»å‹æ¨æ–­åœ¨å¹²æ´»</p><p>è€Œå¦‚æœæ¢ä¸€ç§å†™æ³•ï¼š</p><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> intIterator <span class="operator">=</span> <span class="type">AnyIterator</span>([<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>].makeIterator())</span><br><span class="line"><span class="keyword">let</span> stringIterator <span class="operator">=</span> <span class="type">AnyIterator</span>([<span class="string">&quot;a&quot;</span>, <span class="string">&quot;b&quot;</span>, <span class="string">&quot;c&quot;</span>].makeIterator())</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> together <span class="operator">=</span> [intIterator, stringIterator] <span class="comment">// âŒ Heterogeneous collection literal could only be inferred to &#x27;[Any]&#x27;; add explicit type annotation if this is intentional</span></span><br></pre></td></tr></table></figure><p>å°±ä¼šæŠ¥é”™ï¼ŒåŸå› å°±åœ¨äºè¿™ä¸¤ä¸ªä¸œè¥¿çš„ç±»å‹ä¸ä¸€è‡´ï¼Œä¸èƒ½æ”¾åœ¨ä¸€ä¸ª Array é‡Œï¼Œ</p><blockquote><p>æå‰å£°æ˜çš„è¯ï¼Œç¼–è¯‘å™¨ä¼šå›ºåŒ–ç±»å‹ï¼Œæ˜¯ä»€ä¹ˆå°±æ˜¯ä»€ä¹ˆ</p><p><code>AnyIterator&lt;String&gt;</code> å’Œ <code>AnyIterator&lt;Int&gt;</code> æ˜¯ä¸¤ç§ä¸åŒçš„ç±»å‹ï¼Œå®ƒä»¬çš„ Element ä¸åŒ</p></blockquote><p>æ›´åŠ è¯¦ç»†çš„å¯ä»¥çœ‹æˆ‘é—®çš„è¿™ä¸ªå¸–å­ï¼š<a href="https://forums.swift.org/t/anycollection-with-different-generic-types/62558">AnyCollection with different generic types</a> </p><hr><p>å¯¹ <code>Array</code> å†åšä¸€ä¸ªæ‰©å±•ï¼Œè®©ä»»ä½•æ•°ç»„éƒ½ç¬¦åˆåè®®ã€‚</p><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">extension</span> <span class="title class_">Array</span>: <span class="title class_">MyCollection</span> &#123;</span><br><span class="line">    <span class="keyword">func</span> <span class="title function_">allValues</span>() -&gt; [<span class="type">Element</span>] &#123; <span class="keyword">self</span> &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> arrayCollection <span class="operator">=</span> [<span class="type">AnyMyCollection</span>([<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>]), <span class="type">AnyMyCollection</span>([<span class="string">&quot;a&quot;</span>, <span class="string">&quot;b&quot;</span>])] <span class="comment">// âœ… AnyMyCollection&lt;Any&gt;</span></span><br></pre></td></tr></table></figure><p>è¿™é‡Œçš„ä¸¤ä¸ªç±»å‹åˆ†åˆ«æ˜¯ï¼š<code>AnyMyCollection&lt;Int&gt;</code> å’Œ <code>AnyMyCollection&lt;String&gt;</code></p><p>ä½†æ˜¯å†åŠ ä¸Š <code>Digits</code> å´æŠ¥é”™äº†ã€‚</p><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// âŒ Heterogeneous collection literal could only be inferred to &#x27;[Any]&#x27;; add explicit type annotation if this is intentional</span></span><br><span class="line"><span class="keyword">let</span> collection <span class="operator">=</span> [<span class="type">AnyMyCollection</span>(<span class="type">Digits</span>()), <span class="type">AnyMyCollection</span>([<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>]), <span class="type">AnyMyCollection</span>([<span class="string">&quot;a&quot;</span>, <span class="string">&quot;b&quot;</span>])]</span><br></pre></td></tr></table></figure><p>è¿™å°±æ˜¯ç¬¬äºŒä¸ªé—®é¢˜ã€‚</p><h3 id="ç¼–è¯‘æ—¶æ¨æ–­-å’Œ-è¿è¡Œæ—¶æ¨æ–­"><a href="#ç¼–è¯‘æ—¶æ¨æ–­-å’Œ-è¿è¡Œæ—¶æ¨æ–­" class="headerlink" title="ç¼–è¯‘æ—¶æ¨æ–­ å’Œ è¿è¡Œæ—¶æ¨æ–­"></a>ç¼–è¯‘æ—¶æ¨æ–­ å’Œ è¿è¡Œæ—¶æ¨æ–­</h3><p>åˆ†æä¸€ä¸‹æ¯ä¸€ä¸ª <code>AnyMyCollection </code> çš„ç±»å‹ï¼š</p><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// AnyMyCollection&lt;Digits.Element&gt;</span></span><br><span class="line"><span class="type">AnyMyCollection</span>(<span class="type">Digits</span>())</span><br><span class="line"></span><br><span class="line"><span class="comment">// AnyMyCollection&lt;Int&gt;</span></span><br><span class="line"><span class="type">AnyMyCollection</span>([<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>])</span><br><span class="line"></span><br><span class="line"><span class="comment">// AnyMyCollection&lt;String&gt;</span></span><br><span class="line"><span class="type">AnyMyCollection</span>([<span class="string">&quot;a&quot;</span>, <span class="string">&quot;b&quot;</span>])</span><br></pre></td></tr></table></figure><p>æŒ‰ç…§ä¹‹å‰è¯´çš„ï¼Œåº”è¯¥ç»Ÿä¸€æˆ <code>AnyMyCollection&lt;Any&gt;</code> æ‰å¯¹ï¼Œ</p><p>ä½†æ˜¯ï¼Œä»”ç»†è§‚å¯Ÿèƒ½å¤Ÿå‘ç°ï¼Œä¼ å…¥ <code>AnyMyCollection</code> çš„ç±»å‹åˆ†åˆ«æ˜¯ <code>Digits</code>, <code>Array&lt;Int&gt;</code> å’Œ <code>Array&lt;String&gt;</code>ï¼Œ</p><p>ç¬¬ä¸€ä¸ªä¸å¸¦æ³›å‹ï¼Œè€Œå…¶ä»–çš„å‡å¸¦æ³›å‹ï¼Œ</p><p>å¯¹äº <code>Array&lt;Element&gt;</code> æ¥è¯´ï¼Œç¼–è¯‘æ—¶æ˜¯å¯ä»¥ç¡®å®š Element çš„å…·ä½“ç±»å‹çš„,</p><p>ä¸” <code>Array</code> ä¸­çš„ <code>Element</code> å’Œ <code>MyCollection</code> ä¸­çš„ <code>Element</code> æ˜¯ä¸€è‡´çš„ï¼Œ</p><p>å› æ­¤ï¼Œç¼–è¯‘æ—¶å¯ä»¥ç¡®å®šå‡º <code>AnyMyCollection</code> ä¸­çš„ <code>Element</code>ï¼ˆå³ <code>Array</code> ä¸­çš„ <code>Element</code>ï¼‰çš„ç±»å‹ã€‚</p><p>ä½†å¯¹äº <code>Digits</code> æ¥è¯´ï¼Œç”±äºå…¶æœ¬èº«æ²¡æœ‰æ³›å‹ï¼Œæ‰€ä»¥ <code>Element</code> äº‹å®ä¸Šæ˜¯è¢«â€œéšè—â€èµ·æ¥çš„ï¼Œ</p><p>ç¼–è¯‘å™¨æ— æ³•æ¨æ–­å…¶ç±»å‹ï¼Œå› æ­¤ä¸èƒ½è‡ªåŠ¨å˜æˆ <code>Any</code>ã€‚</p><p><img src="/img/type-erasure-in-swift/non-generic-compiletime-infer.jpeg"></p><blockquote><p>ç›´åˆ°è¿è¡Œæ—¶æ‰èƒ½ç¡®å®šå‡º <code>Digits.Element</code> çš„å…·ä½“ç±»å‹æ˜¯ <code>Int</code></p><p><img src="/img/type-erasure-in-swift/non-generic-runtime-infer.jpeg"></p></blockquote><p>æœ‰è§£å†³åŠæ³•å˜›ï¼Ÿæœ‰ã€‚</p><p>å°±æ˜¯ç»™ <code>Digits</code> åŠ ä¸Š Element çš„æ³›å‹ã€‚</p><blockquote><p>ä½†æ˜¯åŠ ä¸Šæ³›å‹å†å»é™å®šåªèƒ½æ˜¯ <code>Int</code> å°±æœ‰ç‚¹è„±è£¤å­æ”¾å±çš„æ„Ÿè§‰äº†ğŸ˜‚</p></blockquote><p>æœ€ç»ˆæˆ‘æŠŠå®ƒå˜æˆäº†ä¸€ä¸ª <code>CustomCollection</code></p><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">struct</span> <span class="title class_">CustomCollection</span>&lt;<span class="title class_">Element</span>&gt; &#123;</span><br><span class="line">    <span class="keyword">internal</span> <span class="keyword">var</span> content: [<span class="type">Element</span>] <span class="operator">=</span> []</span><br><span class="line">    <span class="keyword">init</span>(<span class="keyword">_</span> <span class="params">content</span>: <span class="type">Element</span>...) &#123;</span><br><span class="line">        <span class="keyword">self</span>.content.append(contentsOf: content)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">extension</span> <span class="title class_">CustomCollection</span>: <span class="title class_">MyCollection</span> &#123;</span><br><span class="line">    <span class="keyword">func</span> <span class="title function_">allValues</span>() -&gt; [<span class="type">Element</span>] &#123;</span><br><span class="line">        content</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="AnyMyCollection"><a href="#AnyMyCollection" class="headerlink" title="AnyMyCollection"></a>AnyMyCollection</h2><p>ä¸Šé¢ä¸¤ä¸ªé—®é¢˜ç ”ç©¶é€å½»ä¹‹åï¼Œä» Protocol åˆ° Type Eraser çš„ä»¿åˆ¶ä¹Ÿå°±å®Œæˆäº†ã€‚</p><p>æœ€ç»ˆä»£ç å¦‚ä¸‹ï¼š</p><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">protocol</span> <span class="title class_">MyCollection</span>&lt;<span class="title class_">Element</span>&gt; &#123;</span><br><span class="line">    <span class="keyword">associatedtype</span> <span class="type">Element</span></span><br><span class="line">    <span class="keyword">func</span> <span class="title function_">allValues</span>() -&gt; [<span class="type">Element</span>]</span><br><span class="line">&#125;</span><br><span class="line">    </span><br><span class="line"><span class="comment">// MARK: - AnyMyCollection</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">AnyMyCollection</span>&lt;<span class="title class_">Element</span>&gt; &#123;</span><br><span class="line">    <span class="keyword">internal</span> <span class="keyword">var</span> _box: _AnyMyCollectionBase<span class="operator">&lt;</span><span class="type">Element</span><span class="operator">&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">init</span>&lt;<span class="type">C</span>: <span class="type">MyCollection</span>&gt;(<span class="keyword">_</span> <span class="params">base</span>: <span class="type">C</span>) <span class="keyword">where</span> <span class="type">Element</span> <span class="operator">==</span> <span class="type">C</span>.<span class="type">Element</span> &#123;</span><br><span class="line">        _box <span class="operator">=</span> _MyCollectionBox(base)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">extension</span> <span class="title class_">AnyMyCollection</span>: <span class="title class_">MyCollection</span> &#123;</span><br><span class="line">    <span class="keyword">func</span> <span class="title function_">allValues</span>() -&gt; [<span class="type">Element</span>] &#123;</span><br><span class="line">        _box.allValues()</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">final</span> <span class="keyword">class</span> <span class="title class_">_MyCollectionBox</span>&lt;<span class="title class_">Base</span>: <span class="title class_">MyCollection</span>&gt;: <span class="title class_">_AnyMyCollectionBase</span>&lt;<span class="title class_">Base</span>.<span class="title class_">Element</span>&gt; &#123;</span><br><span class="line">    <span class="keyword">init</span>(<span class="keyword">_</span> <span class="params">base</span>: <span class="type">Base</span>) &#123;</span><br><span class="line">        _base <span class="operator">=</span> base</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">var</span> _base: <span class="type">Base</span></span><br><span class="line">    <span class="keyword">override</span> <span class="keyword">func</span> <span class="title function_">allValues</span>() -&gt; [<span class="type">Base</span>.<span class="type">Element</span>] &#123;</span><br><span class="line">        <span class="keyword">return</span> _base.allValues()</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">_AnyMyCollectionBase</span>&lt;<span class="title class_">Element</span>&gt;: <span class="title class_">MyCollection</span> &#123;</span><br><span class="line">    <span class="keyword">func</span> <span class="title function_">allValues</span>() -&gt; [<span class="type">Element</span>] &#123;</span><br><span class="line">        <span class="built_in">fatalError</span>(<span class="string">&quot;This method should be overwritten. Line 35.&quot;</span>)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">extension</span> <span class="title class_">Array</span>: <span class="title class_">MyCollection</span> &#123;</span><br><span class="line">    <span class="keyword">func</span> <span class="title function_">allValues</span>() -&gt; [<span class="type">Element</span>] &#123; <span class="keyword">self</span> &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// - MARK: Custom Collection</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">CustomCollection</span>&lt;<span class="title class_">Element</span>&gt; &#123;</span><br><span class="line">    <span class="keyword">internal</span> <span class="keyword">var</span> content: [<span class="type">Element</span>] <span class="operator">=</span> []</span><br><span class="line">    <span class="keyword">init</span>(<span class="keyword">_</span> <span class="params">content</span>: <span class="type">Element</span>...) &#123; <span class="keyword">self</span>.content.append(contentsOf: content) &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">extension</span> <span class="title class_">CustomCollection</span>: <span class="title class_">MyCollection</span> &#123;</span><br><span class="line">    <span class="keyword">func</span> <span class="title function_">allValues</span>() -&gt; [<span class="type">Element</span>] &#123; content &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> collections <span class="operator">=</span> [<span class="type">AnyMyCollection</span>(<span class="type">CustomCollection</span>(<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>)), <span class="type">AnyMyCollection</span>([<span class="string">&quot;a&quot;</span>, <span class="string">&quot;b&quot;</span>])]</span><br></pre></td></tr></table></figure><h2 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h2><p>æ•´ä¸ªè¿‡ç¨‹è€—è´¹äº†å·®ä¸è¿‡ä¸¤å¤©çš„æ—¶é—´ï¼Œæœ€é‡è¦çš„æ˜¯è¦ç†è§£è¿™ä¸€ç§ Type Eraser çš„åŸºæœ¬åŸç†å’Œå®ç°ï¼Œ</p><p>è¸©è¸©å‘ï¼Œæ›´èƒ½åŠ æ·±å°è±¡ğŸ¥²</p><p>ä¸è¿‡ Swift 5.7 æœ‰äº† <code>any</code> å…³é”®å­—ï¼Œä¸çŸ¥é“èƒ½ä¸èƒ½å–ä»£æ‰ Type Eraserï¼ŒæœŸå¾…ä¸€ä¸‹ Swift 6ã€‚</p>]]></content>
    
    
    <summary type="html">&lt;p&gt;ä¸Šç¯‡åšå®¢ä¸­ï¼Œæˆ‘ä»¬åˆæ­¥äº†è§£äº†ä¸ºä»€ä¹ˆéœ€è¦ä¸€ä¸ª Type Eraser ï¼Œ&lt;/p&gt;
&lt;p&gt;ä¹Ÿåˆ†äº«äº†ä¸€ä¸ªç®€å•å®ç° Type Erasure çš„æ–¹æ¡ˆã€‚&lt;/p&gt;
&lt;p&gt;ä¸ºäº†æ›´åŠ æ·±å…¥äº†è§£ç±»å‹æ“¦é™¤ï¼Œæˆ‘ä»¬è¿˜æ˜¯å¾—æ¥çœ‹çœ‹ Swift è‡ªå¸¦çš„ä¸€äº› Type Eraser æ˜¯å¦‚ä½•å®ç°çš„ã€‚&lt;/p&gt;
&lt;p&gt;ç›®æ ‡æ˜¯ï¼šç†è§£ä¸€ä¸‹å…¶åŸºæœ¬æ€è·¯ï¼Œå¹¶ä¸”ä»¿åˆ¶ä¸€ä¸ªå‡ºæ¥ã€‚&lt;/p&gt;</summary>
    
    
    
    <category term="æ’¸ä»£ç " scheme="https://liyanan2004.github.io/categories/%E6%92%B8%E4%BB%A3%E7%A0%81/"/>
    
    
    <category term="Swift" scheme="https://liyanan2004.github.io/tags/Swift/"/>
    
    <category term="æ³›å‹" scheme="https://liyanan2004.github.io/tags/%E6%B3%9B%E5%9E%8B/"/>
    
    <category term="ç±»å‹æ“¦é™¤" scheme="https://liyanan2004.github.io/tags/%E7%B1%BB%E5%9E%8B%E6%93%A6%E9%99%A4/"/>
    
  </entry>
  
  <entry>
    <title>Swift ä¸­çš„ç±»å‹æ“¦é™¤ï¼ˆä¸Šï¼‰â€”â€” ä¸ºä»€ä¹ˆ &amp; æ€ä¹ˆåš</title>
    <link href="https://liyanan2004.github.io/type-erasure-in-swift/"/>
    <id>https://liyanan2004.github.io/type-erasure-in-swift/</id>
    <published>2023-01-13T14:04:01.000Z</published>
    <updated>2023-01-16T07:30:14.000Z</updated>
    
    <content type="html"><![CDATA[<p>æ¢ç´¢ç±»å‹æ“¦é™¤çš„åŸç†å’Œå®ç°ï¼Œå¸¸è§çš„ç±»å‹æ©¡çš®æ“¦æœ‰ï¼šAnyViewã€AnyShapeã€AnyCollectionâ€¦</p><span id="more"></span><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">protocol</span> <span class="title class_">Tool</span> &#123;</span><br><span class="line">    <span class="keyword">associatedtype</span> <span class="type">S</span>: <span class="type">StringProtocol</span></span><br><span class="line">    <span class="keyword">func</span> <span class="title function_">name</span>() -&gt; <span class="type">S</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>é€šè¿‡è¿™ä¸ªåè®®ï¼ˆæˆ–è€…å«æ¥å£ï¼‰å¯ä»¥åˆ›å»ºä¸€ä¸ª Tool </p><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">struct</span> <span class="title class_">Pen</span>: <span class="title class_">Tool</span> &#123;</span><br><span class="line">    <span class="keyword">func</span> <span class="title function_">name</span>() -&gt; <span class="keyword">some</span> <span class="type">StringProtocol</span> &#123;</span><br><span class="line">        <span class="string">&quot;Pen&quot;</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">Pencil</span>: <span class="title class_">Tool</span> &#123;</span><br><span class="line">    <span class="keyword">func</span> <span class="title function_">name</span>() -&gt; <span class="keyword">some</span> <span class="type">StringProtocol</span> &#123;</span><br><span class="line">        <span class="string">&quot;Pencil&quot;</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">Ruler</span>: <span class="title class_">Tool</span> &#123;</span><br><span class="line">    <span class="keyword">func</span> <span class="title function_">name</span>() -&gt; <span class="keyword">some</span> <span class="type">StringProtocol</span> &#123;</span><br><span class="line">        <span class="string">&quot;Ruler&quot;</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æ¥ä¸‹æ¥ï¼Œæˆ‘è¦åˆ›å»ºä¸€ä¸ª <code>ToolController</code> æ¥ç®¡ç†æˆ‘çš„â€œå·¥å…·ä»¬â€ï¼Œ</p><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">ToolController</span> &#123;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æˆ‘ä»¬å…ˆæ¥è·å–æ‰€æœ‰å·¥å…·ï¼Œä½†æ˜¯é‡åˆ°ä¸€ä¸ªé—®é¢˜ï¼Œ</p><p>è¿™é‡Œè™½ç„¶åªæœ‰ä¸‰ä¸ªå·¥å…·ï¼Œå¯ä»¥ä¸€ä¸ªä¸ªå†™ï¼Œ</p><p>ä½†æ˜¯è¿™åªæ˜¯ä¸ªä¾‹å­ï¼Œåœ¨å®é™…åº”ç”¨ä¸­è¿™é‡Œçš„æ•°é‡æ˜¯æœªçŸ¥çš„ï¼Œ</p><p>åº”è¯¥å¦‚ä½•è·å–æ‰€æœ‰çš„å·¥å…·å‘¢ï¼Ÿå¤§è‡´æ€è·¯æ˜¯è¿™æ ·çš„ã€‚</p><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> tools: [<span class="type">Tool</span>] <span class="operator">=</span> [<span class="type">Pen</span>(), <span class="type">Pencil</span>(), <span class="type">Ruler</span>()]</span><br></pre></td></tr></table></figure><p>ä½†æ˜¯ï¼Œ<code>Tool</code> ä¸­æœ‰ <code>associatedtype</code>ï¼Œå› æ­¤ <strong><code>Tool</code> ä¸èƒ½å½“ä½œç±»å‹æ¥ä½¿ç”¨</strong>ï¼Œ</p><p>å¥½æ¶ˆæ¯æ˜¯ï¼Œåœ¨ Swift 5.7 æˆ–æ›´æ–°ç‰ˆæœ¬ä¸­ï¼Œå¯ä»¥ä½¿ç”¨ <code>any Tool</code> æ¥ä½œä¸ºç±»å‹ï¼Œ</p><p>ä½†æ˜¯ä¹‹åçš„æ‰€æœ‰ç»“æœéƒ½å¸¦æœ‰ <code>any</code>ï¼Œå¯èƒ½ä¸ä¼šæ˜¯ä½ é¢„æœŸçš„ç»“æœã€‚</p><blockquote><p>æ¯”å¦‚ <code>any View</code> ä¸ç¬¦åˆ <code>View</code> åè®®â€¦</p></blockquote><p>é™¤äº†è¿™æ ·çš„æ•°ç»„åˆ›å»ºå’Œä½¿ç”¨ä¸Šå¯èƒ½ä¼šå—é˜»ï¼Œåœ¨å¤šåˆ†æ”¯è¿”å›æ˜¯ä¹Ÿä¼šå‡ºé—®é¢˜ã€‚</p><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">ToolController</span> &#123;</span><br><span class="line">    <span class="keyword">var</span> currentTool <span class="operator">=</span> <span class="string">&quot;pen&quot;</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment">// âŒ Function declares an opaque return type &#x27;some Tool&#x27;, but the return statements in its body do not have matching underlying types.</span></span><br><span class="line">    <span class="keyword">func</span> <span class="title function_">getCurrentTool</span>() -&gt; <span class="keyword">some</span> <span class="type">Tool</span> &#123; </span><br><span class="line">        <span class="keyword">switch</span> currentTool &#123;</span><br><span class="line">        <span class="keyword">case</span> <span class="string">&quot;pen&quot;</span>: <span class="keyword">return</span> <span class="type">Pen</span>()</span><br><span class="line">        <span class="keyword">case</span> <span class="string">&quot;ruler&quot;</span>: <span class="keyword">return</span> <span class="type">Ruler</span>()</span><br><span class="line">        <span class="keyword">default</span>: <span class="keyword">return</span> <span class="type">Pencil</span>()</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p><code>some</code> å…³é”®å­—è¡¨ç¤ºä¸é€æ˜çš„ç±»å‹ï¼ˆopaque typeï¼‰ï¼Œ</p><p>æˆ‘ä»¬åªéœ€è¦çŸ¥é“ä»–æ˜¯ä¸€ä¸ªç¬¦åˆ <code>Tool</code> åè®®çš„ä¸œè¥¿ï¼Œ</p><p>ä½†æ˜¯å…·ä½“æ˜¯ä»€ä¹ˆä¸çŸ¥é“ï¼Œä¹Ÿä¸å…³å¿ƒæ˜¯ä»€ä¹ˆï¼Œäº¤ç»™ç¼–è¯‘å™¨å»æ¨æ–­ã€‚</p></blockquote><p>å› ä¸ºåœ¨ä¸‰ä¸ª case ä¸­è¿”å›çš„ç»“æœç±»å‹ä¸ä¸€è‡´ï¼Œç¼–è¯‘æ—¶æ— æ³•æ¨æ–­ <code>Tool</code> çš„ç±»å‹ï¼Œ</p><p>è€Œä¸‰ä¸ªåˆ†æ”¯ä¸­ä½¿ç”¨çš„ Tool æ˜¯å®Œå…¨ä¸åŒçš„ä¸œè¥¿ï¼Œä¸èƒ½ç›´æ¥æ›¿æ¢ã€‚</p><p>å¦‚æœè¿˜æœ‰æ›´å¤šåˆ†æ”¯çš„è¯æƒ…å†µä¼šæ›´åŠ å¤æ‚ï¼Œ</p><p>å› æ­¤ï¼Œè‹¥æƒ³ç»Ÿä¸€ç±»å‹ï¼Œä¸å¦¨åˆ›å»ºä¸€ä¸ªç±»å‹æ©¡çš®æ“¦æ¥æ“¦é™¤åŸæœ¬çš„ç±»å‹ï¼Œ</p><p>è¿™æ—¶å€™æ¯ä¸€ä¸ªåˆ†æ”¯è¿”å›çš„ç±»å‹éƒ½æ˜¯â€œæ©¡çš®æ“¦â€çš„ç±»å‹ï¼Œä¹Ÿå°±æ²¡é—®é¢˜äº†ã€‚</p><h2 id="ç±»å‹æ“¦é™¤çš„åŸç†ä»¥åŠå®ç°"><a href="#ç±»å‹æ“¦é™¤çš„åŸç†ä»¥åŠå®ç°" class="headerlink" title="ç±»å‹æ“¦é™¤çš„åŸç†ä»¥åŠå®ç°"></a>ç±»å‹æ“¦é™¤çš„åŸç†ä»¥åŠå®ç°</h2><ul><li>åˆ›å»ºæ©¡çš®æ“¦ï¼ˆä»¥ä¸‹ç§°ä¹‹ä¸º Eraserï¼‰ï¼ŒEraser è¦ç¬¦åˆä½ çš„ <code>Protocol</code></li></ul><blockquote><p>æ©¡çš®æ“¦çš„åç§°ä¸€èˆ¬æ˜¯ <code>Any</code> + åè®®å</p></blockquote><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">struct</span> <span class="title class_">AnyTool</span>: <span class="title class_">Tool</span> &#123;</span><br><span class="line">    <span class="keyword">func</span> <span class="title function_">name</span>() -&gt; <span class="keyword">some</span> <span class="type">StringProtocol</span> &#123;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>åˆå§‹åŒ–ä¸­ä¼ å…¥ä¸€ä¸ª<strong>è¦è¢«æ“¦é™¤ç±»å‹çš„ Tool</strong> ï¼ˆä¸‹é¢ç§°ä¹‹ä¸ºTypeï¼‰</li></ul><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">init</span>&lt;<span class="type">T</span>: <span class="type">Tool</span>&gt;(<span class="params">erasing</span> <span class="params">tool</span>: <span class="type">T</span>) &#123;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>åˆ›å»ºä¸­é—´å˜é‡æ¥ä¼ é€’ Type ä¸­çš„å¿…è¦çš„æ–¹æ³•å’Œå±æ€§</li></ul><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">internal</span> <span class="keyword">let</span> _name: <span class="type">S</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">init</span>&lt;<span class="type">T</span>: <span class="type">Tool</span>&gt;(<span class="params">erasing</span> <span class="params">tool</span>: <span class="type">T</span>) &#123;</span><br><span class="line">    _name <span class="operator">=</span> (tool.name() <span class="keyword">as?</span> <span class="type">S</span>) <span class="operator">??</span> <span class="string">&quot;IDK.&quot;</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>æœ€åï¼Œç”¨ <code>name</code> æ¥å¡«è¡¥ Eraser ä¸­éœ€è¦çš„æ–¹æ³•</li></ul><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">struct</span> <span class="title class_">AnyTool</span>: <span class="title class_">Tool</span> &#123;</span><br><span class="line">    <span class="keyword">typealias</span> <span class="type">S</span> <span class="operator">=</span> <span class="type">String</span> <span class="comment">// This must be a type that conforms to StringProtocol.</span></span><br><span class="line">    <span class="keyword">internal</span> <span class="keyword">let</span> _name: <span class="type">S</span></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">init</span>&lt;<span class="type">T</span>: <span class="type">Tool</span>&gt;(<span class="params">erasing</span> <span class="params">tool</span>: <span class="type">T</span>) &#123;</span><br><span class="line">        _name <span class="operator">=</span> (tool.name() <span class="keyword">as?</span> <span class="type">S</span>) <span class="operator">??</span> <span class="string">&quot;IDK.&quot;</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">func</span> <span class="title function_">name</span>() -&gt; <span class="type">S</span> &#123;</span><br><span class="line">        _name</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>åœ¨è¿™é‡Œï¼Œæˆ‘ä»¬å°†ç±»å‹ä» <code>some StringProtocol</code> å˜æˆäº† <code>String</code></p><blockquote><p>å¦‚æœæ˜¯ <code>View</code>ï¼Œä¸€èˆ¬ä¼šæŠŠä»–æ›¿æ¢æˆ <code>AnyView</code> </p><p>è¿™é‡Œå¦‚æœä¸èƒ½å°† <code>tool.name()</code> è½¬æ¢æˆ <code>String</code> çš„è¯å°±è¿”å› <code>IDK.</code></p></blockquote><p>è¿™æ ·ä¸€æ¥ï¼Œæˆ‘ä»¬å°±å¯ä»¥å°† <code>Pen</code>ã€<code>Pencil</code>ã€<code>Ruler</code> éƒ½å˜æˆ <code>AnyTool</code>ï¼Œè§£å†³äº†ä»¥ä¸Šä¸¤ä¸ªé—®é¢˜ã€‚</p><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">ToolController</span> &#123;</span><br><span class="line">    <span class="keyword">var</span> allTools: [<span class="type">AnyTool</span>] <span class="operator">=</span> []</span><br><span class="line">    <span class="keyword">var</span> currentTool <span class="operator">=</span> <span class="string">&quot;pen&quot;</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">func</span> <span class="title function_">getAllTools</span>() &#123;</span><br><span class="line">        <span class="keyword">let</span> tools <span class="operator">=</span> [<span class="type">AnyTool</span>(erasing: <span class="type">Pen</span>()), <span class="type">AnyTool</span>(erasing: <span class="type">Pencil</span>()), <span class="type">AnyTool</span>(erasing: <span class="type">Ruler</span>())]</span><br><span class="line">        allTools <span class="operator">=</span> tools</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">func</span> <span class="title function_">getCurrentTool</span>() -&gt; <span class="keyword">some</span> <span class="type">Tool</span> &#123;</span><br><span class="line">        <span class="keyword">switch</span> currentTool &#123;</span><br><span class="line">        <span class="keyword">case</span> <span class="string">&quot;pen&quot;</span>: <span class="keyword">return</span> <span class="type">AnyTool</span>(erasing: <span class="type">Pen</span>())</span><br><span class="line">        <span class="keyword">case</span> <span class="string">&quot;ruler&quot;</span>: <span class="keyword">return</span> <span class="type">AnyTool</span>(erasing: <span class="type">Ruler</span>())</span><br><span class="line">        <span class="keyword">default</span>: <span class="keyword">return</span> <span class="type">AnyTool</span>(erasing: <span class="type">Pencil</span>())</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å®ç°åŸç†å‚è€ƒ <a href="https://fabernovel.github.io/2020-06-03/approaches-to-type-erasure-in-swift">Approaches to Type Erasure in Swift</a> </p>]]></content>
    
    
    <summary type="html">&lt;p&gt;æ¢ç´¢ç±»å‹æ“¦é™¤çš„åŸç†å’Œå®ç°ï¼Œå¸¸è§çš„ç±»å‹æ©¡çš®æ“¦æœ‰ï¼šAnyViewã€AnyShapeã€AnyCollectionâ€¦&lt;/p&gt;</summary>
    
    
    
    <category term="æ’¸ä»£ç " scheme="https://liyanan2004.github.io/categories/%E6%92%B8%E4%BB%A3%E7%A0%81/"/>
    
    
    <category term="Swift" scheme="https://liyanan2004.github.io/tags/Swift/"/>
    
    <category term="ç±»å‹æ“¦é™¤" scheme="https://liyanan2004.github.io/tags/%E7%B1%BB%E5%9E%8B%E6%93%A6%E9%99%A4/"/>
    
  </entry>
  
</feed>
